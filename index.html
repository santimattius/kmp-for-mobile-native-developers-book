<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>KMP for Mobile Native Developers: The Book.</title>
    <link rel="stylesheet" type="text/css" href="css/styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"
        integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg=="
        crossorigin="anonymous" referrerPolicy="no-referrer"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/default.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            hljs.highlightAll();
        });
    </script>
</head>

<body>
    <article id="179504e6-f752-80a7-a795-d0c12f3eb962" class="page sans">
        <header>
            <h1 class="page-title"><strong>ðŸ“• KMP for Mobile Native Developers: The Book.</strong></h1>
            <h2 class="page-description"><i>by Santiago Mattiauda.</i></h1>
        </header>
        <div class="page-body">
            <figure id="179504e6-f752-800b-8796-c4e71a14db27" class="image"><a
                    href="images/DALLE_2025-01-12_19.49.51_-_A_redesigned_book_cover_for_KMP_for_Mobile_Native_Developers._The_title_KMP_is_bold_and_clear_occupying_the_central_space_in_large_modern_tech-.webp"><img
                        style="width:707.9861450195312px"
                        src="images/DALLE_2025-01-12_19.49.51_-_A_redesigned_book_cover_for_KMP_for_Mobile_Native_Developers._The_title_KMP_is_bold_and_clear_occupying_the_central_space_in_large_modern_tech-.webp" /></a>
            </figure>
            <h1 id="187504e6-f752-805f-9bf8-e77603c9ed4f" class="">Content</h1>
            <nav id="179504e6-f752-80b7-994d-d5046c6ac5c0" class="block-color-purple table_of_contents">
                <div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link"
                        href="#187504e6-f752-805f-9bf8-e77603c9ed4f">Content</a></div>
                <div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link"
                        href="#181504e6-f752-8052-a8c5-ce1a6957cd52">Chapter 1: Introduction to Kotlin Multiplatform</a>
                </div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-8096-9a1e-e7b492f606d0">What is Kotlin Multiplatform?</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-80a7-b706-cd77871f1e76">Code Sharing Across Platforms</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-8066-b6a4-c9c4c1ba00ac">Strategies for Sharing Our Code</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-8047-9d6e-d4887cdf0566">Share a Piece of Logic</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-806b-9856-eacde4b4c4d7">Share Logic and Keep Native UI</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-8021-95b7-c0e9d40f7f8b">Share up to 100% of the code</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-80bf-9295-e9bdc75643af">How to Really Benefit from Code Sharing </a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-8001-8551-ca298aa2dfee">What Parts of Your Code Could You Share Across
                        Platforms?</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-8044-844d-e87750e22408">Defining an Architecture</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-8083-9cd5-ffa65ab02866">Infrastructure</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-8036-b5c8-d24b714b94fc">Networking Example</a></div>
                <div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link"
                        href="#30c6c8f3-12a2-451a-a70c-901725ba69fd">Chapter 2: Understanding the Basic Project
                        Structure</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-80da-949e-fca292d050b6">Basic Concepts of Kotlin Multiplatform Project
                        Structure</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-80a2-a918-f8091a3edc4a">Targets</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-8097-8f7b-dc96179fc21b">Source sets</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#51a3c531-3309-46e3-b8b1-8b55ec693521">Advanced Concepts of Multiplatform Project
                        Structure</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-8097-b76e-d74545c108a9">DependsOn</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-8009-bd92-f6e30d0cde5e">Dependencies on Other Libraries or Projects</a>
                </div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-803e-91af-f31a4db40e5b">Dependency Resolution</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-8081-801c-e1992df0e969">Sharing Code Across Platforms</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-8046-9594-cabd31d7cf8a">Sharing Code Across Similar Platforms</a></div>
                <div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link"
                        href="#179504e6-f752-80df-8d95-d4b7ff5fba63">Chapter 3: Dependency Injection</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-8017-bcca-f36b6aaf188a">Implementing Dependency Injection in KMP</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-80ee-beb6-d95c9cee2186">Kodein</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-8033-82d4-c569cf08529d">Main Features of Kodein</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-8064-9f0f-e9e16523446c">Basic Usage of Kodein</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-80bd-b1b3-c9ecdc8cd3f6">Koin</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-8099-8fa7-e8df8e7c661f">Main Features of Koin</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-80d3-9f00-d379afe61b35"><strong>Basic Usage of Koin</strong></a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-8072-834a-e9ebc23834c7">Manual Dependency Injection in Kotlin
                        Multiplatform</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-804b-80e3-cd360892f2fb">Basic Principles</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-807e-9e6b-c3b22c74c14f">Implementation</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-8059-b887-f86ac9e989f9">Advantages and Challenges</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-8060-b52c-cf77af070ca6">Key Considerations</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-809d-92ec-e87ed580124e">Off Topic: Creating our own dependency injection
                        framework</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-809b-a4bc-ea479b40ecc9">Summary of the Presented Alternatives</a></div>
                <div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link"
                        href="#179504e6-f752-8006-bfbb-fc118c12e02d">Chapter 4: Modularization</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-80cf-ac31-e5cb9654402a">Benefits of Modularization in Kotlin
                        Multiplatform</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-80ef-ba83-e76f3df0e8f6">Strategies for Modularizing a Kotlin Multiplatform
                        Project</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-8067-9728-f007bbfe7e4f">Modularization in Practice</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#183504e6-f752-8088-981c-fa596c0f04d9">Multiple Shared Modules</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-80cd-b261-c2f32bed1b30">Why do you need an Umbrella framework?</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-8057-b63a-c35bea10a464">Exposing Multiple KMP Frameworks in Detail</a>
                </div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-80bc-a20a-f43d25040b13">Let&#x27;s see our example implementation</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-808b-bec6-c1bb049469f6">Implementing the Umbrella Module</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-80e8-95be-f1fbfac1352f">Compilation</a></div>
                <div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link"
                        href="#179504e6-f752-80fd-aa8f-e6c1f310deeb">Chapter 5: Testing</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-80c9-8e3a-c6429f58d137">Benefits of Testing in Kotlin Multiplatform</a>
                </div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-80af-83ed-f4c2ce0f9f06">Tools for Testing in Kotlin Multiplatform</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-80fa-a900-e02d4e4196ca">Types of Tests</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-8066-a0f5-caeab85735fc">Essential Unit Tests</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-801f-941b-ca036f958f5d">What do we understand as a unit in our unit tests
                        (Subject Under Test - SUT)?</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-8070-9399-f5121ee81f42">Integration</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-8047-8511-eae046926604">How to identify the scope of our tests</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-802b-b505-f60e4c80049f">How to Configure and Run our Tests</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-80ac-8806-f68b14a5376d">How to Run our Tests</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-800a-ac0f-c034c70e39e1">Let&#x27;s Code</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-80f0-ae56-e3689a8e742b">How to Avoid Slow and Coupled Tests</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-8037-8def-cb3d1d2c8201">First Unit Test</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-8086-ba53-d56d8139fbf3">Integration Tests</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-8054-b0f2-c7f6eb579a93">Testing with Ktor</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-802e-be30-f73a3a836a8d">Testing with SQLDelight</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-8050-b0a0-ee6393d68d74">Validating our Dependency Injection</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-80aa-8756-e13a2718937b">Verifying our Dependency Graph with Koin</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-802c-962e-cbdf478421e4">Coverage Metrics</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-8091-9fe8-e22e81f7e11f">Kover</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-80ed-bf7f-e5eed6a56a43">Best Practices for Testing in Kotlin
                        Multiplatform</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-807f-b432-db8ae9126369">Rules for Using Tests in Multiplatform Projects</a>
                </div>
                <div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link"
                        href="#183504e6-f752-80c8-b152-e58869ec0b9c">Chapter 6: Using Native Libraries in Kotlin
                        Multiplatform</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#183504e6-f752-8090-9f22-ea0e05d998c8">Using Android Dependencies in KMP</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#183504e6-f752-8047-9f50-db19ef98a2c1">How to Use iOS Dependencies in KMP</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#183504e6-f752-80e1-acd4-d0fb02f1de82">Expect/Actual</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#183504e6-f752-8058-9b75-cff5664b1263">How can we get the Android Context in KMP?</a>
                </div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#183504e6-f752-8034-acbc-cb2018f5fb18">Can we use it from a Kotlin Multiplatform
                        module?</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#183504e6-f752-80c5-af0f-d699a5187d61">Pros and Cons</a></div>
                <div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link"
                        href="#183504e6-f752-8058-bb57-eb527b81f0d1">Chapter 7: Libraries</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-80c0-832e-ea658efe09f1">Networking</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-8093-97e6-e5c2bec42cd4">Ktor</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-80c6-9087-e1b10fb774e7">Ktorfit</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-80f3-beb2-d9e92d6f6f0a">Storage</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-80ad-a51c-cb3717c4e37b">Datastore</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-803e-adcf-ee577f1de5d9">Multiplatform Settings</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-8097-a1d2-c68eee0ae7eb">KStore</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#179504e6-f752-80f1-98f8-eac706cde5e0">Database</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-80d6-b375-c8781fa42b90">SQLDelight</a></div>
                <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link"
                        href="#179504e6-f752-80a8-93ff-d95ee62d2337">Room</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#185504e6-f752-8082-96b8-e1f54770d060">Multiplatform Jetpack Libraries</a></div>
                <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link"
                        href="#185504e6-f752-801a-9dbd-c48b16781ec4">Chapter Summary</a></div>
                <div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link"
                        href="#187504e6-f752-80f8-94c8-db22a1b3af9f">Book Example Repositories</a></div>
                <div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link"
                        href="#179504e6-f752-806a-a42b-f4cd68db0d6e">References</a></div>
            </nav>
            <h1 id="181504e6-f752-8052-a8c5-ce1a6957cd52" class="">Chapter 1: Introduction to Kotlin Multiplatform</h1>
            <h2 id="179504e6-f752-8096-9a1e-e7b492f606d0" class="">What is Kotlin Multiplatform?</h2>
            <p id="179504e6-f752-80b2-9f78-de2db436b58c" class="">Kotlin Multiplatform is a technology that simplifies
                cross-platform development by allowing code sharing between different platforms, reducing development
                and maintenance time while maintaining the advantages of native programming.</p>
            <p id="179504e6-f752-8072-a445-cae2584ad29a" class="">Developed by JetBrains, this technology enables
                developers to write code in Kotlin and share it across Android, iOS, web, and desktop.</p>
            <p id="179504e6-f752-8095-a92d-d33ff2661e28" class="">Developers can share business logic, data models, and
                other components across platforms, minimizing code duplication and facilitating maintenance. While not
                all elements can be shared due to inherent platform differences, Kotlin Multiplatform provides tools and
                libraries to optimize the amount of shared code.</p>
            <p id="179504e6-f752-802b-8bab-c312a73e7b1d" class="">This code-sharing capability not only reduces
                development and maintenance time but also preserves the flexibility and advantages of native
                programming.</p>
            <p id="179504e6-f752-80b4-ac09-f7b1453d559d" class="">
            </p>
            <figure id="179504e6-f752-809e-b05a-cfbf4ff9df27" class="image"><a
                    href="images/Untitled.png"><img
                        style="width:707.93408203125px"
                        src="images/Untitled.png" /></a>
            </figure>
            <h2 id="179504e6-f752-80a7-b706-cd77871f1e76" class="">Code Sharing Across Platforms</h2>
            <p id="179504e6-f752-806e-9cb4-ef8e8eb087f9" class="">Kotlin Multiplatform enables maintaining a single
                codebase for application logic across different platforms. Additionally, it leverages the advantages of
                native programming, including high performance and full access to native SDKs.</p>
            <p id="179504e6-f752-80b2-8890-e4d93d0462fd" class="">Kotlin offers two main mechanisms for sharing code:
            </p>
            <ul id="179504e6-f752-8092-9701-f5608724b9cb" class="bulleted-list">
                <li style="list-style-type:disc">Share common code across all project platforms.</li>
            </ul>
            <ul id="179504e6-f752-8086-ac19-c239e5ec74ec" class="bulleted-list">
                <li style="list-style-type:disc">Share code selectively between specific platforms to maximize reuse on
                    similar platforms.</li>
            </ul>
            <p id="179504e6-f752-80c6-ad78-e865c2949dc2" class="">
            </p>
            <figure id="179504e6-f752-803c-a0ae-df290f7f535a" class="image"><a
                    href="images/Untitled%201.png"><img
                        style="width:707.9688110351562px"
                        src="images/Untitled%201.png" /></a>
            </figure>
            <h2 id="179504e6-f752-8066-b6a4-c9c4c1ba00ac" class="">Strategies for Sharing Our Code</h2>
            <h3 id="179504e6-f752-8047-9d6e-d4887cdf0566" class="">Share a Piece of Logic</h3>
            <p id="179504e6-f752-80e3-95c9-fd73b520e623" class="">We can start by sharing an isolated and critical part
                of the application, reusing existing Kotlin code to keep applications in sync.</p>
            <p id="179504e6-f752-806c-8537-c6a6417204d2" class="">This strategy aims to share the smallest and most
                significant logical unit of our application. What is a &#x27;logical unit&#x27;? It&#x27;s a portion of
                our application that solves a specific problemâ€”such as validations or use casesâ€”and is
                platform-independent. It&#x27;s essential to promote or aspire to a good base design from the beginning.
            </p>
            <p id="179504e6-f752-808d-8848-e0a3c35e209a" class="">
            </p>
            <figure id="179504e6-f752-805b-a07d-c42a04e74b03" class="image"><a
                    href="images/small-logic.png"><img
                        style="width:235.97222900390625px"
                        src="images/small-logic.png" /></a>
            </figure>
            <p id="179504e6-f752-80be-bae3-f121d24d0017" class="">
            </p>
            <h3 id="179504e6-f752-806b-9856-eacde4b4c4d7" class="">Share Logic and Keep Native UI</h3>
            <p id="179504e6-f752-801b-8d66-d87871cc1543" class="">When starting a new project, consider using Kotlin
                Multiplatform to implement data handling and business logic just once. Keep the user interface native to
                meet the most demanding requirements. While ideal for new projects, we can also leverage existing
                Android code in Kotlin, reusing already developed implementations.</p>
            <p id="179504e6-f752-80e2-b70c-d534160c0186" class="">The strategy is to maintain user interfaces in native
                frameworks, as they are crucial for user experience, while sharing the application&#x27;s logic and
                infrastructure.</p>
            <p id="179504e6-f752-8088-b783-ea123259f1a7" class="">
            </p>
            <figure id="179504e6-f752-80b1-bff6-d8d7a1d49981" class="image"><a
                    href="images/kmp-1.png"><img
                        style="width:233.95834350585938px"
                        src="images/kmp-1.png" /></a>
            </figure>
            <p id="179504e6-f752-805b-b9d5-f638e4ea8cee" class="">
            </p>
            <h3 id="179504e6-f752-8021-95b7-c0e9d40f7f8b" class="">Share up to 100% of the code</h3>
            <p id="179504e6-f752-80b1-a4e9-fc2c18f547d4" class="">Share up to 100% of your code with <a
                    href="https://www.jetbrains.com/lp/compose-multiplatform/">Compose Multiplatform</a>, a modern
                declarative framework for creating user interfaces across multiple platforms.</p>
            <p id="179504e6-f752-806b-9f39-e0873f5ee371" class="">With Compose Multiplatform, you can develop shared
                user interfaces for all platforms. While this technology is still evolving, it represents a promising
                option for new mobile application projects.</p>
            <p id="179504e6-f752-8066-b93b-c95c5e9f983c" class="">In its current state, Compose Multiplatform implements
                Material Design principles, which may have some limitations compared to iOS&#x27;s Design System.
                However, the JetBrains team is developing Cupertino support (Apple&#x27;s Design System) for future
                versions.</p>
            <p id="179504e6-f752-8058-a6b7-d65cf8f76079" class="">
            </p>
            <figure id="179504e6-f752-804c-9af0-df3c4c791ce6" class="image"><a
                    href="images/kmp-2.png"><img
                        style="width:231.96182250976562px"
                        src="images/kmp-2.png" /></a>
            </figure>
            <h2 id="179504e6-f752-80bf-9295-e9bdc75643af" class="">How to Really Benefit from Code Sharing </h2>
            <p id="179504e6-f752-80c0-94e5-d584def2c130" class="">So far, we&#x27;ve explored the theoretical promises
                of Kotlin Multiplatform, but now let&#x27;s examine its practical benefits and the libraries we can use
                when starting or migrating our development.</p>
            <h3 id="179504e6-f752-8001-8551-ca298aa2dfee" class="">What Parts of Your Code Could You Share Across
                Platforms?</h3>
            <p id="179504e6-f752-80fd-978a-f98f1c64c059" class="">In 2021, JetBrains conducted a survey asking:
                &quot;What parts of your code were you able to share across platforms?&quot;. While there isn&#x27;t
                precise data about KMP adoption at that time, the survey results appear consistent when examining
                software architecture and design principles.</p>
            <p id="179504e6-f752-80b2-a9fa-e85027d1532c" class="">
            </p>
            <figure id="179504e6-f752-80a7-8fe6-e37cf1184d66" class="image"><a
                    href="images/kmp-3.png"><img
                        style="width:707.9688110351562px"
                        src="images/kmp-3.png" /></a>
                <figcaption><em>What parts of your code were you able to share across platforms?</em></figcaption>
            </figure>
            <p id="179504e6-f752-80da-a262-df8678a46518" class="">This is why it&#x27;s important to establish a good
                design, as we form a common team language when implementing solutions, regardless of the platform.</p>
            <h3 id="179504e6-f752-8044-844d-e87750e22408" class="">Defining an Architecture</h3>
            <p id="179504e6-f752-80bf-ae7c-e6106bbfe3f9" class="">When talking about architecture, we naturally think of
                <strong>Clean Architecture</strong>. This methodology consists of architectural patterns that separate
                frameworks and external elements from our domain and business logic. To implement it, we need to
                understand three fundamental concepts:
            </p>
            <p id="179504e6-f752-809d-9151-dc8e0d8a83bf" class=""><strong>Domain</strong></p>
            <p id="179504e6-f752-80fa-b1f3-eac73d0f3313" class="">Fundamental concepts of our context (User, Product,
                Cart, etc.) and business rules defined exclusively by us (domain services).</p>
            <p id="179504e6-f752-8096-8eb7-e29959a2ce95" class=""><strong>Application</strong></p>
            <p id="179504e6-f752-8073-976e-c3d69918b2ef" class="">The layer where our application use cases reside
                (register user, publish product, add product to cart, etc.).</p>
            <p id="179504e6-f752-800b-a973-e368eb6c28e7" class=""><strong>Infrastructure</strong></p>
            <p id="179504e6-f752-80f1-8480-c10ea513512b" class="">Code that varies according to external decisions. This
                layer contains the implementations of interfaces defined at the domain level. We use the Dependency
                Inversion Principle (DIP) from SOLID to decouple from external dependencies.</p>
            <p id="179504e6-f752-8055-a85e-d48d9351a621" class="">This is where frameworks and external components are
                integrated, such as Repositories, HTTP Clients, and Caches.</p>
            <figure id="179504e6-f752-801e-bd94-d9fd7a671163" class="image" style="text-align:center"><a
                    href="images/Untitled%202.png"><img
                        style="width:672px"
                        src="images/Untitled%202.png" /></a>
                <figcaption>Components in an application design</figcaption>
            </figure>
            <p id="179504e6-f752-80a3-8a7a-c714d31729c1" class="">Since our domain and application layers exclusively
                encapsulate business logic, they constitute the main code to be shared across platforms. Without this
                code-sharing capability, we would have to duplicate specifications in both Kotlin and Swift for each
                respective platform.</p>
            <h3 id="179504e6-f752-8083-9cd5-ffa65ab02866" class="">Infrastructure</h3>
            <p id="179504e6-f752-80dd-beb4-d3398f2dbaeb" class="">In this layer, we can safely implement native
                solutions. Following the established definitions, we use the Dependency Inversion Principle (DIP) from
                SOLID to decouple our external dependencies. To achieve this, we define contracts using Kotlin
                Multiplatform&#x27;s (KMP) expect-actual pattern.</p>
            <figure id="179504e6-f752-80bd-adad-fb60545b567e" class="image"><a
                    href="images/Captura_de_pantalla_2024-02-08_a_la(s)_19.48.41.png"><img
                        style="width:632.96875px"
                        src="images/Captura_de_pantalla_2024-02-08_a_la(s)_19.48.41.png" /></a>
            </figure>
            <h3 id="179504e6-f752-8036-b5c8-d24b714b94fc" class="">Networking Example</h3>
            <p id="179504e6-f752-8092-b021-ccf92fbdf61c" class="">Let&#x27;s look at an example of how to use native
                Android and iOS clients to make network requests.</p>
            <p id="179504e6-f752-807f-bd21-ecffaf693638" class="">To begin, we&#x27;ll define our repository and a
                remote data source. For the data source, we&#x27;ll create an interface that will have two
                implementations: one for Android and another for iOS, as shown in the following image.</p>
            <p id="179504e6-f752-80a2-a149-d1dfd6e450ae" class="">
            </p>
            <figure id="182504e6-f752-80fa-8dfc-c8daa561ed2a" class="image"><a
                    href="images/kmp-example-networking-uml.png"><img
                        style="width:707.951416015625px"
                        src="images/kmp-example-networking-uml.png" /></a>
            </figure>
            <p id="179504e6-f752-8069-88c4-d9ee4c457a5a" class="">For Android, we&#x27;ll use Retrofit, and for iOS,
                we&#x27;ll use URLSession.</p>
            <p id="179504e6-f752-80c0-af13-db577345b033" class="">Let&#x27;s see how to implement this in code.</p>
            <p id="179504e6-f752-80a5-a6a7-f35bb7307217" class="">First, we&#x27;ll define an <code>expect</code>
                function that will provide a platform-specific implementation of the data sources.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-80d1-95e4-dce2a1a12d00"
                class="code"><code class="kotlin">expect fun provideGameDataSource(): GameRemoteDataSources</code></pre>
            <p id="179504e6-f752-80da-b15e-c3d112b60c63" class="">From here, we&#x27;ll create our repository and
                implement the corresponding data sources</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-80ea-8ca6-e8b4abb09898" class="code"><code class="kotlin">class GameRepository(
        private val remoteDataSources: GameRemoteDataSources = provideGameDataSource(),
    ) {
    
        suspend fun fetch(): Result&lt;GameResponse&gt; {
            return remoteDataSources.getGames()
        }
    }</code></pre>
            <p id="179504e6-f752-8071-ac56-d893751b6494" class=""><strong>Android Implementation</strong></p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-8002-9537-c0caa12b3ec5" class="code"><code class="kotlin">actual fun provideGameDataSource(): GameRemoteDataSources {
        return AndroidGameRemoteDataSources()
    }
    
    class AndroidGameRemoteDataSources : GameRemoteDataSources {
    
        private val client = RetrofitClient(baseUrl)
        private val services = client.create&lt;GameServices&gt;()
    
        override suspend fun getGames(): Result&lt;GameResponse&gt; {
            return runCatching {
                val games = services.getGames()
                val jsonElement = Json.parseToJsonElement(games)
                Json.decodeFromJsonElement&lt;GameResponse&gt;(jsonElement)
            }
        }
    
        companion object {
            private const val baseUrl = &quot;https://www.freetogame.com/api/&quot;
        }
    }</code></pre>
            <p id="179504e6-f752-8063-9b25-cd7e627d461b" class=""><strong>iOS Implementation</strong></p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-80a4-a7d5-e8074c655bca" class="code"><code class="kotlin">actual fun provideGameDataSource(): GameRemoteDataSources {
        return IOSGameRemoteDataSources()
    }
    
    class IOSGameRemoteDataSources : GameRemoteDataSources {
    
        private val client = URLSessionClient()
    
        override suspend fun getGames(): Result&lt;GameResponse&gt; {
            return runCatching {
                val jsonString = client.fetch(baseUrl)
                Json.decodeFromString&lt;GameResponse&gt;(jsonString)
            }
        }
    
    
        companion object {
            private const val baseUrl = &quot;https://www.freetogame.com/api/games&quot;
        }
    }</code></pre>
            <p id="179504e6-f752-80b8-83e5-c619d5a851c5" class="">Once these configurations are implemented, our KMP
                project will have the following structure</p>
            <figure id="179504e6-f752-80b1-9732-c79a05fb3839" class="image"><a
                    href="images/Captura_de_pantalla_2024-02-12_a_la(s)_12.37.03.png"><img
                        style="width:583.9757080078125px"
                        src="images/Captura_de_pantalla_2024-02-12_a_la(s)_12.37.03.png" /></a>
            </figure>
            <p id="179504e6-f752-80e8-8375-fadb8d1345df" class="">
            </p>
            <figure class="block-color-gray_background callout" style="display:flex"
                id="179504e6-f752-8033-8edf-fbe193e732e4">
                <div style="font-size:1.5em"><span class="icon">ðŸ’¡</span></div>
                <div style="width:100%">Spoiler Alert: In the next chapter, we&#x27;ll explore the structure of a Kotlin
                    Multiplatform project.</div>
            </figure>
            <p id="179504e6-f752-80cf-b4f9-d4e512cd21b5" class="">As we mentioned that <em>&quot;we&#x27;ll rely on
                    SOLID&#x27;s DIP to decouple from external dependencies&quot;</em>, we can also use native code,
                that is, code implemented directly in the platform where we&#x27;re using our multiplatform code.
                Let&#x27;s look at an example of this in iOS with Swift.</p>
            <p id="179504e6-f752-805d-b5ad-d1f886ee3863" class="">Since <code>GameRemoteDataSource</code> is an
                interface in Kotlin, it translates to a protocol in Swift.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-809c-ac4e-cd8a3db4509a" class="code"><code class="swift">class SwiftGameRemoteDataSources: GameRemoteDataSources {
        
        func getGames() async throws -&gt; Any? {
            
            guard let url = URL(string: &quot;https://www.freetogame.com/api/games&quot;) else {
                throw GameServiceError.invalidURL
            }
            let (data, _) = try await URLSession.shared.data(from: url)
            let result = try JSONDecoder().decode(GameResponse.self, from: data)
            return result.map{ item in item.asDomainModel() }
        }
        
    }</code></pre>
            <p id="179504e6-f752-802b-ada5-ee58d91309a1" class="">Note that type compatibility is lost here, as we can
                see in the <code>getGames</code> function signature which returns <code>Any?</code></p>
            <p id="179504e6-f752-80d7-ba74-fd8c96c30590" class="">We can implement this as follows</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-806f-9e91-d63975e9479f" class="code"><code class="swift">import Shared
    
    @Observable
    class GameViewModel{
        
       let repository = GameRepository(remoteDataSources: SwiftGameRemoteDataSources())
        
        var data:String = &quot;&quot;
        
        func load(){
            self.repository.fetch(completionHandler:{response,_ in
                self.data = &quot;\(String(describing: response))&quot;
            })
        }
    }</code></pre>
            <p id="179504e6-f752-8070-8cc9-f6b5b6431c65" class="">
            </p>
            <figure id="180504e6-f752-80fd-85e2-fe1af442c2b3"><a
                    href="https://github.com/santimattius/kmp-for-mobile-native-developers/tree/feature_01_expect_actual"
                    class="bookmark source">
                    <div class="bookmark-info">
                        <div class="bookmark-text">
                            <div class="bookmark-title">GitHub - santimattius/kmp-for-mobile-native-developers at
                                feature_01_expect_actual</div>
                            <div class="bookmark-description">KMP for Mobile Native Developers. Contribute to
                                santimattius/kmp-for-mobile-native-developers development by creating an account on
                                GitHub.</div>
                        </div>
                        <div class="bookmark-href"><img src="https://github.com/fluidicon.png"
                                class="icon bookmark-icon" />https://github.com/santimattius/kmp-for-mobile-native-developers/tree/feature_01_expect_actual
                        </div>
                    </div><img
                        src="https://opengraph.githubassets.com/3f745ceb2122d5561224a5e091689071daf75aad6ac611efec6fa57020e9c03e/santimattius/kmp-for-mobile-native-developers"
                        class="bookmark-image" />
                </a></figure>
            <p id="179504e6-f752-80dc-afe2-df7b218a12ce" class="">
            </p>
            <p id="179504e6-f752-80fd-a872-f6f28e010c57" class="">While sharing business logic is valuable in Kotlin
                Multiplatform, reusing native code at the infrastructure level can be complex to maintain due to
                platform differences. For example, when handling preferences, Android requires a Context while iOS uses
                UserDefaults, creating platform-specific dependencies.</p>
            <p id="180504e6-f752-807a-b1f8-f0a32cc60237" class="">To address this, we&#x27;ll explore multiplatform
                libraries that offer common abstractions for storage, networking, and other essential functionalities,
                enabling more consistent implementation and greater code reuse.</p>
            <p id="19d2e7e4-4db4-43c2-9a4b-74991cc86c2f" class="">In the next section, we&#x27;ll analyze the basic
                structure of a Kotlin Multiplatform project, including modules, source sets, and targets - fundamental
                elements for developing efficient multiplatform applications.</p>
            <h1 id="30c6c8f3-12a2-451a-a70c-901725ba69fd" class="">Chapter 2: Understanding the Basic Project Structure
            </h1>
            <figure id="179504e6-f752-8033-ab88-e13645565f71" class="image"><a
                    href="images/Captura_de_pantalla_2024-02-21_a_la(s)_19.57.47.png"><img
                        style="width:707.951416015625px"
                        src="images/Captura_de_pantalla_2024-02-21_a_la(s)_19.57.47.png" /></a>
            </figure>
            <p id="179504e6-f752-803a-b160-eb9a4ae06105" class="">In this section, we&#x27;ll look at the structure of a
                multiplatform project and the fundamental concepts introduced when sharing code in KMP.</p>
            <p id="179504e6-f752-80f4-a960-e136621f48cb" class="">Each Kotlin Multiplatform project includes three
                modules:</p>
            <ul id="179504e6-f752-80d6-8a84-eb0038eb084f" class="bulleted-list">
                <li style="list-style-type:disc"><em><strong>shared</strong></em> is a Kotlin module that contains the
                    common logic for Android and iOS applications: the code that is shared between platforms. It uses <a
                        href="https://kotlinlang.org/docs/gradle.html">Gradle</a> as a build system to automate the
                    build process.</li>
            </ul>
            <ul id="179504e6-f752-801a-95ba-fa98c93fb213" class="bulleted-list">
                <li style="list-style-type:disc"><em><strong>composeApp</strong></em> is a Kotlin module that compiles
                    into an Android application. It uses Gradle as a build system. The composeApp module depends on and
                    uses the shared module as a regular Android library.</li>
            </ul>
            <ul id="179504e6-f752-806b-9c5c-ef7269b21261" class="bulleted-list">
                <li style="list-style-type:disc"><em><strong>iosApp</strong></em> is an Xcode project that compiles into
                    an iOS application. It depends on and uses the shared module as an iOS framework. The shared module
                    can be used as a regular framework or as a <a
                        href="https://kotlinlang.org/docs/native-cocoapods.html">CocoaPods</a> dependency. By default,
                    the Kotlin Multiplatform wizard creates projects that use the regular framework dependency.</li>
            </ul>
            <p id="187504e6-f752-80cd-abaa-e999f7c889f7" class="">
            </p>
            <figure id="179504e6-f752-808d-9966-c207b2dbe050" class="image"><a
                    href="images/Captura_de_pantalla_2024-02-15_a_la(s)_19.45.25.png"><img
                        style="width:575px"
                        src="images/Captura_de_pantalla_2024-02-15_a_la(s)_19.45.25.png" /></a>
            </figure>
            <p id="179504e6-f752-8030-9352-d515a039ab8d" class="">The shared module consists of three source sets:
                <code>androidMain</code>, <code>commonMain</code>, and <code>iosMain</code>. A &quot;source set&quot; is
                a grouping of related files in Gradle, where each set handles its own dependencies. In Kotlin
                Multiplatform, these source sets can target different platforms within the shared module. The common set
                contains the Kotlin code that is shared, while the platform-specific sets implement specialized Kotlin
                code for each target. In the case of <code>androidMain</code>, Kotlin/JVM is used, and for
                <code>iosMain</code>, Kotlin/Native.
            </p>
            <p id="179504e6-f752-802a-8d6b-db34133c3c7d" class="">
            </p>
            <figure id="179504e6-f752-8074-87a3-f1caff6daa67" class="image"><a
                    href="images/Captura_de_pantalla_2024-02-21_a_la(s)_19.24.08.png"><img
                        style="width:305.9895935058594px"
                        src="images/Captura_de_pantalla_2024-02-21_a_la(s)_19.24.08.png" /></a>
            </figure>
            <p id="179504e6-f752-8046-997e-d5730edd75f8" class="">When the shared module is integrated as an Android
                library, the common Kotlin code is compiled to Kotlin/JVM. However, when integrated as an iOS framework,
                this same code is compiled to Kotlin/Native.</p>
            <figure id="179504e6-f752-80f8-a374-c8ed9d36c7b7" class="image"><a
                    href="images/Captura_de_pantalla_2024-02-15_a_la(s)_19.46.57.png"><img
                        style="width:652.9861450195312px"
                        src="images/Captura_de_pantalla_2024-02-15_a_la(s)_19.46.57.png" /></a>
            </figure>
            <p id="179504e6-f752-8061-b1ad-c7f6bab5ea4b" class="">Let&#x27;s now dive deeper into Source sets and
                Targets, and how they indicate which platforms we can share our code with.</p>
            <h2 id="179504e6-f752-80da-949e-fca292d050b6" class="">Basic Concepts of Kotlin Multiplatform Project
                Structure</h2>
            <h3 id="179504e6-f752-80a2-a918-f8091a3edc4a" class="">Targets</h3>
            <p id="179504e6-f752-80bf-bd83-eadabce5f603" class="">Targets define the specific platforms for which Kotlin
                will compile the shared code, such as Android and iOS in mobile projects.</p>
            <p id="179504e6-f752-8053-8958-f7477af275a7" class="">In KMP, a target is an identifier that specifies the
                type of compilation. It determines the format of generated binary files, available language constructs,
                and dependencies that can be used.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-80c3-948a-ca861af70c09" class="code"><code class="kotlin">kotlin {
        androidTarget {
            compilations.all {
                kotlinOptions {
                    jvmTarget = JavaVersion.VERSION_1_8.toString()
                }
            }
        }
    
        listOf(
            iosX64(),
            iosArm64(),
            iosSimulatorArm64()
        ).forEach { iosTarget -&gt;
            iosTarget.binaries.framework {
                baseName = &quot;Shared&quot;
                isStatic = true
            }
        }
    }</code></pre>
            <p id="179504e6-f752-8068-bb51-cc1e58a93d00" class="">As we can see in the code above, targets can specify
                particular configurations for each platform. For example, for Android we are indicating in
                <code>kotlinOptions</code> that the <code>jvmTarget</code> should be Java 1.8.
            </p>
            <p id="179504e6-f752-80a8-b8f7-f809cbb66705" class="">There is a default hierarchy within the targets, where
                if our definition is the following</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-8004-ac50-e7351eeb3b57" class="code"><code class="kotlin">kotlin {
        androidTarget()
        iosArm64()
        iosSimulatorArm64()
    }</code></pre>
            <p id="179504e6-f752-8088-96e5-ff80c89fbb68" class="">The resulting source sets hierarchy is as follows</p>
            <figure id="179504e6-f752-80d0-890f-d6e6600cdeb4" class="image"><a
                    href="images/default-hierarchy-example.svg"><img
                        style="width:705.9722290039062px"
                        src="images/default-hierarchy-example.svg" /></a>
            </figure>
            <p id="179504e6-f752-8063-8970-e15cc1f40227" class="">The &quot;source sets&quot; shown in green are created
                and active in the project, while those in gray from the default template are ignored. For example, the
                Kotlin Gradle plugin doesn&#x27;t generate code for watchOS because the project has no targets defined
                for this platform.</p>
            <figure id="180504e6-f752-804b-a404-cf40a8555bf9"><a
                    href="https://kotlinlang.org/docs/multiplatform-discover-project.html?_gl=1*uurev0*_ga*MTUxMDA4MTM3LjE2ODM3MjI2MjU.*_ga_9J976DJZ68*MTcwODAzNjc4NS4zOC4xLjE3MDgwMzcwNDQuMjEuMC4w&amp;_ga=2.151554105.102716348.1708036787-151008137.1683722625#targets"
                    class="bookmark source">
                    <div class="bookmark-info">
                        <div class="bookmark-text">
                            <div class="bookmark-title">The basics of Kotlin Multiplatform project structure | Kotlin
                            </div>
                            <div class="bookmark-description">With Kotlin Multiplatform, you can share code among
                                different platforms. This article explains the constraints of the shared code, how to
                                distinguish between shared and platform-specific parts of your code, and how to specify
                                the platforms on which this shared code works.</div>
                        </div>
                        <div class="bookmark-href"><img
                                src="https://kotlinlang.org/assets/images/apple-touch-icon-114x114.png?v2"
                                class="icon bookmark-icon" />https://kotlinlang.org/docs/multiplatform-discover-project.html?_gl=1*uurev0*_ga*MTUxMDA4MTM3LjE2ODM3MjI2MjU.*_ga_9J976DJZ68*MTcwODAzNjc4NS4zOC4xLjE3MDgwMzcwNDQuMjEuMC4w&amp;_ga=2.151554105.102716348.1708036787-151008137.1683722625#targets
                        </div>
                    </div><img src="https://kotlinlang.org/assets/images/open-graph/docs.png" class="bookmark-image" />
                </a></figure>
            <p id="179504e6-f752-8050-a58f-d066d746a07f" class="">Next, we&#x27;ll see how to access these source sets
                and how to define specific dependencies within them.</p>
            <h3 id="179504e6-f752-8097-8f7b-dc96179fc21b" class="">Source sets</h3>
            <p id="179504e6-f752-80e5-9bd0-fb5da0e262df" class="">A <em>Kotlin source set</em> is a collection of files
                that share targets, dependencies, and compilation configurations. It is the main mechanism for sharing
                code in multiplatform projects.</p>
            <p id="179504e6-f752-80f3-a4d4-d3c5b2d513c2" class="">Each source set in a multiplatform project:</p>
            <ul id="179504e6-f752-8031-9958-e0f4521c12bd" class="bulleted-list">
                <li style="list-style-type:disc">Has a unique name within the project.</li>
            </ul>
            <ul id="179504e6-f752-8074-8df3-f63647e93890" class="bulleted-list">
                <li style="list-style-type:disc">Contains files and resources, organized in a directory that bears the
                    source set&#x27;s name.</li>
            </ul>
            <ul id="179504e6-f752-80de-9cae-d9ba924d1e17" class="bulleted-list">
                <li style="list-style-type:disc">Specifies the targets for which the code compiles, determining which
                    language features and dependencies are available.</li>
            </ul>
            <ul id="179504e6-f752-803d-b9ff-dbce4bd353d7" class="bulleted-list">
                <li style="list-style-type:disc">Defines its own dependencies and compilation configurations.</li>
            </ul>
            <p id="179504e6-f752-8034-a8db-d39add2b6585" class="">Kotlin offers several predefined source sets. Among
                them, <code>commonMain</code> stands out, as it is present in all multiplatform projects and brings
                together all declared targets.</p>
            <p id="179504e6-f752-80ed-9598-d4aed6ba4d92" class="">In the <code>src</code> directory of our shared
                module, we&#x27;ll find the defined source sets. For example, in a project with <code>commonMain</code>,
                <code>iosMain</code>, and <code>androidMain</code>, the source sets are structured as follows:
            </p>
            <figure id="179504e6-f752-8028-84b3-dd31ad3b3ea4" class="image"><a
                    href="images/Captura_de_pantalla_2024-02-18_a_la(s)_13.48.51.png"><img
                        style="width:371.9965515136719px"
                        src="images/Captura_de_pantalla_2024-02-18_a_la(s)_13.48.51.png" /></a>
            </figure>
            <p id="179504e6-f752-8064-8ab6-e5d35f06e09a" class="">In Gradle scripts, source sets are accessed by name
                within the <code>kotlin.sourceSets {}</code> block:</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-8057-ac88-c8a4b99d83d7" class="code"><code class="kotlin">kotlin {
    
            // Targets
        androidTarget {
            compilations.all {
                kotlinOptions {
                    jvmTarget = JavaVersion.VERSION_1_8.toString()
                }
            }
        }
    
        listOf(
            iosX64(),
            iosArm64(),
            iosSimulatorArm64()
        ).forEach { iosTarget -&gt;
            iosTarget.binaries.framework {
                baseName = &quot;Shared&quot;
                isStatic = true
            }
        }
    
            // Sourcets
        sourceSets {
            commonMain.dependencies {
                            //.....
            }
    
            androidMain.dependencies {
               //.....
            }
    
            iosMain.dependencies {
                //.....
            }
        }
    }</code></pre>
            <p id="179504e6-f752-80fe-8bbe-f7e6d0c6072d" class="">Within our source sets, we can define
                platform-specific code for each supported platform.</p>
            <figure id="179504e6-f752-8042-961d-fd3faac3de75" class="image"><a
                    href="images/Captura_de_pantalla_2024-02-18_a_la(s)_13.55.00.png"><img
                        style="width:395.0000305175781px"
                        src="images/Captura_de_pantalla_2024-02-18_a_la(s)_13.55.00.png" /></a>
            </figure>
            <p id="180504e6-f752-8043-9541-f6af2fa62282" class="">
            </p>
            <figure id="180504e6-f752-80c6-b9af-e8832d02b516"><a
                    href="https://kotlinlang.org/docs/multiplatform-discover-project.html#source-sets"
                    class="bookmark source">
                    <div class="bookmark-info">
                        <div class="bookmark-text">
                            <div class="bookmark-title">The basics of Kotlin Multiplatform project structure | Kotlin
                            </div>
                            <div class="bookmark-description">With Kotlin Multiplatform, you can share code among
                                different platforms. This article explains the constraints of the shared code, how to
                                distinguish between shared and platform-specific parts of your code, and how to specify
                                the platforms on which this shared code works.</div>
                        </div>
                        <div class="bookmark-href"><img
                                src="https://kotlinlang.org/assets/images/apple-touch-icon-114x114.png?v2"
                                class="icon bookmark-icon" />https://kotlinlang.org/docs/multiplatform-discover-project.html#source-sets
                        </div>
                    </div><img src="https://kotlinlang.org/assets/images/open-graph/docs.png" class="bookmark-image" />
                </a></figure>
            <h2 id="51a3c531-3309-46e3-b8b1-8b55ec693521" class="">Advanced Concepts of Multiplatform Project Structure
            </h2>
            <p id="180504e6-f752-8074-ba3a-d5f27224ef3d" class="">In this section, we&#x27;ll explore some advanced
                concepts of the Kotlin Multiplatform project structure and how they relate to Gradle implementation.
                This information will be useful if you need to work with low-level abstractions of Gradle builds
                (configurations, tasks, publications, and others) or if you&#x27;re creating a Gradle plugin for Kotlin
                Multiplatform builds.</p>
            <h3 id="179504e6-f752-8097-b76e-d74545c108a9" class="">DependsOn</h3>
            <p id="179504e6-f752-8076-9e67-e008e450b97b" class=""><code>dependsOn</code> is a specific relationship in
                Kotlin that connects two source sets. This connection can occur between common and platform-specific
                source sets, such as when <code>jvmMain</code> depends on <code>commonMain</code>, or
                <code>iosArm64Main</code> depends on <code>iosMain</code>.
            </p>
            <p id="179504e6-f752-80f6-b516-c0f553903659" class="">To better understand how it works, let&#x27;s take two
                Kotlin source sets <code>A</code> and <code>B</code>. When we write <code>A.dependsOn(B)</code>, this
                means:</p>
            <ol type="1" id="179504e6-f752-8017-8be5-fef70db68ae6" class="numbered-list" start="1">
                <li><code>A</code> has access to <code>B</code>&#x27;s API, including its internal declarations.</li>
            </ol>
            <ol type="1" id="179504e6-f752-8042-9aaf-c5c23e23927b" class="numbered-list" start="2">
                <li><code>A</code> can implement <code>B</code>&#x27;s expected declarations. This is fundamental, as
                    <code>A</code> can only provide <code>actuals</code> for <code>B</code> if there is a
                    <code>dependsOn</code> relationship, either direct or indirect.
                </li>
            </ol>
            <ol type="1" id="179504e6-f752-8087-8d65-f3c2b953a252" class="numbered-list" start="3">
                <li><code>B</code> must compile for all of <code>A</code>&#x27;s targets, in addition to its own
                    targets.</li>
            </ol>
            <ol type="1" id="179504e6-f752-801d-8516-fc24396fc54c" class="numbered-list" start="4">
                <li><code>B</code> inherits all of <code>A</code>&#x27;s regular dependencies.</li>
            </ol>
            <p id="179504e6-f752-808f-acb8-d33f72207142" class="">This <code>dependsOn</code> relationship generates a
                tree-like hierarchical structure between source sets.</p>
            <p id="179504e6-f752-80e7-b0d8-dbb91d746cde" class="">
            </p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-80ab-a995-ca7cbbdc54da" class="code"><code class="kotlin">kotlin {
        // Targets declaration
        sourceSets {
            // Example of configuring the dependsOn relation
            iosArm64Main.dependsOn(commonMain)
        }
    }</code></pre>
            <p id="11ff236c-8393-41bc-868b-6913259552f6" class="">For more information about advanced concepts of the
                multiplatform project structure, you can refer to the<a
                    href="https://kotlinlang.org/docs/multiplatform-advanced-project-structure.html">official Kotlin
                    documentation</a>.</p>
            <figure id="182504e6-f752-8003-8558-ce02f0d5f085"><a
                    href="https://kotlinlang.org/docs/multiplatform-advanced-project-structure.html#dependencies-and-dependson"
                    class="bookmark source">
                    <div class="bookmark-info">
                        <div class="bookmark-text">
                            <div class="bookmark-title">Advanced concepts of the multiplatform project structure |
                                Kotlin</div>
                            <div class="bookmark-description">This article explains advanced concepts of the Kotlin
                                Multiplatform project structure and how they map to the Gradle implementation. This
                                information will be useful if you need to work with low-level abstractions of the Gradle
                                build (configurations, tasks, publications, and others) or are creating a Gradle plugin
                                for Kotlin Multiplatform builds.</div>
                        </div>
                        <div class="bookmark-href"><img
                                src="https://kotlinlang.org/assets/images/apple-touch-icon-114x114.png?v2"
                                class="icon bookmark-icon" />https://kotlinlang.org/docs/multiplatform-advanced-project-structure.html#dependencies-and-dependson
                        </div>
                    </div><img src="https://kotlinlang.org/assets/images/open-graph/docs.png" class="bookmark-image" />
                </a></figure>
            <h3 id="179504e6-f752-8009-bd92-f6e30d0cde5e" class="">Dependencies on Other Libraries or Projects</h3>
            <p id="179504e6-f752-804d-9727-f6b4a2d15fe9" class="">In multiplatform projects, you can configure
                dependencies from both published libraries and other Gradle projects.</p>
            <p id="179504e6-f752-80d6-8a63-d5aa2dbad7f3" class="">Dependency configuration in Kotlin Multiplatform
                follows a structure similar to Gradle, where:</p>
            <ul id="179504e6-f752-80a4-bd0b-ffbe33d9d395" class="bulleted-list">
                <li style="list-style-type:disc">The <code>dependencies {}</code> block is used in the build script.
                </li>
            </ul>
            <ul id="179504e6-f752-80af-bf6f-fe57692a0a5a" class="bulleted-list">
                <li style="list-style-type:disc">The appropriate scope for dependencies is selected, such as
                    <code>implementation</code> or <code>api</code>.
                </li>
            </ul>
            <ul id="179504e6-f752-80da-aaf0-fc2e3aec1247" class="bulleted-list">
                <li style="list-style-type:disc">The dependency is referenced through its coordinates when published in
                    a repository (for example,
                    <code>&quot;org.jetbrains.kotlinx:kotlinx-coroutines-android:1.8.0&quot;</code>) or through its path
                    if it&#x27;s a local Gradle project (like <code>project(&quot;:utils:concurrency&quot;)</code>).
                </li>
            </ul>
            <p id="179504e6-f752-8005-b775-ffa4ffc10977" class="">Dependency configuration in multiplatform projects has
                a distinctive feature: each Kotlin source set has its own <code>dependencies {}</code> block, allowing
                you to declare platform-specific dependencies.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-8010-8f93-c12030fd8a3f" class="code"><code class="kotlin">kotlin {
        // Targets declaration
        sourceSets {
            androidMain.dependencies {
                implementation(&quot;org.jetbrains.kotlinx:kotlinx-coroutines-android:1.8.0&quot;
            }
        }
    }</code></pre>
            <p id="179504e6-f752-804b-8c49-faa394e75c8a" class="">Let&#x27;s consider a multiplatform project that uses
                a multiplatform library, such as <code>kotlinx.coroutines</code>:</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-804c-bf51-c3831fd52b38" class="code"><code class="kotlin">kotlin {
        androidTarget()     // Android
        iosArm64()          // iPhone devices
        iosSimulatorArm64() // iPhone simulator on Apple Silicon Mac
    
        sourceSets {
            commonMain.dependencies {
                implementation(&quot;org.jetbrains.kotlinx:kotlinx-coroutines-core:1.8.0&quot;)
            }
        }
    }</code></pre>
            <p id="72552661-cccc-4e11-98ce-a1fca820a1a9" class="">For more information about multiplatform dependencies,
                you can refer to the<a href="https://kotlinlang.org/docs/multiplatform-dependencies.html">Kotlin
                    Multiplatform Dependencies documentation</a>.</p>
            <figure id="180504e6-f752-804d-9bd8-cbf81f4d943a"><a
                    href="https://kotlinlang.org/docs/multiplatform-advanced-project-structure.html#dependencies-on-other-libraries-or-projects"
                    class="bookmark source">
                    <div class="bookmark-info">
                        <div class="bookmark-text">
                            <div class="bookmark-title">Advanced concepts of the multiplatform project structure |
                                Kotlin</div>
                            <div class="bookmark-description">This article explains advanced concepts of the Kotlin
                                Multiplatform project structure and how they map to the Gradle implementation. This
                                information will be useful if you need to work with low-level abstractions of the Gradle
                                build (configurations, tasks, publications, and others) or are creating a Gradle plugin
                                for Kotlin Multiplatform builds.</div>
                        </div>
                        <div class="bookmark-href"><img
                                src="https://kotlinlang.org/assets/images/apple-touch-icon-114x114.png?v2"
                                class="icon bookmark-icon" />https://kotlinlang.org/docs/multiplatform-advanced-project-structure.html#dependencies-on-other-libraries-or-projects
                        </div>
                    </div><img src="https://kotlinlang.org/assets/images/open-graph/docs.png" class="bookmark-image" />
                </a></figure>
            <h3 id="179504e6-f752-803e-91af-f31a4db40e5b" class="">Dependency Resolution</h3>
            <p id="179504e6-f752-8084-be9b-d8417eefa07e" class="">In the dependency resolution process for multiplatform
                projects, three fundamental aspects stand out:</p>
            <ol type="1" id="179504e6-f752-8059-8cd8-fc2231a2714e" class="numbered-list" start="1">
                <li><strong>Multiplatform Dependencies Propagation:</strong> Dependencies declared in the
                    <code>commonMain</code> source set automatically propagate to other source sets with
                    <code>dependsOn</code> relationships. For example, a dependency added to <code>commonMain</code>
                    extends to <code>iosMain</code>, <code>jvmMain</code>, <code>iosSimulatorArm64Main</code>, and
                    <code>iosX64Main</code>. This prevents duplication and simplifies dependency management.
                </li>
            </ol>
            <ol type="1" id="179504e6-f752-802e-9232-f90f2ced2559" class="numbered-list" start="2">
                <li><strong>Intermediate and Final State of Dependency Resolution:</strong> The <code>commonMain</code>
                    source set acts as an intermediate state in dependency resolution, while platform-specific source
                    sets represent the final state. After resolution, each multiplatform library is structured as a
                    collection of its individual source sets, allowing for more precise management and ensuring project
                    coherence.</li>
            </ol>
            <ol type="1" id="179504e6-f752-8052-9a63-d6f49f6d40a2" class="numbered-list" start="3">
                <li><strong>Resolution of Dependencies by Compatible Targets:</strong> Kotlin ensures that a
                    dependency&#x27;s source sets are compatible with those of the consumer. For example, if a source
                    set compiles for <code>androidTarget</code>, <code>iosX64</code>, and
                    <code>iosSimulatorArm64</code>, the dependency must offer source sets compatible with these targets.
                    This ensures dependencies work across all target platforms.
                </li>
            </ol>
            <p id="179504e6-f752-80cf-abea-ec3c2f44c14c" class="">In summary, dependency resolution in multiplatform
                projects is based on three pillars: automatic propagation from <code>commonMain</code>, management of
                intermediate and final states, and compatibility between dependencies and consumers. This system ensures
                efficient and coherent management in Kotlin multiplatform projects.</p>
            <h2 id="179504e6-f752-8081-801c-e1992df0e969" class="">Sharing Code Across Platforms</h2>
            <p id="179504e6-f752-8018-843e-eb6ad35fc948" class="">If you have business logic common to all platforms,
                you can avoid code duplication by sharing it in the common source set.</p>
            <p id="179504e6-f752-80e0-b13d-f755f06613c0" class="">Some dependencies between source sets are established
                automatically, eliminating the need to manually specify <code>dependsOn</code> relationships:</p>
            <ul id="179504e6-f752-8037-bab1-dad46561496d" class="bulleted-list">
                <li style="list-style-type:disc">Between platform-specific source sets that depend on the common source
                    set (for example, <code>jvmMain</code>, <code>macosX64Main</code>).</li>
            </ul>
            <ul id="179504e6-f752-8018-9b23-daa9a456fdeb" class="bulleted-list">
                <li style="list-style-type:disc">Between <code>main</code> and <code>test</code> source sets of a
                    specific target (such as <code>androidMain</code> and <code>androidUnitTest</code>).</li>
            </ul>
            <p id="179504e6-f752-8047-a3e0-d3a59499d6af" class="">To access platform-specific APIs from shared code, use
                Kotlin&#x27;s <a href="https://kotlinlang.org/docs/multiplatform-expect-actual.html">expect/actual
                    declarations</a> mechanism, which we explored in the previous post.</p>
            <p id="179504e6-f752-8075-9a12-d8a792e02fd3" class="">
            </p>
            <figure id="179504e6-f752-80b2-a95c-e9b385581983" class="image"><a
                    href="images/Captura_de_pantalla_2024-02-08_a_la(s)_19.48.41%201.png"><img
                        style="width:632.96875px"
                        src="images/Captura_de_pantalla_2024-02-08_a_la(s)_19.48.41%201.png" /></a>
            </figure>
            <h3 id="179504e6-f752-8046-9594-cabd31d7cf8a" class="">Sharing Code Across Similar Platforms</h3>
            <p id="179504e6-f752-8035-bf95-deaf7af143e3" class="">Multiplatform projects often require creating multiple
                native targets that can reuse much of the common logic and third-party APIs.</p>
            <p id="179504e6-f752-80f6-9501-f4e6d8111253" class="">A common example is in iOS projects, where two targets
                are needed: one for iOS ARM64 devices and another for the x64 simulator. While these have separate
                specific source sets, they rarely require different code between them, and their dependencies are very
                similar. This allows sharing iOS-specific code between both targets.</p>
            <p id="179504e6-f752-80d0-8dfe-ccef7cc92762" class="">Therefore, it&#x27;s advantageous to have a shared set
                of sources for both iOS targets, allowing Kotlin/Native code to directly access the common APIs of both
                iOS device and simulator.</p>
            <p id="179504e6-f752-8011-b271-f6b61d6eefa3" class="">To implement this, you can share code between native
                targets using the <a href="https://kotlinlang.org/docs/multiplatform-hierarchy.html">hierarchical
                    structure</a> through two options:</p>
            <ul id="179504e6-f752-8069-ae65-e9c11c496520" class="bulleted-list">
                <li style="list-style-type:disc"><a
                        href="https://kotlinlang.org/docs/multiplatform-hierarchy.html#default-hierarchy-template">Using
                        the default hierarchy template</a></li>
            </ul>
            <ul id="179504e6-f752-80aa-bf68-ec40d030b602" class="bulleted-list">
                <li style="list-style-type:disc"><a
                        href="https://kotlinlang.org/docs/multiplatform-hierarchy.html#manual-configuration">Manually
                        configuring the hierarchical structure</a></li>
            </ul>
            <p id="179504e6-f752-8070-8d85-c706e5fc809a" class="">
            </p>
            <h1 id="179504e6-f752-80df-8d95-d4b7ff5fba63" class="">Chapter 3: Dependency Injection</h1>
            <figure id="179504e6-f752-808c-8c37-f0743976e1e9" class="image"><a
                    href="images/e5c0d93e-5fc9-4350-97b3-3f72a662bbae.png"><img
                        style="width:622.5223435948361px"
                        src="images/e5c0d93e-5fc9-4350-97b3-3f72a662bbae.png" /></a>
            </figure>
            <p id="179504e6-f752-8001-a459-d2f2fc06994d" class="">In software development, dependency management is
                essential. Dependency Injection (DI) is a design pattern that allows application components to receive
                their dependencies instead of creating them internally. This promotes modularization, facilitates code
                reuse, and simplifies unit testing. In Kotlin Multiplatform (KMP), DI is fundamental to ensure code
                cohesion and portability across different platforms.</p>
            <p id="179504e6-f752-8074-82df-dbd8938904c5" class=""><strong>Benefits of Dependency Injection</strong></p>
            <ul id="179504e6-f752-800f-a32b-df9579b5544d" class="bulleted-list">
                <li style="list-style-type:disc"><strong>Code Reuse</strong>: By decoupling components, code can be
                    reused across different platforms without significant changes.</li>
            </ul>
            <ul id="179504e6-f752-8045-974f-dfc8916f4fa4" class="bulleted-list">
                <li style="list-style-type:disc"><strong>Testability</strong>: DI simplifies unit testing by allowing
                    dependencies to be replaced with mock or fake objects.<ul id="05bda6cc-bbc0-4280-81d5-16cddd82034a"
                        class="bulleted-list">
                        <li style="list-style-type:circle">In future articles, we&#x27;ll explain how to mock objects
                            for testing in KMP.</li>
                    </ul>
                </li>
            </ul>
            <ul id="179504e6-f752-8063-92ad-c54b124bafd3" class="bulleted-list">
                <li style="list-style-type:disc"><strong>Flexibility</strong>: DI facilitates the incorporation of new
                    functionalities and changes in dependencies without affecting existing code, improving scalability
                    and maintainability.</li>
            </ul>
            <ul id="179504e6-f752-8054-9f79-e876d485bc4e" class="bulleted-list">
                <li style="list-style-type:disc"><strong>Clarity and Organization</strong>: DI promotes a clearer and
                    more organized code structure by explicitly defining dependencies and their relationships.</li>
            </ul>
            <p id="179504e6-f752-808c-b936-f88d84431924" class="">Although JetBrains does not provide a native
                dependency injection solution for the multiplatform ecosystem, they recommend using existing
                community-developed solutions.</p>
            <figure id="179504e6-f752-80e1-b6c5-e9fb2c853f63" class="image"><a
                    href="images/Captura_de_pantalla_2024-03-31_a_la(s)_18.10.16.png"><img
                        style="width:580.9896240234375px"
                        src="images/Captura_de_pantalla_2024-03-31_a_la(s)_18.10.16.png" /></a>
                <figcaption>Jetbrains tweet about Dependency Injection tip (<a
                        href="https://twitter.com/kotlin/status/1710269674016125100">link</a>)</figcaption>
            </figure>
            <h2 id="179504e6-f752-8017-bcca-f36b6aaf188a" class="">Implementing Dependency Injection in KMP</h2>
            <p id="179504e6-f752-80f7-b36b-cff3b8827396" class="">To implement Dependency Injection (DI) in Kotlin
                Multiplatform, there are several libraries and approaches available. Each offers different advantages
                and disadvantages:</p>
            <ul id="179504e6-f752-80f8-993c-f8b26fef4ab3" class="bulleted-list">
                <li style="list-style-type:disc"><strong>Kodein</strong>: A native Kotlin DI library that stands out for
                    its simple syntax and easy configuration. Its platform-independent nature makes it ideal for KMP
                    projects.</li>
            </ul>
            <ul id="179504e6-f752-80b4-9452-d344704ce08c" class="bulleted-list">
                <li style="list-style-type:disc"><strong>Koin</strong>: A popular library that uses a declarative syntax
                    and is easy to configure. While it relies on reflection, this can present limitations on some
                    platforms like iOS.</li>
            </ul>
            <ul id="179504e6-f752-80ef-811f-da43cf26673c" class="bulleted-list">
                <li style="list-style-type:disc"><strong>Manual DI</strong>: An alternative that, while requiring more
                    implementation effort, offers total control over the process. It involves creating and injecting
                    dependencies externally through constructors or methods.</li>
            </ul>
            <p id="179504e6-f752-80cc-94df-f44d0ca2dbee" class="">Let&#x27;s examine each of these options in detail.
            </p>
            <h2 id="179504e6-f752-80ee-beb6-d95c9cee2186" class="">Kodein</h2>
            <p id="179504e6-f752-8034-ad81-f507d915fcb4" class="">Kodein is a dependency injection (DI) library for
                Kotlin. It&#x27;s designed to simplify dependency management in Kotlin applications across multiple
                platforms: Android, iOS, Web, and Backend. Thanks to its simple syntax and straightforward
                configuration, it has become a popular choice for Kotlin Multiplatform (KMP) projects.</p>
            <h3 id="179504e6-f752-8033-82d4-c569cf08529d" class="">Main Features of Kodein</h3>
            <ol type="1" id="179504e6-f752-801f-8042-c4f0c2e94d12" class="numbered-list" start="1">
                <li><strong>Concise and Declarative Syntax:</strong> Kodein uses an intuitive syntax that facilitates
                    the definition and resolution of dependencies, improving code readability and maintainability.</li>
            </ol>
            <ol type="1" id="179504e6-f752-802a-ae5b-d721c6d86f0e" class="numbered-list" start="2">
                <li><strong>Platform Independent:</strong> Being developed purely in Kotlin, Kodein works on any
                    platform without worrying about compatibility with specific frameworks or libraries.</li>
            </ol>
            <ol type="1" id="179504e6-f752-807e-97af-d00221c89782" class="numbered-list" start="3">
                <li><strong>Kotlin Coroutines Support:</strong> Kodein integrates perfectly with Kotlin Coroutines,
                    facilitating dependency management in asynchronous and reactive code.</li>
            </ol>
            <ol type="1" id="179504e6-f752-8088-aed0-c100560ed670" class="numbered-list" start="4">
                <li><strong>Modular Configuration:</strong> Offers a modular system for configuring dependencies,
                    simplifying the organization and maintenance of extensive projects.</li>
            </ol>
            <ol type="1" id="179504e6-f752-80ac-a324-e9cacfb4db6e" class="numbered-list" start="5">
                <li><strong>Flexible Injection:</strong> Allows dependency injection through both constructor and
                    property, offering versatility in dependency resolution.</li>
            </ol>
            <ol type="1" id="179504e6-f752-8019-a253-f7f62bfe6ac5" class="numbered-list" start="6">
                <li><strong>Annotation Support:</strong> Includes annotations to identify components and configurations,
                    improving code clarity.</li>
            </ol>
            <h3 id="179504e6-f752-8064-9f0f-e9e16523446c" class="">Basic Usage of Kodein</h3>
            <p id="179504e6-f752-80c2-b7ed-d1510d297466" class="">To implement Kodein in a Kotlin Multiplatform project,
                the first step is to add the dependency to the configuration file. Then, you can define dependency
                modules and register application components using the Kodein API. Finally, you&#x27;ll be able to
                resolve these dependencies in any section of the application where you need them.</p>
            <p id="179504e6-f752-80b0-9764-ef37e41f4aaa" class="">Let&#x27;s look at a basic code example using Kodein:
            </p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-8025-b667-d40c0687767e" class="code"><code class="kotlin" style="word-break:break-all">// Define a dependency module
    val appModule = DI.Module(&quot;appModule&quot;) {
        bind&lt;Database&gt;() with singleton { Database() }
        bind&lt;UserRepository&gt;() with singleton { UserRepository(instance()) }
        bind&lt;MyService&gt;() with singleton { MyService(instance()) }
    }
    
    // Configure the DI container
    val di = DI {
        importAll(appModule)
    }
    
    // Resolve dependencies in a class
    class MyService(private val userRepository: UserRepository) {
        // ...
    }
    
    // Use resolved dependencies
    val myService by di.instance&lt;MyService&gt;()</code></pre>
            <p id="179504e6-f752-8007-a732-e501cbdecc5d" class="">In this example, a dependency module is defined that
                provides a database implementation and a user repository. Then, Kodein is configured with this module
                and an instance of <code>MyService</code> that depends on the user repository is resolved.</p>
            <p id="183504e6-f752-8056-b49c-ce8899794852" class="">
            </p>
            <figure id="183504e6-f752-80a2-a205-ccdab6eaaff4"><a
                    href="https://kosi-libs.org/kodein/7.22/getting-started.html" class="bookmark source">
                    <div class="bookmark-info">
                        <div class="bookmark-text">
                            <div class="bookmark-title">Getting started with Kodein-DI :: Kodein Open Source Initiative
                                Documentation</div>
                            <div class="bookmark-description">Kodein-DI is a Dependency Injection library.
                                It allows you to bind your business unit interfaces with their implementation and thus
                                having each business unit being independent.</div>
                        </div>
                        <div class="bookmark-href">https://kosi-libs.org/kodein/7.22/getting-started.html</div>
                    </div>
                </a></figure>
            <h2 id="179504e6-f752-80bd-b1b3-c9ecdc8cd3f6" class="">Koin</h2>
            <p id="179504e6-f752-80a1-a8e9-da73a0a4a611" class="">Koin is a lightweight Dependency Injection library for
                Kotlin that stands out for its simplicity and ease of use. Compatible with Android, backend, and iOS, it
                prioritizes clean and readable code.</p>
            <h3 id="179504e6-f752-8099-8fa7-e8df8e7c661f" class="">Main Features of Koin</h3>
            <ol type="1" id="179504e6-f752-8033-a656-d99d71f4b003" class="numbered-list" start="1">
                <li><strong>Non-Intrusive:</strong> Uses pure Kotlin functions, integrating naturally without modifying
                    existing architecture.</li>
            </ol>
            <ol type="1" id="179504e6-f752-806f-ba1f-f5bb3beed70b" class="numbered-list" start="2">
                <li><strong>Clear Syntax:</strong> Employs a simple DSL that facilitates dependency definition and
                    resolution.</li>
            </ol>
            <ol type="1" id="179504e6-f752-803e-b094-fa45a44cf575" class="numbered-list" start="3">
                <li><strong>Optimized Performance:</strong> By not using reflection, it improves performance and is
                    compatible with iOS/Kotlin Native.</li>
            </ol>
            <ol type="1" id="179504e6-f752-8086-a59f-fe3177358784" class="numbered-list" start="4">
                <li><strong>Flexibility:</strong> Allows constructor and property injection, adapting to different
                    needs.</li>
            </ol>
            <ol type="1" id="179504e6-f752-8012-a0d1-ea28d6655c6b" class="numbered-list" start="5">
                <li><strong>Lifecycle Control:</strong> Manages scopes to control instance creation and destruction.
                </li>
            </ol>
            <ol type="1" id="179504e6-f752-80fd-8986-da12a0eb457e" class="numbered-list" start="6">
                <li><strong>High Compatibility:</strong> Easily integrates with Kotlin frameworks and libraries.</li>
            </ol>
            <h3 id="179504e6-f752-80d3-9f00-d379afe61b35" class=""><strong>Basic Usage of Koin</strong></h3>
            <p id="179504e6-f752-8099-a0ed-db82f3402098" class="">To implement Koin in a Kotlin Multiplatform project,
                follow these steps: first, add the Koin dependency to the project configuration file. Then, define
                dependency modules and register application components using the Koin API. Finally, resolve dependencies
                where you need them in your application.</p>
            <p id="179504e6-f752-8082-a4d1-f5cdc70028b3" class="">Let&#x27;s look at a basic implementation example with
                Koin:</p>
            <p id="179504e6-f752-8043-8a4b-edde364673be" class="">In this example, a dependency module is defined that
                provides a database, a user repository, and a ViewModel. Then, Koin is configured with this module and
                an instance of<code>MyViewModel</code>, which depends on the user repository, is obtained.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-8091-a22c-f61ca4ab1127" class="code"><code class="kotlin" style="word-break:break-all">// Define a dependency module
    val myModule = module {
        single { Database() }
        single { UserRepository(get()) }
        factory { MyViewModel(get()) }
    }
    
    // Configure Koin with the defined module
    startKoin {
        modules(myModule)
    }
    
    // Resolve dependencies in a class
    class MyActivity : AppCompatActivity() {
        private val viewModel: MyViewModel by viewModel()
        // ...
    }</code></pre>
            <figure id="183504e6-f752-80cf-85f7-eda10aaeba82"><a href="https://insert-koin.io/" class="bookmark source">
                    <div class="bookmark-info">
                        <div class="bookmark-text">
                            <div class="bookmark-title">Koin - The Kotlin Dependency Injection Framework</div>
                            <div class="bookmark-description">The Kotlin Dependency Injection Framework</div>
                        </div>
                        <div class="bookmark-href"><img src="https://insert-koin.io/img/favicon.ico"
                                class="icon bookmark-icon" />https://insert-koin.io/</div>
                    </div>
                </a></figure>
            <h2 id="179504e6-f752-8072-834a-e9ebc23834c7" class="">Manual Dependency Injection in Kotlin Multiplatform
            </h2>
            <p id="179504e6-f752-80fe-8e63-c63a1689a38f" class="">Manual Dependency Injection (DI) is a simple
                alternative for managing dependencies in KMP projects without using external libraries. This approach
                involves creating and injecting dependencies directly into the classes that need them.</p>
            <h3 id="179504e6-f752-804b-80e3-cd360892f2fb" class="">Basic Principles</h3>
            <ul id="179504e6-f752-80d4-ad36-f64f2505357c" class="bulleted-list">
                <li style="list-style-type:disc"><strong>Constructor Injection:</strong> Dependencies are passed through
                    constructors, keeping code explicit and clear.</li>
            </ul>
            <ul id="179504e6-f752-8095-ac2c-df98ac3951cc" class="bulleted-list">
                <li style="list-style-type:disc"><strong>OOP Approach:</strong> Aligns with object-oriented programming,
                    using clear interfaces between components.</li>
            </ul>
            <h3 id="179504e6-f752-807e-9e6b-c3b22c74c14f" class="">Implementation</h3>
            <ol type="1" id="179504e6-f752-80af-a7ba-c107660a381c" class="numbered-list" start="1">
                <li><strong>Identify:</strong> Determine which dependencies each class needs.</li>
            </ol>
            <ol type="1" id="179504e6-f752-8066-98b5-f1b62187d6e2" class="numbered-list" start="2">
                <li><strong>Create:</strong> Generate instances at the top level using patterns like Singleton.</li>
            </ol>
            <ol type="1" id="179504e6-f752-8022-8443-d1d8433e53aa" class="numbered-list" start="3">
                <li><strong>Inject:</strong> Provide dependencies through constructors.</li>
            </ol>
            <ol type="1" id="179504e6-f752-80a4-8112-f81f61b289cb" class="numbered-list" start="4">
                <li><strong>Manage:</strong> Handle the lifecycle of dependencies.</li>
            </ol>
            <h3 id="179504e6-f752-8059-b887-f86ac9e989f9" class="">Advantages and Challenges</h3>
            <ul id="179504e6-f752-80aa-ae4b-c4326ea5ecc6" class="bulleted-list">
                <li style="list-style-type:disc"><strong>Advantages:</strong> Simplicity, total control, and
                    transparency in dependency flow.</li>
            </ul>
            <ul id="179504e6-f752-8066-a473-d564907ea890" class="bulleted-list">
                <li style="list-style-type:disc"><strong>Challenges:</strong> Higher coupling, manual maintenance, and
                    possible code repetition.</li>
            </ul>
            <h3 id="179504e6-f752-8060-b52c-cf77af070ca6" class="">Key Considerations</h3>
            <ol type="1" id="179504e6-f752-80f0-85b1-d934a859ea1f" class="numbered-list" start="1">
                <li><strong>Design:</strong> Create clear interfaces following SOLID principles.</li>
            </ol>
            <ol type="1" id="179504e6-f752-80b8-b76f-d53686c141eb" class="numbered-list" start="2">
                <li><strong>Lifecycle:</strong> Properly manage instance creation and destruction.</li>
            </ol>
            <ol type="1" id="179504e6-f752-80e9-ac8e-f62be8e19afd" class="numbered-list" start="3">
                <li><strong>Testing:</strong> Facilitate unit testing through mocks.</li>
            </ol>
            <ol type="1" id="179504e6-f752-808c-8211-c41970c20c9d" class="numbered-list" start="4">
                <li><strong>Scalability:</strong> Maintain a modular and structured approach.</li>
            </ol>
            <ol type="1" id="179504e6-f752-80f3-90a5-f884bf3307a0" class="numbered-list" start="5">
                <li><strong>Documentation:</strong> Maintain clear documentation and effective team communication.</li>
            </ol>
            <h2 id="179504e6-f752-809d-92ec-e87ed580124e" class="">Off Topic: Creating our own dependency injection
                framework</h2>
            <p id="179504e6-f752-807d-9e8b-e9adfd6bc118" class="">As the title suggests, while this is a secondary
                topic, it represents a viable alternative when we want to avoid external dependencies for dependency
                injection and reduce code repetition inherent to manual injection. While we won&#x27;t delve into this
                topic, I&#x27;d like to conclude this article by recommending the following resource about it.</p>
            <p id="179504e6-f752-8014-b88c-fbc3b772c464" class="">
            </p>
            <figure id="179504e6-f752-8034-8eaa-ffef364cf001"><a
                    href="https://blog.p-y.wtf/diy-your-own-dependency-injection-library" class="bookmark source">
                    <div class="bookmark-info">
                        <div class="bookmark-text">
                            <div class="bookmark-title">DIY: your own Dependency Injection library!</div>
                            <div class="bookmark-description">Demystifying the internals of DI libraries</div>
                        </div>
                        <div class="bookmark-href"><img
                                src="https://cdn.hashnode.com/res/hashnode/image/upload/v1683739845291/JR4wD2L17.jpg?auto=compress,format&amp;format=webp&amp;fm=png"
                                class="icon bookmark-icon" />https://blog.p-y.wtf/diy-your-own-dependency-injection-library
                        </div>
                    </div><img
                        src="https://hashnode.com/utility/r?url=https%3A%2F%2Fcdn.hashnode.com%2Fres%2Fhashnode%2Fimage%2Fupload%2Fv1705600821196%2Fd9c26d7d-b262-4a69-8cec-480ad1cb5dc8.jpeg%3Fw%3D1200%26h%3D630%26fit%3Dcrop%26crop%3Dentropy%26auto%3Dcompress%2Cformat%26format%3Dwebp%26fm%3Dpng"
                        class="bookmark-image" />
                </a></figure>
            <h2 id="179504e6-f752-809b-a4bc-ea479b40ecc9" class="">Summary of the Presented Alternatives</h2>
            <p id="179504e6-f752-80e8-a2f6-efaf2fe191d3" class=""><strong>Koin</strong> is a lightweight library for
                implementing Dependency Injection in Kotlin applications. It stands out for its ease of use and
                efficiency, being highly valued by the developer community. Its cross-platform compatibility and
                frequent updates make it a reliable option for Kotlin Multiplatform projects.</p>
            <p id="179504e6-f752-8096-a613-cb1881499e32" class=""><strong>Kodein</strong> is a robust library for
                managing dependencies in Kotlin Multiplatform projects. It offers an intuitive syntax, cross-platform
                support, and advanced features such as Kotlin Coroutines integration. Its efficiency, flexibility, and
                support from an active community position it as a solid solution for dependency injection in Kotlin.</p>
            <p id="179504e6-f752-80f3-b224-ff9169f6cabc" class=""><strong>Manual Dependency Injection</strong> allows
                total control over dependency management in Kotlin Multiplatform projects without relying on external
                libraries. While it requires more implementation and maintenance effort, it is ideal for small projects
                or teams that prefer a direct approach. However, it is crucial to carefully evaluate project
                requirements and weigh the advantages and challenges before opting for manual DI in a KMP project.</p>
            <h1 id="179504e6-f752-8006-bfbb-fc118c12e02d" class="">Chapter 4: Modularization</h1>
            <figure id="179504e6-f752-80ec-813b-cf67bbea61bd" class="image"><a
                    href="images/Captura_de_pantalla_2024-04-09_a_la(s)_18.25.03.png"><img
                        style="width:590.9722290039062px"
                        src="images/Captura_de_pantalla_2024-04-09_a_la(s)_18.25.03.png" /></a>
            </figure>
            <p id="179504e6-f752-80ba-aac5-ee1cf56fd9b4" class="">
            </p>
            <p id="179504e6-f752-8063-aeb6-c2788fd636de" class="">Modularization has gained greater importance in the
                face of growing complexity in mobile applications and platform diversity. This strategy is fundamental
                for improving code maintainability, scalability, and reusability. In this scenario, Kotlin Multiplatform
                (KMP) emerges as an ideal solution for developing mobile applications across different platforms, such
                as Android and iOS. Let&#x27;s see how to modularize a KMP (Kotlin Multiplatform Mobile) project.</p>
            <h2 id="179504e6-f752-80cf-ac31-e5cb9654402a" class="">Benefits of Modularization in Kotlin Multiplatform
            </h2>
            <p id="179504e6-f752-80d2-b257-d30dfee8bfce" class="">KMP allows sharing business logic, data models, and
                components across various mobile applications, resulting in more efficient development and greater
                consistency between application versions.</p>
            <p id="179504e6-f752-80b0-9a78-ee474d2d3a9f" class="">Modularization in a KMP project offers several
                significant benefits:</p>
            <ol type="1" id="179504e6-f752-805f-85c9-df7e6a10381d" class="numbered-list" start="1">
                <li><strong>Code Reusability</strong>: Independent modules facilitate the reuse of components and
                    functionalities across different parts of the application and between platforms.</li>
            </ol>
            <ol type="1" id="179504e6-f752-806d-8cb8-f150ae27e7db" class="numbered-list" start="2">
                <li><strong>Maintainability</strong>: Well-defined modules simplify code understanding and maintenance.
                    Being able to develop, test, and update each module independently speeds up development and reduces
                    errors.</li>
            </ol>
            <ol type="1" id="179504e6-f752-8002-9349-f8d88d6885af" class="numbered-list" start="3">
                <li><strong>Scalability</strong>: Modularization facilitates project growth, allowing modules to be
                    added or modified without affecting existing code.</li>
            </ol>
            <ol type="1" id="179504e6-f752-800c-81dd-e9446edfed5c" class="numbered-list" start="4">
                <li><strong>Decoupling</strong>: Separation into independent modules reduces coupling between
                    components, making the code more flexible and easier to extend.</li>
            </ol>
            <p id="179504e6-f752-8053-bc91-d9da58517d27" class="">So far, we&#x27;ve explored the theory behind
                modularization. But what strategies can we implement to make the most of cross-platform development?</p>
            <h2 id="179504e6-f752-80ef-ba83-e76f3df0e8f6" class="">Strategies for Modularizing a Kotlin Multiplatform
                Project</h2>
            <p id="179504e6-f752-800e-811d-fecb4cb2e320" class="">There are various strategies for modularizing a KMP
                project. The most common ones are:</p>
            <ol type="1" id="179504e6-f752-801b-9055-c54996a4a459" class="numbered-list" start="1">
                <li><strong>Layer-based Division</strong>: Organizes code into modules representing different
                    architecture layers, such as presentation, business logic, and data access.</li>
            </ol>
            <ol type="1" id="179504e6-f752-802e-a08a-f37a290c2ec8" class="numbered-list" start="2">
                <li><strong>Feature-based Division</strong>: Groups code related to a specific functionality into a
                    single module, facilitating its reuse and maintenance.</li>
            </ol>
            <ol type="1" id="179504e6-f752-8025-9fc0-e2cc8e5f9d22" class="numbered-list" start="3">
                <li><strong>Platform-based Division</strong>: Separates platform-specific code into different modules,
                    keeping shared code in a central module.</li>
            </ol>
            <ol type="1" id="179504e6-f752-807c-ba33-df50e44e4677" class="numbered-list" start="4">
                <li><strong>Domain-based Division</strong>: Organizes code into modules representing different
                    application domains, such as user, authentication, and purchases.</li>
            </ol>
            <p id="179504e6-f752-807c-98b8-fc0b41d54c21" class="">This approach is valid for both monorepos and separate
                repositories, as the fundamental aspects are the configurations of projects using KMP.</p>
            <h2 id="179504e6-f752-8067-9728-f007bbfe7e4f" class="">Modularization in Practice</h2>
            <p id="179504e6-f752-8060-a48d-fa1a5133b249" class="">When creating a KMP project, whether it&#x27;s an App
                or Library type, a Shared module is automatically generated that will function as a shared module
                between both platforms: Android and iOS.</p>
            <p id="179504e6-f752-809c-b0c6-f6c484dba01b" class="">
            </p>
            <figure id="179504e6-f752-804f-b8c6-f0b5876d85fd" class="image"><a
                    href="https://documents.lucid.app/documents/a473ab8f-6d26-4f79-865b-041bba56047a/pages/0_0?a=2192&amp;x=-19&amp;y=83&amp;w=837&amp;h=353&amp;store=1&amp;accept=image%2F*&amp;auth=LCA%2028d6e3b499ad0fa17d4fd7b6d375e5f22ab798ef9e1663af14fe1a3c0871c49c-ts%3D1712187140"><img
                        style="width:628px"
                        src="https://documents.lucid.app/documents/a473ab8f-6d26-4f79-865b-041bba56047a/pages/0_0?a=2192&amp;x=-19&amp;y=83&amp;w=837&amp;h=353&amp;store=1&amp;accept=image%2F*&amp;auth=LCA%2028d6e3b499ad0fa17d4fd7b6d375e5f22ab798ef9e1663af14fe1a3c0871c49c-ts%3D1712187140" /></a>
            </figure>
            <p id="179504e6-f752-80d2-9672-dfbc5d7c4890" class=""><strong>Pros</strong></p>
            <ul id="183504e6-f752-80a9-8822-eefad03bea52" class="bulleted-list">
                <li style="list-style-type:disc">A simple design with a single module reduces cognitive load. You
                    don&#x27;t need to think about where to put your functionality or how to logically divide it into
                    parts.</li>
            </ul>
            <ul id="183504e6-f752-80ea-b1f1-f474da0da516" class="bulleted-list">
                <li style="list-style-type:disc">Works very well as a starting point.</li>
            </ul>
            <p id="183504e6-f752-8004-bef6-c90e4718b8bc" class=""><strong>Cons</strong></p>
            <ul id="183504e6-f752-80a5-8cf7-e5fe98e4fc12" class="bulleted-list">
                <li style="list-style-type:disc">Build time increases as the shared module grows.</li>
            </ul>
            <ul id="183504e6-f752-804b-85fc-ec978b808816" class="bulleted-list">
                <li style="list-style-type:disc">This design doesn&#x27;t allow for separate features or having
                    dependencies only in the features that the application needs.</li>
            </ul>
            <p id="183504e6-f752-8004-8fcc-c274c5695f7d" class="">When a KMP project grows, it&#x27;s common to add more
                shared modules besides the initial one. This happens naturally when implementing new functionalities in
                KMP instead of using native modules, or when teams gradually adopt this technology.</p>
            <p id="179504e6-f752-80d4-9d65-edae97291abd" class="">To maintain scalable and manageable code, it&#x27;s
                recommended to split the shared module into smaller feature modules.</p>
            <p id="179504e6-f752-8043-b360-ddc8909d15c1" class="">Let&#x27;s see this represented in the following
                image.</p>
            <figure id="179504e6-f752-80af-b3ed-eea24725b1ed" class="image"><a
                    href="https://documents.lucid.app/documents/a473ab8f-6d26-4f79-865b-041bba56047a/pages/0_0?a=2195&amp;x=18&amp;y=552&amp;w=903&amp;h=595&amp;store=1&amp;accept=image%2F*&amp;auth=LCA%2048dd893de427b31a97015c5d88daf87a19c9454f1803e0758914f8dbd370c4d9-ts%3D1712187140"><img
                        style="width:677px"
                        src="https://documents.lucid.app/documents/a473ab8f-6d26-4f79-865b-041bba56047a/pages/0_0?a=2195&amp;x=18&amp;y=552&amp;w=903&amp;h=595&amp;store=1&amp;accept=image%2F*&amp;auth=LCA%2048dd893de427b31a97015c5d88daf87a19c9454f1803e0758914f8dbd370c4d9-ts%3D1712187140" /></a>
                <figcaption>Example of a book selling app</figcaption>
            </figure>
            <p id="179504e6-f752-80fe-b99d-e9ada5383971" class="">As shown in the image, we have two modules (features)
                that represent different flows in our application, along with a shared module (data) that these features
                use. Additionally, we have sub-modules to manage specific information in our application (in this case,
                books).</p>
            <p id="179504e6-f752-80df-88d0-c6c99a59927a" class="">While this approach offers clear benefits in the
                separation of responsibilities, it also presents specific challenges when generating binaries for each
                platform (especially in iOS, as we&#x27;ll see later).</p>
            <p id="183504e6-f752-804d-aeb7-e6c7ddd47b94" class=""><strong>Pros</strong></p>
            <ul id="179504e6-f752-809a-8ff5-f2fd5d8599c7" class="bulleted-list">
                <li style="list-style-type:disc">Separation of concerns for shared code.</li>
            </ul>
            <ul id="183504e6-f752-8040-986e-c4bb7034e53f" class="bulleted-list">
                <li style="list-style-type:disc">Better scalability.</li>
            </ul>
            <p id="183504e6-f752-804c-bb8a-e666f3e78d6a" class=""><strong>Cons</strong></p>
            <ul id="183504e6-f752-8020-b4ac-eb9b4744b679" class="bulleted-list">
                <li style="list-style-type:disc">More complicated setup, including umbrella framework configuration.
                </li>
            </ul>
            <ul id="183504e6-f752-8059-b9b8-dc8ffe16620e" class="bulleted-list">
                <li style="list-style-type:disc">More complex dependency management across modules.</li>
            </ul>
            <h2 id="183504e6-f752-8088-981c-fa596c0f04d9" class="">Multiple Shared Modules</h2>
            <p id="179504e6-f752-802c-9cf8-f1e762ad7cd3" class="">When working with multiple shared modules, there are
                important differences between platforms. In Android, the application can directly depend on all or some
                feature modules as needed, as it uses Gradle modules for its definition. On the other hand, the iOS
                application can only depend on a single framework generated by the Kotlin Multiplatform module. To
                handle multiple modules in iOS, it&#x27;s necessary to create an additional module called the Umbrella
                module, which depends on all modules in use. This module is configured to generate a framework
                containing all modules, known as the <strong>Umbrella</strong> framework.</p>
            <p id="179504e6-f752-809c-bbdd-d2998c6235d8" class="">
            </p>
            <figure id="179504e6-f752-80fa-b004-cf1610dbed63" class="image"><a
                    href="images/Captura_de_pantalla_2024-04-06_a_la(s)_12.35.40.png"><img
                        style="width:585px"
                        src="images/Captura_de_pantalla_2024-04-06_a_la(s)_12.35.40.png" /></a>
            </figure>
            <p id="179504e6-f752-80ec-9518-e1f836cb5cf6" class="">The Android application can depend on the Umbrella
                module to maintain consistency, or use feature modules separately. The Umbrella module typically
                contains utilities and dependency injection configurations.</p>
            <p id="179504e6-f752-80ba-aad5-ee13ce27c2be" class="">The Umbrella framework only exports selected modules,
                especially when consumed as a remote dependency. This helps minimize the final artifact size and
                excludes unnecessary auto-generated code.</p>
            <p id="179504e6-f752-8005-87ee-d1d507b40e2e" class="">An important limitation of this approach is that the
                iOS application must consume all feature modules included in the Umbrella framework, without being able
                to select only some of them.</p>
            <h2 id="179504e6-f752-80cd-b261-c2f32bed1b30" class="">Why do you need an Umbrella framework?</h2>
            <p id="179504e6-f752-803b-9127-c67d31fcecd4" class="">While it&#x27;s technically possible to use multiple
                Kotlin Multiplatform module frameworks in iOS, it&#x27;s not recommended. When a module is converted to
                a framework, it includes all its dependencies; if these are duplicated, it not only increases the
                application size but can also generate conflicts and errors.</p>
            <p id="179504e6-f752-8077-845e-ece449399ea6" class="">Kotlin avoids generating common framework dependencies
                to maintain an efficient binary and eliminate redundancies. Sharing these dependencies is not feasible
                because the Kotlin compiler cannot anticipate the requirements of other compilations.</p>
            <p id="179504e6-f752-8079-86b4-db1afccaed96" class="">The optimal solution is to implement an Umbrella
                framework, which prevents dependency duplication, optimizes the final result, and avoids compatibility
                issues.</p>
            <p id="179504e6-f752-8072-b46c-ee4863b84c52" class="">
            </p>
            <figure class="block-color-gray_background callout" style="display:flex"
                id="179504e6-f752-80e1-852b-cbbd4f311060">
                <div style="font-size:1.5em"><span class="icon">ðŸ’¡</span></div>
                <div style="width:100%">For more details about the exact limitations, please check the <a
                        href="https://touchlab.co/multiple-kotlin-frameworks-in-application/">TouchLab
                        documentation</a>.</div>
            </figure>
            <p id="179504e6-f752-808c-82c1-f2e268813fbf" class="">
            </p>
            <figure id="179504e6-f752-800a-a4fe-d5425cc348ba" class="image"><a
                    href="https://documents.lucid.app/documents/a473ab8f-6d26-4f79-865b-041bba56047a/pages/0_0?a=2285&amp;x=1043&amp;y=506&amp;w=808&amp;h=727&amp;store=1&amp;accept=image%2F*&amp;auth=LCA%200943e0b36150f828eaf10123b155d15fc4c7c9ab4ffe4e6570a2a4ff05d39a78-ts%3D1712187140"><img
                        style="width:606px"
                        src="https://documents.lucid.app/documents/a473ab8f-6d26-4f79-865b-041bba56047a/pages/0_0?a=2285&amp;x=1043&amp;y=506&amp;w=808&amp;h=727&amp;store=1&amp;accept=image%2F*&amp;auth=LCA%200943e0b36150f828eaf10123b155d15fc4c7c9ab4ffe4e6570a2a4ff05d39a78-ts%3D1712187140" /></a>
            </figure>
            <h2 id="179504e6-f752-8057-b63a-c35bea10a464" class="">Exposing Multiple KMP Frameworks in Detail</h2>
            <p id="179504e6-f752-80d8-89d5-de413e7e77b2" class="">Kotlin Multiplatform has a fundamental limitation: the
                iOS platform cannot access Kotlin modules individually. Instead, it generates a single framework
                containing all exported Kotlin classes. While it is possible to generate multiple frameworks, this
                practice is inefficient as it produces a larger binary and creates overhead due to the duplication of
                Kotlin standard library classes.</p>
            <p id="179504e6-f752-80db-8049-d60d1ee3643e" class="">Additionally, all shared dependencies between Kotlin
                modules are also duplicated.</p>
            <p id="179504e6-f752-80a7-b80a-c76a6de93182" class="">In our example, we would have something like this:</p>
            <figure id="179504e6-f752-8043-9c7e-e5f90edc6934" class="image"><a
                    href="https://documents.lucid.app/documents/a473ab8f-6d26-4f79-865b-041bba56047a/pages/3Lvqx~5B9.OU?a=2405&amp;x=222&amp;y=290&amp;w=815&amp;h=639&amp;store=1&amp;accept=image%2F*&amp;auth=LCA%200a7c783c07572299aa9a15b29b0aec3e14d0c424c189b057e65027f2418dcc4e-ts%3D1712187140"><img
                        style="width:611px"
                        src="https://documents.lucid.app/documents/a473ab8f-6d26-4f79-865b-041bba56047a/pages/3Lvqx~5B9.OU?a=2405&amp;x=222&amp;y=290&amp;w=815&amp;h=639&amp;store=1&amp;accept=image%2F*&amp;auth=LCA%200a7c783c07572299aa9a15b29b0aec3e14d0c424c189b057e65027f2418dcc4e-ts%3D1712187140" /></a>
            </figure>
            <p id="179504e6-f752-803c-b75e-e14ea5075e60" class="">
            </p>
            <p id="179504e6-f752-8076-aa80-d666524bd85e" class="">The Book entity from the Home framework and the Book
                entity from the Checkout framework would represent the same entity defined in the data module. However,
                in our iOS application, these would be treated as two different entities in different contexts,
                generating unnecessary duplication.</p>
            <p id="179504e6-f752-8029-9b0c-d4f3adf6e01e" class="">The main limitation is that, in iOS, common classes
                from each framework are treated as different types. Therefore, a shared data structure cannot be used
                interchangeably between different frameworks.</p>
            <h2 id="179504e6-f752-80bc-a20a-f43d25040b13" class="">Let&#x27;s see our example implementation</h2>
            <p id="179504e6-f752-8022-b2ec-ead26b8d52e5" class="">Let&#x27;s see how to implement what we discussed
                above in code. We&#x27;ll create a KMP project that will include the Home, Checkout, and Data modules,
                following the structure we&#x27;ve seen in the examples.</p>
            <p id="179504e6-f752-8014-808b-caea3f2ea102" class="">In this first implementation, we&#x27;ll separate the
                code using frameworks in iOS and modules in Android. The interesting part will be observing the behavior
                of our objects when working with multiple frameworks in iOS.</p>
            <p id="179504e6-f752-80e1-817d-d84cbd545cf8" class="">To illustrate this, we&#x27;ll use the following class
                diagram:</p>
            <figure id="179504e6-f752-80f0-98a7-c3d672f9f56a" class="image"><a
                    href="https://documents.lucid.app/documents/a473ab8f-6d26-4f79-865b-041bba56047a/pages/PuPq9tTH3flp?a=2860&amp;x=222&amp;y=66&amp;w=1255&amp;h=744&amp;store=1&amp;accept=image%2F*&amp;auth=LCA%208e5e9ebc32260a07d2ede5c8d95e5c034bffa53d8020d5e08abc13f17e155051-ts%3D1712187140"><img
                        style="width:700px"
                        src="https://documents.lucid.app/documents/a473ab8f-6d26-4f79-865b-041bba56047a/pages/PuPq9tTH3flp?a=2860&amp;x=222&amp;y=66&amp;w=1255&amp;h=744&amp;store=1&amp;accept=image%2F*&amp;auth=LCA%208e5e9ebc32260a07d2ede5c8d95e5c034bffa53d8020d5e08abc13f17e155051-ts%3D1712187140" /></a>
            </figure>
            <p id="179504e6-f752-80e1-9a76-eee1db367b03" class="">As we can observe, the ProcessCheckout class from the
                :checkout module and the GetAll class from the :home module depend on BookRepository, which is located
                in the :data:book module.</p>
            <p id="179504e6-f752-809a-9ceb-cda348256b80" class="">The structure of our project would look like this:</p>
            <figure id="179504e6-f752-8069-b5ca-d7896bf696d5" class="image"><a
                    href="images/Captura_de_pantalla_2024-04-07_a_la(s)_13.23.20.png"><img
                        style="width:266.97918701171875px"
                        src="images/Captura_de_pantalla_2024-04-07_a_la(s)_13.23.20.png" /></a>
            </figure>
            <p id="179504e6-f752-8012-b036-d398f6764211" class="">As we can observe in the diagram below,</p>
            <figure id="179504e6-f752-8001-8959-d76146b28988" class="image"><a
                    href="https://documents.lucid.app/documents/a473ab8f-6d26-4f79-865b-041bba56047a/pages/0_0?a=2195&amp;x=18&amp;y=552&amp;w=903&amp;h=595&amp;store=1&amp;accept=image%2F*&amp;auth=LCA%2048dd893de427b31a97015c5d88daf87a19c9454f1803e0758914f8dbd370c4d9-ts%3D1712187140"><img
                        style="width:677px"
                        src="https://documents.lucid.app/documents/a473ab8f-6d26-4f79-865b-041bba56047a/pages/0_0?a=2195&amp;x=18&amp;y=552&amp;w=903&amp;h=595&amp;store=1&amp;accept=image%2F*&amp;auth=LCA%2048dd893de427b31a97015c5d88daf87a19c9454f1803e0758914f8dbd370c4d9-ts%3D1712187140" /></a>
                <figcaption>Ejemplo de una app de venta de libros</figcaption>
            </figure>
            <p id="179504e6-f752-80fd-8866-d40d4de6818b" class="">Android and iOS applications will be responsible for
                orchestrating the modules (frameworks in iOS) through native code (Kotlin or Swift).</p>
            <blockquote id="179504e6-f752-80b1-8d49-e0653828de43" class="">The implementation of multiple
                modules/frameworks generated from KMP modules can facilitate the gradual adoption of this technology in
                existing projects. However, it&#x27;s important to consider the limitations mentioned above if we opt
                for this approach.</blockquote>
            <p id="179504e6-f752-8009-8283-d66cdbe0f6da" class="">Let&#x27;s start with Android</p>
            <p id="179504e6-f752-80a8-85e1-c5f72972632a" class="">Our Android application will use the following
                dependency configuration</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-8078-9613-d1ccd5b38f83" class="code"><code class="kotlin">dependencies {
            //Checkout
        implementation(projects.checkout)
        //Home
        implementation(projects.home)
        //Data
        implementation(projects.data)
    
        implementation(libs.compose.ui)
        implementation(libs.compose.ui.tooling.preview)
        implementation(libs.compose.material3)
        implementation(libs.androidx.activity.compose)
    
        debugImplementation(libs.compose.ui.tooling)
    }</code></pre>
            <p id="179504e6-f752-8044-95c3-f5029b68eba3" class="">We will include the modules :checkout,
                <code>:home</code> and <code>:data</code> in our build.gradle.kts file.
            </p>
            <p id="179504e6-f752-8092-8759-c9c00682ca42" class="">Next, we&#x27;ll see a practical example of using
                classes between different modules and how the references from the :data module work, which is shared
                between the feature modules. For this, we&#x27;ll create a ViewModel that will instantiate the
                <code>ProcessCheckout</code> and <code>GetAll</code> classes, both sharing a common dependency:
                <code>BookRepository</code>.
            </p>
            <figure id="179504e6-f752-809c-b5d4-df6c53630da8" class="image"><a
                    href="images/Captura_de_pantalla_2024-04-07_a_la(s)_13.48.35.png"><img
                        style="width:610.9722290039062px"
                        src="images/Captura_de_pantalla_2024-04-07_a_la(s)_13.48.35.png" /></a>
            </figure>
            <p id="179504e6-f752-807b-add2-e3e833b1c821" class="">Looking at the imports, we&#x27;ll notice that
                <code>BookRepository</code> comes from data and is the same dependency used by both home and checkout
                modules. The same happens with the book entity, thus avoiding dependency duplication.
            </p>
            <p id="179504e6-f752-8004-83af-f49ad1c86005" class="">Now, let&#x27;s look at the same example in iOS to
                verify that the behavior is different.</p>
            <p id="179504e6-f752-8050-b5a9-c74ca028ec66" class="">Like in Android, let&#x27;s start by configuring our
                Podfile with the <code>:home</code> and <code>:checkout</code> modules in our iOS application.</p>
            <figure id="179504e6-f752-8097-a4b1-e69fb567bd29" class="image"><a
                    href="images/Captura_de_pantalla_2024-04-07_a_la(s)_13.52.24.png"><img
                        style="width:498.9410095214844px"
                        src="images/Captura_de_pantalla_2024-04-07_a_la(s)_13.52.24.png" /></a>
            </figure>
            <p id="179504e6-f752-8073-8cb8-ff238df47288" class="">Now let&#x27;s implement our previous example in
                Swift.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-80d7-9862-f69a4e30b9f9" class="code"><code class="swift">import Foundation
    import home
    import checkout
    
    class MainViewModel {
        
        let bookRepository = DataBookRepository()
        let processCheckout = ProcessCheckout(repository: bookRepository)
        let getAll = GetAll(repository: bookRepository)
        
        
        func checkout() {
            let books = getAll.invoke()
            let currentBook = books.first
            
            processCheckout.invoke(book: currentBook)
        }
    }</code></pre>
            <p id="179504e6-f752-80c5-ba01-c90bed67ea66" class="">Similar to the previous example in Kotlin, we would
                have a BookRepository instance that we will use in both ProcessCheckout from the checkout framework and
                GetAll from the home framework. However, let&#x27;s look at the first issue in the following image.</p>
            <figure id="179504e6-f752-809c-8e7c-c29bd0794023" class="image"><a
                    href="images/Captura_de_pantalla_2024-04-07_a_la(s)_13.58.12.png"><img
                        style="width:707.9861450195312px"
                        src="images/Captura_de_pantalla_2024-04-07_a_la(s)_13.58.12.png" /></a>
            </figure>
            <p id="179504e6-f752-8017-9f3c-cf7b1f9513d7" class="">
            </p>
            <figure class="block-color-gray_background callout" style="display:flex"
                id="179504e6-f752-805f-9ece-dad80e73e41c">
                <div style="font-size:1.5em"><span class="icon">ðŸ’¡</span></div>
                <div style="width:100%">The compiler renames the &#x27;BookRepository&#x27; class to
                    &#x27;DataBookRepository&#x27; for use in Swift.</div>
            </figure>
            <p id="179504e6-f752-8053-be43-f57db9c98045" class="">When trying to create an instance of the
                DataBookRepository class, the compiler shows an &quot;Ambiguous use of init&quot; error. This occurs
                because the compiler cannot determine which constructor to use, as there are two references with the
                same name, as we&#x27;ll see in the following images.</p>
            <p id="179504e6-f752-803e-8681-cd3e0ddf3906" class="">We&#x27;ll proceed by removing the line causing the
                error and continue with the implementation. This will allow us to confirm that the issue arises because
                the DataBookRepository class is simultaneously defined in both the checkout and home frameworks.</p>
            <figure id="179504e6-f752-807d-ad73-e6fad654253c" class="image"><a
                    href="images/Captura_de_pantalla_2024-04-07_a_la(s)_13.57.05.png"><img
                        style="width:708px"
                        src="images/Captura_de_pantalla_2024-04-07_a_la(s)_13.57.05.png" /></a>
                <figcaption>Pods&gt;Development
                    Pods&gt;checkout&gt;Frameworks&gt;checkout.framework&gt;Headers&gt;checkout.h</figcaption>
            </figure>
            <figure id="179504e6-f752-80c6-abad-fd6fefa7e91a" class="image"><a
                    href="images/Captura_de_pantalla_2024-04-07_a_la(s)_13.57.16.png"><img
                        style="width:707.9688110351562px"
                        src="images/Captura_de_pantalla_2024-04-07_a_la(s)_13.57.16.png" /></a>
                <figcaption>Pods&gt;Development Pods&gt;home&gt;Frameworks&gt;home.framework&gt;Headers&gt;home.h
                </figcaption>
            </figure>
            <p id="179504e6-f752-80e9-b624-e64c025f55fc" class="">thus showing the duplication of classes. The same
                happens with the Book entity.</p>
            <figure id="179504e6-f752-80c5-ad94-f993694fb554" class="image"><a
                    href="images/Captura_de_pantalla_2024-04-07_a_la(s)_14.13.13.png"><img
                        style="width:707.8993530273438px"
                        src="images/Captura_de_pantalla_2024-04-07_a_la(s)_14.13.13.png" /></a>
            </figure>
            <h2 id="179504e6-f752-808b-bec6-c1bb049469f6" class="">Implementing the Umbrella Module</h2>
            <p id="179504e6-f752-801d-b01e-edd49b28a60d" class="">Let&#x27;s solve our problem by implementing the
                Umbrella module. We&#x27;ll create a :shared module that will encompass our :checkout and :home
                features, allowing us to include a single framework in iOS.</p>
            <p id="179504e6-f752-80b0-86ce-d566658fb7c5" class="">
            </p>
            <figure id="179504e6-f752-8073-9bc7-eca34b04e459" class="image"><a
                    href="https://documents.lucid.app/documents/a473ab8f-6d26-4f79-865b-041bba56047a/pages/0_0?a=2955&amp;x=1043&amp;y=506&amp;w=808&amp;h=727&amp;store=1&amp;accept=image%2F*&amp;auth=LCA%20f68b0111602a60e00b04869b4b6ad9061f9bd0e7deb7558570186f100df4955b-ts%3D1712187140"><img
                        style="width:606px"
                        src="https://documents.lucid.app/documents/a473ab8f-6d26-4f79-865b-041bba56047a/pages/0_0?a=2955&amp;x=1043&amp;y=506&amp;w=808&amp;h=727&amp;store=1&amp;accept=image%2F*&amp;auth=LCA%20f68b0111602a60e00b04869b4b6ad9061f9bd0e7deb7558570186f100df4955b-ts%3D1712187140" /></a>
                <figcaption>Definition of the shared module in our project.</figcaption>
            </figure>
            <p id="179504e6-f752-8098-b871-e0b3a6f8f8d1" class="">With this modification, the project structure will
                look like this.</p>
            <figure id="179504e6-f752-802e-b2f6-d8f9970c3aab" class="image"><a
                    href="images/Captura_de_pantalla_2024-04-07_a_la(s)_15.53.14.png"><img
                        style="width:286.97918701171875px"
                        src="images/Captura_de_pantalla_2024-04-07_a_la(s)_15.53.14.png" /></a>
            </figure>
            <p id="179504e6-f752-80d0-b79a-ffae9dc7a725" class="">In the &#x27;shared&#x27; module, we will define the
                dependencies mentioned above. For this, we will add the following configuration in our build.gradle.kts
                file:</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-8072-9fa6-f2a781177185" class="code"><code class="kotlin">kotlin {
        //...
        
        cocoapods {
            summary = &quot;Some description for the Shared Module&quot;
            homepage = &quot;Link to the Shared Module homepage&quot;
            version = &quot;1.0&quot;
            ios.deploymentTarget = &quot;16.0&quot;
            podfile = project.file(&quot;../iosApp/Podfile&quot;)
            framework {
                baseName = &quot;shared&quot;
                export(project(&quot;:home&quot;))
                export(project(&quot;:checkout&quot;))
            }
        }
    
        sourceSets {
            commonMain.dependencies {
                api(project(&quot;:home&quot;))
                api(project(&quot;:checkout&quot;))
            }
            commonTest.dependencies {
                implementation(libs.kotlin.test)
            }
        }
    }</code></pre>
            <p id="179504e6-f752-80ec-9c5b-f0f2c86d93d1" class="">In the commonMain dependencies, we include the :home
                and :checkout modules, along with the definition of our Cocoapods framework. The respective exports
                allow us to access these dependencies from our iOS code.</p>
            <p id="179504e6-f752-80ef-8975-dd1773ebeec9" class="">Next, we&#x27;ll see how our Podfile is configured
                with the shared module.</p>
            <figure id="179504e6-f752-8011-95e5-d5fc26ff2cc6" class="image"><a
                    href="images/Captura_de_pantalla_2024-04-07_a_la(s)_17.16.02.png"><img
                        style="width:521.9444580078125px"
                        src="images/Captura_de_pantalla_2024-04-07_a_la(s)_17.16.02.png" /></a>
            </figure>
            <p id="179504e6-f752-8064-b521-e1b2af9ee248" class="">To conclude the example, let&#x27;s look at the
                implementation of the code that previously had incompatibilities due to conflicts between
                the<code>:home</code>and<code>:checkout</code>frameworks.</p>
            <figure id="179504e6-f752-80be-a7fe-d90e9c2d96c3" class="image"><a
                    href="images/Captura_de_pantalla_2024-04-07_a_la(s)_16.03.46.png"><img
                        style="width:707.9688110351562px"
                        src="images/Captura_de_pantalla_2024-04-07_a_la(s)_16.03.46.png" /></a>
            </figure>
            <p id="179504e6-f752-8086-86ea-f88aefa820ee" class="">As we can observe, it is now possible to reuse the
                BookRepository instance in both ProcessCheckout and GetAll classes, since the type definition is the
                same regardless of which module it belongs to. This same behavior applies to the Book entity, as
                evidenced in the checkout function.</p>
            <h2 id="179504e6-f752-80e8-95be-f1fbfac1352f" class="">Compilation</h2>
            <p id="179504e6-f752-8062-9c6b-e0a573e077e7" class="">One of the main benefits of modularization is the
                reduction in compilation times, as unchanged modules can be cached. In theory, this works well, and the
                Android application effectively builds faster when only some modules have been modified.</p>
            <p id="179504e6-f752-8052-b0a1-f8801be4ee2b" class="">However, a challenge arises when building the
                Kotlin/Native part of KMM, specifically with the gradle tasks
                <em><code>linkDebugFrameworkIos</code></em> and <em><code>linkReleaseFrameworkIos</code></em>. These
                tasks are time-consuming, regardless of the number of modified modules.
            </p>
            <p id="179504e6-f752-80fb-978a-d0347689a4b2" class="">Despite this, I&#x27;ve found that it&#x27;s not
                always necessary to rebuild the shared module. When making minor changes, it&#x27;s enough to build the
                Android application or run iOS tests in the modified module for the changes to be reflected in the iOS
                application. It&#x27;s even possible that tests in other modules will also work correctly.</p>
            <p id="179504e6-f752-80e1-9d93-cd20196067a4" class="">While there&#x27;s no exact formula for this, this
                approach definitely speeds up the feedback cycle when building the iOS application. However, I believe
                that implementing automated tests for KMM logic will result in an even faster and more efficient
                feedback cycle than running Android or iOS applications with each change.</p>
            <p id="179504e6-f752-80e7-8dc7-e4d82cdaffed" class="">
            </p>
            <figure class="block-color-gray_background callout" style="display:flex"
                id="179504e6-f752-8099-a8d5-e1659efa79b0">
                <div style="font-size:1.5em"><span class="icon">ðŸ’¡</span></div>
                <div style="width:100%"> <strong>compilarKotlinIosArm64</strong> and
                    <strong>compilarKotlinIosX64</strong> significantly speed up compilation time.
                </div>
            </figure>
            <h1 id="179504e6-f752-80fd-aa8f-e6c1f310deeb" class="">Chapter 5: Testing</h1>
            <p id="179504e6-f752-8018-9fd0-d60f50e9e7db" class="">Kotlin Multiplatform has a fundamental goal: to allow
                developers to write code once and run it on multiple platforms. However, any error in this shared code
                can impact all platforms simultaneously.</p>
            <p id="179504e6-f752-8008-9e3b-d90f876d9b31" class="">As Uncle Ben said: <em>&quot;With great power comes
                    great responsibility.&quot;</em> For this reason, testing shared code is fundamental.</p>
            <p id="179504e6-f752-8023-b965-fe7ca54f39d9" class="">All software development needs testing to ensure code
                quality and reliability. In this regard, Kotlin Multiplatform provides various tools and options to
                perform effective testing across all supported platforms.</p>
            <p id="179504e6-f752-804a-8e0a-f4e3d807575f" class="">Kotlin Multiplatform not only makes it easy to share
                code between platforms but also allows writing tests that work across all platforms we support.</p>
            <h2 id="179504e6-f752-80c9-8e3a-c6429f58d137" class="">Benefits of Testing in Kotlin Multiplatform</h2>
            <p id="179504e6-f752-8015-9149-f3acd8d9def5" class="">Testing in Kotlin Multiplatform offers several key
                benefits:</p>
            <ol type="1" id="179504e6-f752-80ec-9dc8-d7932cd0b88d" class="numbered-list" start="1">
                <li><strong>Cross-platform consistency</strong>: Tests run on all supported platforms, ensuring uniform
                    quality across the entire application.</li>
            </ol>
            <ol type="1" id="179504e6-f752-80b9-bbe4-df65cdda3fd4" class="numbered-list" start="2">
                <li><strong>Development efficiency</strong>: Writing tests once for all platforms significantly reduces
                    time and effort compared to creating separate tests.</li>
            </ol>
            <ol type="1" id="179504e6-f752-803b-a9af-ea0ea0901366" class="numbered-list" start="3">
                <li><strong>Early error detection</strong>: Automated tests identify code issues from the start,
                    allowing corrections before they escalate.</li>
            </ol>
            <ol type="1" id="179504e6-f752-8091-8eff-ca610bac452d" class="numbered-list" start="4">
                <li><strong>Greater confidence in changes</strong>: A robust test suite allows developers to modify code
                    safely, knowing that tests will detect potential issues.</li>
            </ol>
            <h2 id="179504e6-f752-80af-83ed-f4c2ce0f9f06" class="">Tools for Testing in Kotlin Multiplatform</h2>
            <p id="179504e6-f752-80d1-a77e-caa4758e6922" class="">Kotlin Multiplatform provides a range of tools and
                libraries for testing across all compatible platforms.</p>
            <p id="179504e6-f752-80f3-acf9-d8d2064ec4c0" class="">The following libraries are available for writing
                tests. You can find references in the <a
                    href="https://github.com/terrakok/kmp-awesome#-test">kmp-awesome</a> repository.</p>
            <ul id="179504e6-f752-8018-bafb-f5d6357aa77c" class="bulleted-list">
                <li style="list-style-type:disc"><a href="https://github.com/kotest/kotest">Kotest</a> - test framework:
                    Powerful, elegant and flexible test framework for Kotlin with additional assertions, property
                    testing and data driven testing</li>
            </ul>
            <ul id="179504e6-f752-80cb-ae08-ea07565a4d82" class="bulleted-list">
                <li style="list-style-type:disc"><a href="https://github.com/cashapp/turbine">Turbine</a> - test
                    library: A small testing library for kotlinx.coroutines Flow</li>
            </ul>
            <ul id="179504e6-f752-80ef-b1b0-e98696869650" class="bulleted-list">
                <li style="list-style-type:disc"><a href="https://github.com/careem/mockingbird">MockingBird</a> - test
                    framework: A Koltin multiplatform library that provides an easier way to mock and write unit tests
                    for a multiplatform project</li>
            </ul>
            <ul id="179504e6-f752-800f-a592-cda60f2d6cf6" class="bulleted-list">
                <li style="list-style-type:disc"><a href="https://github.com/mockative/mockative">Mockative</a> -
                    Mocking with KSP: Mocking for Kotlin/Native and Kotlin Multiplatform using the Kotlin Symbol
                    Processing API (KSP)</li>
            </ul>
            <ul id="179504e6-f752-80fc-b207-d03d1dabbb4d" class="bulleted-list">
                <li style="list-style-type:disc"><a href="https://github.com/kosi-libs/MocKMP">MocKMP</a> - Mocking with
                    KSP: A Kotlin/Multiplatform Kotlin Symbol Processor that generates Mocks &amp; Fakes.</li>
            </ul>
            <ul id="179504e6-f752-8053-b4f3-ecaf2b6b0ed0" class="bulleted-list">
                <li style="list-style-type:disc"><a href="https://github.com/lupuuss/Mokkery">Mokkery</a> - Mocking
                    library: Mokkery is a mocking library for Kotlin Multiplatform, easy to use, boilerplate-free and
                    compiler plugin driven. Highly inspired by MockK.</li>
            </ul>
            <ul id="179504e6-f752-80f3-abc7-eca2904cb23b" class="bulleted-list">
                <li style="list-style-type:disc"><a href="https://github.com/mpetuska/klip">KLIP</a> - Snapshot
                    ((c|k)lip) manager for tests. Kotlin Multiplatform snapshot ((c|k)lip) manager for tests.
                    Automatically generates and asserts against a persistent Any::toString() representation of the
                    object until you explicitly trigger an update. Powered by kotlin compiler plugin to inject relevant
                    keys and paths.</li>
            </ul>
            <ul id="179504e6-f752-80b7-bdb1-f732d3bb0516" class="bulleted-list">
                <li style="list-style-type:disc"><a href="https://github.com/willowtreeapps/assertk">Assertk</a> -
                    Fluent assertions library</li>
            </ul>
            <p id="179504e6-f752-8001-a907-d2ee4aa1309f" class="">While most of these tools are community creations,
                several have achieved widespread adoption due to their popularity.</p>
            <p id="179504e6-f752-8011-952b-c0d461b13e9d" class="">In this article, we&#x27;ll explore some of these
                tools as examples.</p>
            <h2 id="179504e6-f752-80fa-a900-e02d4e4196ca" class="">Types of Tests</h2>
            <p id="179504e6-f752-80d9-b8bb-eb57859cf085" class="">When discussing tests, we generally refer to different
                types, represented in a pyramid as shown below.</p>
            <figure id="179504e6-f752-80c6-8766-cab88a965b1f" class="image"><a
                    href="images/Untitled%203.png"><img
                        style="width:707.9688110351562px"
                        src="images/Untitled%203.png" /></a>
            </figure>
            <p id="179504e6-f752-8042-b1fc-f384640b6f54" class="">As shown in the pyramid axes, the distribution is
                based on two fundamental aspects of testing: execution <strong>Speed</strong> and test
                <strong>Coverage</strong>.
            </p>
            <p id="179504e6-f752-80f7-a4fc-cba031b6ba4e" class="">The goal of Kotlin Multiplatform is to share business
                logic across multiple platforms. Since UI tests will depend on platform-specific frameworks, we&#x27;ll
                focus on unit and integration tests.</p>
            <h3 id="179504e6-f752-8066-a0f5-caeab85735fc" class="">Essential Unit Tests</h3>
            <p id="179504e6-f752-804d-832e-f7f6f421416e" class="">To follow best practices, implement unit tests for the
                following components:</p>
            <ul id="179504e6-f752-8072-8ff6-df19c56ca48d" class="bulleted-list">
                <li style="list-style-type:disc">For <strong>ViewModels</strong> or presenters.</li>
            </ul>
            <ul id="179504e6-f752-802a-a907-d54bbea3863f" class="bulleted-list">
                <li style="list-style-type:disc">For the <strong>data</strong> layer, especially repositories. This
                    layer should be mostly platform-independent, allowing test doubles to replace databases and remote
                    data sources.</li>
            </ul>
            <ul id="179504e6-f752-8035-ada7-c3888baef9c1" class="bulleted-list">
                <li style="list-style-type:disc">For other platform-independent layers, such as the
                    <strong>Domain</strong> layer, including use cases and interactions.
                </li>
            </ul>
            <ul id="179504e6-f752-80e9-8e95-f32204cdcc24" class="bulleted-list">
                <li style="list-style-type:disc">For <strong>utility classes</strong>, such as string manipulation
                    operations and mathematical calculations.</li>
            </ul>
            <p id="179504e6-f752-805e-9b81-c88c5a2177ba" class="">Let&#x27;s explore what we mean by the concept of a
                unit.</p>
            <h3 id="179504e6-f752-801f-941b-ca036f958f5d" class="">What do we understand as a unit in our unit tests
                (Subject Under Test - SUT)?</h3>
            <p id="179504e6-f752-8008-a3cf-d128d554fa52" class="">What do we mean by unit? ðŸ¤” Let&#x27;s define this
                fundamental concept and its principles.</p>
            <p id="179504e6-f752-805e-86aa-c25393329091" class="">There&#x27;s a common tendency to establish a
                <strong>one-to-one relationship between tests and classes</strong>. However, this practice can result in
                <strong>fragile tests</strong> that depend too heavily on specific implementations. The true goal
                isn&#x27;t to achieve 100% coverage, but to ensure our tests effectively verify code behavior.
            </p>
            <p id="179504e6-f752-8095-9936-dcc10889a35e" class="">To develop more robust tests, let&#x27;s consider two
                essential principles: tests should only change when business specifications change, and code refactoring
                should not affect the tests ðŸ‘Œ</p>
            <h3 id="179504e6-f752-8070-9399-f5121ee81f42" class="">Integration</h3>
            <p id="179504e6-f752-800b-b839-cc0fa65844e8" class="">In this type of test, we focus on validating the
                interaction between our application components in a broader context. This involves more complex
                scenarios that include interactions with external elements, such as HTTP request libraries and storage
                systems.</p>
            <figure class="block-color-gray_background callout" style="display:flex"
                id="179504e6-f752-80ef-bc37-cb406113b3fb">
                <div style="width:100%">It&#x27;s important to consider this point when choosing an external library. If
                    it includes testing tools, it will facilitate this type of testing (we&#x27;ll see this in more
                    detail in the example).</div>
            </figure>
            <h3 id="179504e6-f752-8047-8511-eae046926604" class="block-color-gray_background">How to identify the scope
                of our tests</h3>
            <p id="179504e6-f752-80f8-a101-ca4b3240f504" class="">Let&#x27;s see these concepts in action through a
                practical example: a simple application that displays a list of Rick and Morty characters.</p>
            <p id="179504e6-f752-80a5-9c0f-fe15a96e487c" class="">
            </p>
            <figure id="179504e6-f752-8043-a02f-dc13d008be12" class="image"><a
                    href="images/Captura_de_pantalla_2024-05-12_a_la(s)_1.20.28_p._m..png"><img
                        style="width:384px"
                        src="images/Captura_de_pantalla_2024-05-12_a_la(s)_1.20.28_p._m..png" /></a>
            </figure>
            <p id="179504e6-f752-80c9-ba26-db45f8b7d063" class="">The application consists of the following components
            </p>
            <figure id="183504e6-f752-80c9-96db-e9bbcf0094f7" class="image"><a
                    href="images/kmp-example-testing-uml.png"><img
                        style="width:707.9688110351562px"
                        src="images/kmp-example-testing-uml.png" /></a>
            </figure>
            <p id="179504e6-f752-80a5-8f6a-f766c19d1afc" class="">For the implementation, we use a ViewModel that acts
                as a state container for the views. The application has two main use cases:
                <code>GetAllCharacters</code> and <code>RefreshCharacters</code>, which manage the information. The
                <strong>CharacterRepository</strong> implements the repository pattern and serves as a single source of
                truth, interacting with two data sources: a local one (<code>CharacterLocalDataSource</code>) and a
                remote one (<code>CharacterNetworkDataSources</code>). These components are defined as contracts since
                they depend on concrete infrastructure implementations, such as a database and an HTTP client for server
                requests.
            </p>
            <p id="179504e6-f752-801b-8083-ea428fad4fc5" class="">Now, how do we determine the scope of our tests?
                Let&#x27;s define what each type represents:</p>
            <ul id="179504e6-f752-8066-8850-f888a86f2eed" class="bulleted-list">
                <li style="list-style-type:disc"><strong>Unit Test</strong>: Evaluates each use case individually, from
                    its logic to the interfaces, without including infrastructure implementations.</li>
            </ul>
            <ul id="179504e6-f752-80bd-a960-c446f353eff0" class="bulleted-list">
                <li style="list-style-type:disc"><strong>Integration Test</strong>: Evaluates the interaction
                    (integration) with the infrastructure implementation.</li>
            </ul>
            <p id="179504e6-f752-8034-a0df-c057a39972ec" class="">With these concepts clear for our application,
                let&#x27;s look at the scope in the following image.</p>
            <figure id="183504e6-f752-80ce-98bd-f1c31ba4e81d" class="image"><a
                    href="images/kmp-example-testing-uml(1).png"><img
                        style="width:707.951416015625px"
                        src="images/kmp-example-testing-uml(1).png" /></a>
            </figure>
            <p id="183504e6-f752-80d2-98f8-d389608627ee" class="">
            </p>
            <p id="179504e6-f752-805b-922d-d71d977c29a2" class="">Before implementing the tests in our example,
                let&#x27;s see how to configure and run them in our project.</p>
            <h2 id="179504e6-f752-802b-b505-f60e4c80049f" class="">How to Configure and Run our Tests</h2>
            <p id="179504e6-f752-8034-8e11-cc58aaf69125" class="">Just like in shared code, we&#x27;ll need specific
                dependencies for testing. For this, we&#x27;ll configure a dedicated sourceset/target for tests. Next,
                we&#x27;ll look at the necessary configuration for Android and iOS.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-8042-8113-f2779df7db4f" class="code"><code class="kotlin">kotlin{
       sourceSets {
               commonTest.dependencies {
                implementation(kotlin(&quot;test-common&quot;))
                implementation(kotlin(&quot;test-annotations-common&quot;))
                implementation(libs.resource.test)
                implementation(libs.kotlinx.coroutines.test)
                implementation(libs.turbine)
                implementation(libs.kotest.framework.engine)
    
                implementation(libs.ktor.client.mock)
    
                implementation(libs.koin.test)
            }
            
            val androidTest = sourceSets.getByName(&quot;androidUnitTest&quot;) {
                dependencies {
                    implementation(kotlin(&quot;test-junit&quot;))
                    implementation(libs.junit)
                    implementation(libs.sqldelight.jvm)
                }
            }
            
              
            iosTest.dependencies { 
                //ios testing dependencies
            }
       
       }
    
    }</code></pre>
            <p id="179504e6-f752-80cf-927b-d21816714f30" class="">In most cases, it&#x27;s not necessary to configure
                platform-specific dependencies since our main goal is to validate shared code.</p>
            <p id="179504e6-f752-80fe-a62f-d6630092cd18" class="">Once the dependencies are configured in their
                respective sourcesets, we&#x27;ll define the directory for tests, as shown in the following image.</p>
            <figure id="179504e6-f752-809d-bc80-ed19612983b3" class="image"><a
                    href="images/Captura_de_pantalla_2024-05-11_a_la(s)_1.04.32_p._m..png"><img
                        style="width:463.9583435058594px"
                        src="images/Captura_de_pantalla_2024-05-11_a_la(s)_1.04.32_p._m..png" /></a>
            </figure>
            <h3 id="179504e6-f752-80ac-8806-f68b14a5376d" class="">How to Run our Tests</h3>
            <p id="179504e6-f752-802f-bb73-ea936f56f226" class="">Tests can be executed in two ways: individually or all
                at once.</p>
            <p id="179504e6-f752-8035-8041-ef6e6d2c5a06" class="">To run a specific test, the IDE displays a play button
                next to each function marked with <code>@Test</code>.</p>
            <figure id="179504e6-f752-809b-a81e-f71663ad8857" class="image"><a
                    href="images/Captura_de_pantalla_2024-05-11_a_la(s)_1.09.31_p._m..png"><img
                        style="width:707.9861450195312px"
                        src="images/Captura_de_pantalla_2024-05-11_a_la(s)_1.09.31_p._m..png" /></a>
            </figure>
            <p id="179504e6-f752-8037-85f4-ece1112c6f67" class="">when pressing this button, a dropdown menu will appear
                that allows you to select the platform on which you want to run your tests</p>
            <figure id="179504e6-f752-80a1-981d-f4648d5eefc6" class="image"><a
                    href="images/Captura_de_pantalla_2024-05-11_a_la(s)_1.09.44_p._m..png"><img
                        style="width:370.9895935058594px"
                        src="images/Captura_de_pantalla_2024-05-11_a_la(s)_1.09.44_p._m..png" /></a>
            </figure>
            <p id="179504e6-f752-80e1-b6a8-cc40d5b87511" class="">Alternatively, we can run all tests using the Gradle
                verification task, either from the IDE or from the command line.</p>
            <figure id="179504e6-f752-80dc-9804-c805a341ca2b" class="image"><a
                    href="images/Captura_de_pantalla_2024-05-11_a_la(s)_1.15.25_p._m..png"><img
                        style="width:283.9930725097656px"
                        src="images/Captura_de_pantalla_2024-05-11_a_la(s)_1.15.25_p._m..png" /></a>
            </figure>
            <p id="179504e6-f752-8065-8674-e89328962ae0" class="">
            </p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-80e0-8b35-e6ee0c067a4e"
                class="code"><code class="language-Bash">./gradlew :shared:allTests</code></pre>
            <p id="179504e6-f752-8054-91ae-fe8e8365d0ea" class="">This task will run all our tests across the different
                platforms configured in the project.</p>
            <p id="179504e6-f752-80f2-9a97-e35733a5593e" class="">Now that we know how to configure and run our tests,
                let&#x27;s see how to implement them and what approaches Kotlin Multiplatform offers.</p>
            <h3 id="179504e6-f752-800a-ac0f-c034c70e39e1" class="">Let&#x27;s Code</h3>
            <p id="179504e6-f752-802a-98a7-d7ef39a0a316" class="">Let&#x27;s start with unit tests for our use cases.
                Before we begin, it&#x27;s important to familiarize ourselves with some key concepts that will help us
                create efficient unit tests that provide quick feedback.</p>
            <h2 id="179504e6-f752-80f0-ae56-e3689a8e742b" class="">How to Avoid Slow and Coupled Tests</h2>
            <ul id="179504e6-f752-803b-83ce-fa69d968fac6" class="bulleted-list">
                <li style="list-style-type:disc"><strong>Fakes: </strong>Fakes are alternative implementations that we
                    develop in parallel with the real implementation.</li>
            </ul>
            <ul id="179504e6-f752-80d8-9b67-dff88062eb0b" class="bulleted-list">
                <li style="list-style-type:disc"><strong>Stubs: </strong>Stubs are similar to Fakes, but with a key
                    difference: they contain <strong>predefined values</strong> that don&#x27;t need to be passed as
                    arguments when instantiating them.</li>
            </ul>
            <ul id="179504e6-f752-80f3-bd7b-df07c9aa3353" class="bulleted-list">
                <li style="list-style-type:disc"><strong>Mocks: </strong>Mocks have an important conceptual difference:
                    besides <strong>modeling the response</strong> of the element, they allow us to <strong>validate its
                        interaction</strong>. This means we can verify both behavior and collaboration between classes.
                </li>
            </ul>
            <h2 id="179504e6-f752-8037-8def-cb3d1d2c8201" class="">First Unit Test</h2>
            <p id="179504e6-f752-80de-8e21-e45455a707ca" class="">Let&#x27;s start with the use case for updating
                characters in the local data source. The following sequence diagram will help us visualize the update
                flow in our code.</p>
            <figure id="179504e6-f752-8048-bb82-e79743881ea7" class="image"><a
                    href="images/refresh-use-cases.png"><img
                        style="width:585.7728119180633px"
                        src="images/refresh-use-cases.png" /></a>
            </figure>
            <p id="179504e6-f752-802c-8510-c5e71244ddb3" class="">In our example, we&#x27;ll need to create test doubles
                for our data sources (DB and API). First, we&#x27;ll implement them manually, and then we&#x27;ll use a
                mocking library.</p>
            <p id="179504e6-f752-804a-a650-d6d7dd1707e1" class="">Let&#x27;s start with the implementation of
                <code>CharacterLocalDataSource</code>:
            </p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-80bd-802a-ce71c1b56ab7" class="code"><code class="kotlin">class InMemoryCharacterLocalDataSource : CharacterLocalDataSource {
       //....
    }</code></pre>
            <p id="179504e6-f752-8012-bce3-ecd6c109f568" class="">An in-memory implementation will store the information
                only during the test context.</p>
            <p id="179504e6-f752-8099-9ae5-d01a555566c5" class="">And for our <code>CharacterNetworkDataSource</code> we
                will create a Fake implementation.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-80af-86bc-f17fa4c6b261" class="code"><code class="kotlin">class FakeCharacterNetworkDataSource : CharacterNetworkDataSource {
        private val jsonLoader = JsonLoader()
        
        override suspend fun find(id: Long): Result&lt;NetworkCharacter&gt; {
            return all().fold(onSuccess = { characters -&gt;
                runCatching { characters.first { it.id == id } }
            }, onFailure = { Result.failure(it) })
        }
    
        override suspend fun all(): Result&lt;List&lt;NetworkCharacter&gt;&gt; {
            return runCatching {
                jsonLoader.load&lt;CharactersResponse&gt;(&quot;characters.json&quot;).results
            }
        }
    }</code></pre>
            <p id="179504e6-f752-803c-b0a9-e268e682ddc2" class="">In this implementation, we use a JsonLoader class that
                loads a JSON file (which contains a copy of the real API response). This allows us to work with
                realistic data during testing.</p>
            <p id="179504e6-f752-804e-9b69-e4548b7a192a" class="">To implement this JsonLoader, we use <strong><a
                        href="https://github.com/goncalossilva/kotlinx-resources/tree/main">kotlinx-resources</a></strong><strong>,</strong>
                a library that will be very useful in our upcoming tests. This tool makes it easy to load files from the
                local project directory.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-80b8-a830-c3bdfb839f2d" class="code"><code class="kotlin">class JsonLoader {
    
        private val json = Json {
            ignoreUnknownKeys = true
        }
    
        fun load(file: String): String {
            val loader = Resource(&quot;src/commonTest/resources/${file}&quot;)
            return loader.readText()
        }
    
        internal inline fun &lt;reified R : Any&gt; load(file: String) =
            this.load(file).convertToDataClass&lt;R&gt;()
    
        internal inline fun &lt;reified R : Any&gt; String.convertToDataClass(): R {
            return json.decodeFromString&lt;R&gt;(this)
        }
    
    }</code></pre>
            <p id="179504e6-f752-80e2-a3a9-fceaa9abe3b5" class="">This avoids having to create complex instances and
                manually generate data for tests.</p>
            <figure class="block-color-gray_background callout" style="display:flex"
                id="179504e6-f752-8080-9365-f6c62f9ff5f0">
                <div style="font-size:1.5em"><span class="icon">ðŸ’¡</span></div>
                <div style="width:100%">Tip: To improve the above, we could apply the Object Mother Pattern, which will
                    allow us to have more readable, maintainable, and quickly generated tests ðŸ‘Œ<p
                        id="b64d9f65-caa2-4dd2-ba66-28821053fd7e" class="">There are several strategies for managing
                        test instances:</p>
                    <ul id="858c480f-2583-473e-b3af-d08b7beb68be" class="bulleted-list">
                        <li style="list-style-type:disc">Traditional</li>
                    </ul>
                    <ul id="7c2744c0-82d3-4b85-b1a3-b442f88cc926" class="bulleted-list">
                        <li style="list-style-type:disc">Builder Pattern</li>
                    </ul>
                    <ul id="011a0e5b-4071-4515-a4d0-9e89f56b3d05" class="bulleted-list">
                        <li style="list-style-type:disc">Object Mother</li>
                    </ul>
                    <ul id="4b4f62e6-37bd-460b-91fb-a0de262ebe29" class="bulleted-list">
                        <li style="list-style-type:disc">Named Arguments</li>
                    </ul>
                </div>
            </figure>
            <p id="179504e6-f752-8073-b1a6-ea6df1d8b75e" class="">Now that we have our test doubles ready, let&#x27;s
                implement the first test to validate the successful case.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-80f3-989c-dec0e0a5b052" class="code"><code class="kotlin">class RefreshCharactersTest {
    
        private val networkDataSource = FakeCharacterNetworkDataSource()
        private val localDataSource = InMemoryCharacterLocalDataSource()
        private val repository = CharacterRepository(localDataSource, networkDataSource)
    
        private val refreshCharacters = RefreshCharacters(repository)
    
        @AfterTest
        fun tearDown() {
            localDataSource.clear()
        }
        
        @Test
        fun `When I call refresh update the local storage`() = runTest {
            // test code
        }
    }</code></pre>
            <p id="179504e6-f752-804d-8088-cb98299ea4f8" class="">First, we create the necessary instances for our
                tests: the object under test and the repository. The <strong>CharacterRepository</strong> and
                <strong>RefreshCharacters</strong> classes are real implementations, not mocked.
            </p>
            <figure class="block-color-gray_background callout" style="display:flex"
                id="179504e6-f752-808c-a229-f86d21415515">
                <div style="font-size:1.5em"><span class="icon">ðŸ’¡</span></div>
                <div style="width:100%">Another alternative would have been to create a test double for our repository,
                    but as we saw earlier, we only create test doubles for those components that have external
                    dependencies, such as input/output operations.</div>
            </figure>
            <p id="179504e6-f752-806b-9f92-f56cc52426bd" class="">Once the instances are generated, we define the test.
                Here we can use the Given-When-Then pattern to structure the test, invoke the use case, and perform the
                assertion on the datasource. In this case, since we use Flow, we are using <a
                    href="https://github.com/cashapp/turbine">Turbine</a> to interact with flows during testing.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-8073-bf89-cbd46c8f982e" class="code"><code class="kotlin">class RefreshCharactersTest {
    
        private val networkDataSource = FakeCharacterNetworkDataSource()
        private val localDataSource = InMemoryCharacterLocalDataSource()
        private val repository = CharacterRepository(localDataSource, networkDataSource)
    
        private val refreshCharacters = RefreshCharacters(repository)
    
        @AfterTest
        fun tearDown() {
            localDataSource.clear()
        }
        
        @Test
        fun `When I call refresh update the local storage`() = runTest {
                //Given
                //When
            refreshCharacters.invoke()
            //Then
            localDataSource.all.test {
                assertEquals(true, awaitItem().isNotEmpty())
            }
        }
    }</code></pre>
            <p id="179504e6-f752-80cd-b362-dba3d5cd89b3" class="">But how do we validate the case when the
                <code>NetworkDataSource</code> returns an empty response? For this, we need to modify our data source.
            </p>
            <p id="179504e6-f752-80e0-9079-e88a035f5512" class="">The solution is to implement a stub.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-80bb-95bb-d935b618dccd" class="code"><code class="kotlin">class StubCharacterNetworkDataSource(
        private val characters: MutableList&lt;NetworkCharacter&gt; = mutableListOf()
    ) : CharacterNetworkDataSource {
        
        fun setCharacters(characters: List&lt;NetworkCharacter&gt;) {
            this.characters.clear()
            this.characters.addAll(characters)
        }
        override suspend fun find(id: Long): Result&lt;NetworkCharacter&gt; {
            return all().fold(onSuccess = { characters -&gt;
                runCatching { characters.first { it.id == id } }
            }, onFailure = { Result.failure(it) })
        }
    
        override suspend fun all(): Result&lt;List&lt;NetworkCharacter&gt;&gt; {
            return runCatching { characters }
        }
    }</code></pre>
            <p id="179504e6-f752-80bc-b3d8-ff670007b000" class="">And the test would look like this</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-806a-9039-ca1b0776d0ad" class="code"><code class="kotlin">class RefreshCharactersTest {
    
        private val characters = JsonLoader.load&lt;CharactersResponse&gt;(&quot;characters.json&quot;).results
        private val networkDataSource = StubCharacterNetworkDataSource(characters.toMutableList())
        private val localDataSource = InMemoryCharacterLocalDataSource()
        private val repository = CharacterRepository(localDataSource, networkDataSource)
    
        private val refreshCharacters = RefreshCharacters(repository)
    
        @Test
        fun `When I call refresh update the local storage`() = runTest {
            refreshCharacters.invoke()
            localDataSource.all.test {
                assertEquals(true, awaitItem().isNotEmpty())
            }
        }
    
        @Test
        fun `When the service returns an empty response`() = runTest {
            networkDataSource.setCharacters(emptyList())
            refreshCharacters.invoke()
            localDataSource.all.test {
                assertEquals(true, awaitItem().isEmpty())
            }
        }
    }</code></pre>
            <p id="179504e6-f752-8035-a2b3-f955351c7c47" class="">As we need to generate different test scenarios,
                it&#x27;s essential to have more flexible mocks. However, we must remember that this code also requires
                maintenance. For this reason, it&#x27;s convenient to use mocking libraries like <a
                    href="https://mockk.io/">Mockk</a> or <a href="https://site.mockito.org/">Mockito</a>, which will be
                familiar to Android developers. While Kotlin Multiplatform doesn&#x27;t yet have solutions as
                established as these, they have served as inspiration for the community. In our example, we&#x27;ll use
                <a href="https://mokkery.dev/">Mokkery</a>, a library inspired by Mockk according to its documentation.
            </p>
            <figure class="block-color-gray_background callout" style="display:flex"
                id="179504e6-f752-80b2-8b30-d14bc437a0f3">
                <div style="font-size:1.5em"><span class="icon">ðŸ’¡</span></div>
                <div style="width:100%">Mockk is a mocking library implemented entirely in Kotlin that, according to its
                    documentation, offers multiplatform support. However, it still has some issues with native platforms
                    like iOS and macOS.</div>
            </figure>
            <p id="179504e6-f752-80b1-869f-f8d1feae2270" class="">Let&#x27;s see how to replace our mocks using
                <strong>Mokkery</strong>
            </p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-8060-bb12-e3402fabcbe3" class="code"><code class="kotlin">import dev.mokkery.answering.returns
    import dev.mokkery.everySuspend
    import dev.mokkery.mock
    
    class RefreshCharactersTest {
    
        private val characters = CharactersResponseMother.characters()
        private val networkDataSource = mock&lt;CharacterNetworkDataSource&gt;()
        private val localDataSource = InMemoryCharacterLocalDataSource()
        private val repository = CharacterRepository(localDataSource, networkDataSource)
    
        private val refreshCharacters = RefreshCharacters(repository)
    
        @Test
        fun `When I call refresh update the local storage`() = runTest {
                //Given
            everySuspend {
                networkDataSource.all()
            } returns Result.success(characters)
            //When
            refreshCharacters.invoke()
            //Then
            localDataSource.all.test {
                assertEquals(true, awaitItem().isNotEmpty())
            }
        }
    
        @Test
        fun `When the service returns an empty response`() = runTest {
            //Given
            everySuspend {
                networkDataSource.all()
            } returns Result.success(emptyList())
            //When
            refreshCharacters.invoke()
            //Then
            localDataSource.all.test {
                assertEquals(true, awaitItem().isEmpty())
            }
        }
    }</code></pre>
            <p id="179504e6-f752-8066-9af1-f63339f9bfca" class="">With Mokkery, we can create a mock of the
                <code>CharacterNetworkDataSource</code> interface in the following way:
            </p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-8024-8204-fedab5dd93cd"
                class="code"><code class="kotlin">private val networkDataSource = mock&lt;CharacterNetworkDataSource&gt;()</code></pre>
            <p id="179504e6-f752-8050-ae27-dfe6d7c7a8df" class="">and configure the behavior of its methods</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-8023-9991-d9ed77c8dc09" class="code"><code class="kotlin">  everySuspend {
          networkDataSource.all()
      } returns Result.success(characters)</code></pre>
            <p id="179504e6-f752-8038-a2fe-e1b6bff67fa3" class="">With a mocking library, we can also easily perform
                other types of verifications, such as checking that the &#x27;all&#x27; method of networkDataSource was
                called exactly once.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-8061-ab81-e54e747f8272" class="code"><code class="kotlin">    @Test
        fun `When I call refresh update the local storage`() = runTest {
            //Given
            everySuspend {
                networkDataSource.all()
            } returns Result.success(characters)
            //When
            refreshCharacters.invoke()
            //Then
            verifySuspend(mode = exactly(1)) {
                networkDataSource.all()
            }
            localDataSource.all.test {
                assertEquals(true, awaitItem().isNotEmpty())
            }
        }</code></pre>
            <p id="179504e6-f752-803a-a9b8-d8ece05297fe" class="">Thanks to Mokkery, we can now test the remaining cases
                more efficiently and clearly.</p>
            <figure id="179504e6-f752-8074-b6c1-c26a474f39bb"><a href="https://mokkery.dev/docs/Setup"
                    class="bookmark source">
                    <div class="bookmark-info">
                        <div class="bookmark-text">
                            <div class="bookmark-title">Setup | Mokkery</div>
                            <div class="bookmark-description">How to add Mokkery to your Gradle project rapidly!</div>
                        </div>
                        <div class="bookmark-href"><img src="https://mokkery.dev/img/favicon.png"
                                class="icon bookmark-icon" />https://mokkery.dev/docs/Setup</div>
                    </div><img src="https://mokkery.dev/img/logo-social.jpg" class="bookmark-image" />
                </a></figure>
            <figure class="block-color-gray_background callout" style="display:flex"
                id="179504e6-f752-8002-ab80-d129d3f9b085">
                <div style="width:100%">It is recommended to generate mocks only for interfaces that are coupled to
                    external data sources, as we saw in the previous example.</div>
            </figure>
            <h2 id="179504e6-f752-8086-ba53-d56d8139fbf3" class="block-color-gray_background">Integration Tests</h2>
            <p id="179504e6-f752-80b7-a4e6-dfbff0bb0bca" class="">As shown in the initial diagram, we will validate the
                integration of components and their behavior.</p>
            <figure id="183504e6-f752-8067-989b-d3eb6989d213" class="image"><a
                    href="images/kmp-example-testing-uml(2).png"><img
                        style="width:707.951416015625px"
                        src="images/kmp-example-testing-uml(2).png" /></a>
            </figure>
            <p id="179504e6-f752-8061-a411-e3f4ad0b1545" class="">Integration tests allow us to validate the
                infrastructure, that is, the external libraries we use to manage our data. In our case, we use Ktor for
                HTTP requests and SQLDelight for local storage. Both libraries provide specific tools for testing.</p>
            <h3 id="179504e6-f752-8054-b0f2-c7f6eb579a93" class="">Testing with Ktor</h3>
            <p id="179504e6-f752-80b1-9863-f434c543dd19" class="">Ktor provides an &quot;Engine&quot; that allows us to
                create simulations of our services. The implementation is simple: we just need to define an Engine of
                type &quot;MockEngine&quot; and incorporate it into our client configuration.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-8062-b94a-ebbe3e4d8fd3" class="code"><code class="kotlin">val mockEngine = MockEngine { request -&gt;
        respond(
            content = ByteReadChannel(&quot;&quot;&quot;{&quot;ip&quot;:&quot;127.0.0.1&quot;}&quot;&quot;&quot;),
            status = HttpStatusCode.OK,
            headers = headersOf(HttpHeaders.ContentType, &quot;application/json&quot;)
        )
    }</code></pre>
            <p id="179504e6-f752-8024-8d38-e2e317c1d986" class="">To facilitate testing with Ktor, we will create some
                simple abstractions that will allow us to reuse configurations across all our tests. We will implement
                the following code to configure the Mock engine for testing.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-8056-ab93-ec9606032e0b" class="code"><code class="kotlin">fun testKtorClient(mockClient: MockClient = MockClient()): HttpClient {
        val engine = testKtorEngine(mockClient)
        return HttpClient(engine) {
            install(ContentNegotiation) {
                json(Json {
                    prettyPrint = true
                    isLenient = true
                    ignoreUnknownKeys = true
                })
            }
        }
    }
    
    private fun testKtorEngine(interceptor: ResponseInterceptor) = MockEngine { request -&gt;
        val response = interceptor(request)
        respond(
            content = ByteReadChannel(response.content),
            status = response.status,
            headers = headersOf(HttpHeaders.ContentType, &quot;application/json&quot;)
        )
    }</code></pre>
            <p id="179504e6-f752-80e2-a0b9-cbd1f6ecb86c" class="">You can find the complete code <a
                    href="https://github.com/santimattius/kmp-for-mobile-native-developers/blob/unit_and_integration_testing/shared/src/commonTest/kotlin/com/santimattius/kmp/integration/data/network/MockClient.kt">here</a>.
            </p>
            <p id="179504e6-f752-80bd-bc78-e8f350c88fb0" class="">Now let&#x27;s see how to implement our integration
                tests</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-80b5-a966-ce30bcf2b081" class="code"><code class="kotlin">class RefreshCharactersIntegrationTest {
    
        private val jsonResponse = JsonLoader.load(&quot;characters.json&quot;)
        //KtorClient setup
        private val mockClient = MockClient()
        private val ktorClient = testKtorClient(mockClient)
        private val networkDataSource = KtorCharacterNetworkDataSource(ktorClient)
    
        private val localDataSource = InMemoryCharacterLocalDataSource()
        private val repository = CharacterRepository(localDataSource, networkDataSource)
    
        private val refreshCharacters = RefreshCharacters(repository)
    
        @AfterTest
        fun tearDown() {
            localDataSource.clear()
        }
    
        @Test
        fun `When I call refresh update the local storage`() = runTest {
            //Given
            val response = DefaultMockResponse(jsonResponse, HttpStatusCode.OK)
            mockClient.setResponse(response)
            //When
            refreshCharacters.invoke()
            //Then
            localDataSource.all.test {
                assertEquals(true, awaitItem().isNotEmpty())
            }
        }</code></pre>
            <p id="179504e6-f752-8083-8fb9-c0194439de56" class="">In the test, we will create an instance of
                <code>KtorCharacterNetworkDataSource</code>, which concretely implements our
                <code>CharacterNetworkDataSource</code> interface. This time we will initialize it with a special
                HttpClient for testing that uses MockEngine.
            </p>
            <p id="179504e6-f752-8042-9ea4-c5278bf73a38" class="">Let&#x27;s apply the same approach to our
                <code>CharacterLocalDataSource</code>.
            </p>
            <figure id="179504e6-f752-809c-90a2-f80d1281ce3c"><a href="https://ktor.io/docs/client-testing.html"
                    class="bookmark source">
                    <div class="bookmark-info">
                        <div class="bookmark-text">
                            <div class="bookmark-title">Testing | Ktor</div>
                            <div class="bookmark-description">Ktor provides a MockEngine that simulates HTTP calls
                                without connecting to the endpoint.</div>
                        </div>
                        <div class="bookmark-href"><img
                                src="https://resources.jetbrains.com/storage/products/company/brand/logos/Ktor_icon.png"
                                class="icon bookmark-icon" />https://ktor.io/docs/client-testing.html</div>
                    </div><img src="https://raw.githubusercontent.com/ktorio/ktor-documentation/main/preview.png"
                        class="bookmark-image" />
                </a></figure>
            <h3 id="179504e6-f752-802e-be30-f73a3a836a8d" class="">Testing with SQLDelight</h3>
            <p id="179504e6-f752-8083-8799-dd3e42f97d08" class="">SQLDelight can be used for testing, but it requires
                platform-specific configuration. In its implementation, we need to define an appropriate driver for each
                platform.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-805c-85ed-f47827ee0249" class="code"><code class="kotlin">// database.common.kt
    expect class DriverFactory {
        fun createDriver(): SqlDriver
    }
    
    fun createDatabase(driver: SqlDriver): CharactersDatabase {
        return CharactersDatabase(driver)
    }
    
    // database.android.kt
    actual class DriverFactory(private val context: Context) {
        actual fun createDriver(): SqlDriver {
            return AndroidSqliteDriver(CharactersDatabase.Schema, context, &quot;app_database.db&quot;)
        }
    }
    
    //database.ios.kt
    actual class DriverFactory {
        actual fun createDriver(): SqlDriver {
            return NativeSqliteDriver(CharactersDatabase.Schema, &quot;app_database.db&quot;)
        }
    }</code></pre>
            <p id="179504e6-f752-80e1-81dd-e4279edd072f" class="">In our case, we have a <code>DriverFactory</code>
                class implemented in both Android and iOS, each with its specific drivers. For testing, we follow the
                same principle, but apply it to the source code sets intended for tests.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-8076-b645-eb40aec268e6" class="code"><code class="kotlin">//test.database.common.kt
    expect fun testDbDriver(): SqlDriver
    
    //test.database.android.kt
    actual fun testDbDriver(): SqlDriver {
        return JdbcSqliteDriver(JdbcSqliteDriver.IN_MEMORY)
            .also {
                CharactersDatabase.Schema.create(it)
            }
    }
    //test.database.ios.kt
    actual fun testDbDriver(): SqlDriver {
        return inMemoryDriver(CharactersDatabase.Schema)
    }</code></pre>
            <p id="179504e6-f752-8088-9a5c-e447f8eddc3d" class="">As we can observe, this library uses a similar concept
                to what we implemented in our <code>InMemoryCharacterLocalDataSource</code>, which is an in-memory
                implementation.</p>
            <p id="179504e6-f752-805a-8475-ff77a29837bb" class="">Let&#x27;s implement this change in our test.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-80da-a760-dfaf9cd8f26e" class="code"><code class="kotlin">class RefreshCharactersIntegrationTest {
    
        private val jsonResponse = JsonLoader.load(&quot;characters.json&quot;)
    
        //KtorClient setup
        private val mockClient = MockClient()
        private val ktorClient = testKtorClient(mockClient)
        private val networkDataSource = KtorCharacterNetworkDataSource(ktorClient)
    
        //SQLDelight setup
        private val db = createDatabase(driver = testDbDriver())
        private val localDataSource = SQLDelightCharacterLocalDataSource(db)
        private val repository = CharacterRepository(localDataSource, networkDataSource)
    
        private val refreshCharacters = RefreshCharacters(repository)
    
        @Test
        fun `When I call refresh update the local storage`() = runTest {
            //Given
            val response = DefaultMockResponse(jsonResponse, HttpStatusCode.OK)
            mockClient.setResponse(response)
            //When
            refreshCharacters.invoke()
            //Then
            localDataSource.all.test {
                assertEquals(true, awaitItem().isNotEmpty())
            }
        }
    
        @Test
        fun `When the service returns an empty response`() = runTest {
            //Given
            val response = DefaultMockResponse(&quot;{}&quot;, HttpStatusCode.OK)
            mockClient.setResponse(response)
            //When
            refreshCharacters.invoke()
    
            localDataSource.all.test {
                assertEquals(true, awaitItem().isEmpty())
            }
        }
    }</code></pre>
            <p id="179504e6-f752-80ad-ac31-fdf012b6f3a8" class="">Similar to Ktor, we use instances of our local storage
                implementation, <code>SQLDelightCharacterLocalDataSource</code>.</p>
            <figure id="179504e6-f752-804b-a275-f5556fe72d91"><a
                    href="https://cashapp.github.io/sqldelight/2.0.0/android_sqlite/testing/" class="bookmark source">
                    <div class="bookmark-info">
                        <div class="bookmark-text">
                            <div class="bookmark-title">Testing - SQLDelight</div>
                            <div class="bookmark-description">SQLDelight - Generates typesafe Kotlin APIs from SQL</div>
                        </div>
                        <div class="bookmark-href"><img
                                src="https://cashapp.github.io/sqldelight/2.0.0/images/icon-cashapp.png"
                                class="icon bookmark-icon" />https://cashapp.github.io/sqldelight/2.0.0/android_sqlite/testing/
                        </div>
                    </div>
                </a></figure>
            <p id="179504e6-f752-80bd-bc35-c7d7a87dc332" class="">So far, we have validated all components of the use
                case through our tests. Now, let&#x27;s see how we can improve the code in our project and measure its
                coverage.</p>
            <h3 id="179504e6-f752-8050-b0a0-ee6393d68d74" class="">Validating our Dependency Injection</h3>
            <p id="179504e6-f752-803f-801d-f5423e5f53a9" class="">In integration tests, we make minimal adjustments to
                external library configurations to adapt them to testing needs. However, this process can become
                repetitive for each use case. This is where dependency injection and Koin help us optimize these
                configurations.</p>
            <p id="179504e6-f752-8044-b236-e1fbc11f0c38" class="">The first step is to configure our test dependencies
                with Koin.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-8083-9b1d-cef6443fabcf" class="code"><code class="kotlin">val testPlatformModule: Module = module {
        single&lt;SqlDriver&gt; { testDbDriver() }
        single&lt;MockClient&gt; { MockClient() }
        single&lt;HttpClient&gt; { testKtorClient(get()) }
    }</code></pre>
            <p id="179504e6-f752-802e-b8ce-e35a371b5f3c" class="">After defining our dependencies, we configure the test
                to use Koin.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-80e2-8d36-ebaa915ad270" class="code"><code class="kotlin">class RefreshCharactersIntegrationTest : KoinTest {
    
        private val jsonResponse = JsonLoader.load(&quot;characters.json&quot;)
    
        //KtorClient setup
        private val mockClient: MockClient by inject()
    
        @BeforeTest
        fun setUp() {
            startKoin {
                modules(
                    testPlatformModule,
                    sharedModule
                )
            }
        }
    
        @AfterTest
        fun tearDown() {
            stopKoin()
        }
        
        @Test
        fun `When I call refresh update the local storage`() = runTest {
            //.....
        }
    }</code></pre>
            <p id="179504e6-f752-808a-8503-cca93434e508" class="">and in our test we request an instance of the object
                under test, in this case <code>RefreshCharacters</code></p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-800e-881e-f80b1ae31e6f" class="code"><code class="kotlin">  @Test
        fun `When I call refresh update the local storage`() = runTest {
            //Given
            val useCase = get&lt;RefreshCharacters&gt;() //from koin
            val localDataSource = get&lt;CharacterLocalDataSource&gt;()
            val response = MockResponse.ok(jsonResponse)
            mockClient.setResponse(response)
            //When
            useCase.invoke()
            //Then
            localDataSource.all.test {
                assertEquals(true, awaitItem().isNotEmpty())
            }
        }</code></pre>
            <h3 id="179504e6-f752-80aa-8756-e13a2718937b" class="">Verifying our Dependency Graph with Koin</h3>
            <p id="179504e6-f752-8070-bd7c-d2b39eb5e7ef" class="">With Koin, we can verify that our dependency graph is
                created correctly. To do this, we simply call the <code>checkModules()</code> function within a test.
                This function will load all our modules and verify that each definition can be executed correctly.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-80f0-8616-febcae920efd" class="code"><code class="kotlin">// koin test functions
    fun startTestKoin(testModule: Module): KoinApplication {
        return startKoinApplication(listOf(testModule, sharedModule))
    }
    
    fun stopTestKoin() {
        stopKoin()
    }</code></pre>
            <p id="179504e6-f752-8046-addc-c6a54390a50f" class="">
            </p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-803b-ac70-c9a4124f1650" class="code"><code class="kotlin">class CheckModulesTest : KoinTest {
    
        @AfterTest
        fun tearDown() {
            stopTestKoin()
        }
    
        @Test
        fun `validate modules`() {
            startTestKoin(testPlatformModule)
                .checkModules()
        }
    }</code></pre>
            <p id="179504e6-f752-80eb-b963-d8cd4ced7bd0" class="">If any definition is missing in our dependencies, the
                test will fail and specifically indicate which definition is missing. This verification is crucial when
                working with Koin.</p>
            <figure id="179504e6-f752-80b7-9494-d3e24bda685d"><a
                    href="https://insert-koin.io/docs/reference/koin-test/checkmodules/" class="bookmark source">
                    <div class="bookmark-info">
                        <div class="bookmark-text">
                            <div class="bookmark-title">Verifying your Koin configuration | Koin</div>
                            <div class="bookmark-description">Koin allows you to verify your configuration modules,
                                avoiding discovering dependency injection issues at runtime.</div>
                        </div>
                        <div class="bookmark-href"><img src="https://insert-koin.io/img/favicon.ico"
                                class="icon bookmark-icon" />https://insert-koin.io/docs/reference/koin-test/checkmodules/
                        </div>
                    </div>
                </a></figure>
            <h2 id="179504e6-f752-802c-962e-cbdf478421e4" class="">Coverage Metrics</h2>
            <p id="179504e6-f752-804a-b333-d6dd9e8f9c67" class="">Test coverage metrics indicate what percentage of code
                has been tested, being fundamental to evaluate test quality and identify areas without coverage. While
                these metrics don&#x27;t guarantee the complete absence of errors, tools like Jacoco and Slather allow
                us to calculate them and integrate them into the development cycle. In Kotlin Multiplatform, we&#x27;ll
                use Kover, a Gradle plugin similar to Jacoco.</p>
            <h3 id="179504e6-f752-8091-9fe8-e22e81f7e11f" class="">Kover</h3>
            <p id="179504e6-f752-80db-aa81-c7fda3c15a75" class="">Kover is a toolset designed to measure test coverage
                of Kotlin code compiled for JVM and Android platforms. Its main component is a Gradle plugin that
                we&#x27;ll explore next.</p>
            <p id="179504e6-f752-802b-996d-f8a1abea39c7" class=""><strong>Kover Features</strong></p>
            <ul id="179504e6-f752-80de-8a40-c5807f46a003" class="bulleted-list">
                <li style="list-style-type:disc">Code coverage measurement through <code>JVM</code> tests (important: no
                    support yet for JS and native targets).</li>
            </ul>
            <ul id="179504e6-f752-801f-8d63-e7ca1b0a0963" class="bulleted-list">
                <li style="list-style-type:disc">Report generation in <code>HTML</code> and <code>XML</code> formats.
                </li>
            </ul>
            <ul id="179504e6-f752-80c0-b6a5-c58914f9b041" class="bulleted-list">
                <li style="list-style-type:disc">Compatibility with <code>Kotlin JVM</code> and
                    <code>Kotlin Multiplatform</code> projects.
                </li>
            </ul>
            <ul id="179504e6-f752-801a-97e4-ea95eea5ebf2" class="bulleted-list">
                <li style="list-style-type:disc">Support for <code>Kotlin Android</code> projects with build variants
                    (note: instrumentation tests on Android devices are not yet supported).</li>
            </ul>
            <ul id="179504e6-f752-80e9-a1d6-cd99a950c463" class="bulleted-list">
                <li style="list-style-type:disc">Compatibility with mixed <code>Kotlin</code> and <code>Java</code>
                    code.</li>
            </ul>
            <ul id="179504e6-f752-804e-8851-ccd1358753fe" class="bulleted-list">
                <li style="list-style-type:disc">Configuration of verification rules with coverage thresholds in the
                    Gradle plugin.</li>
            </ul>
            <ul id="179504e6-f752-8022-bd19-efb00b36d111" class="bulleted-list">
                <li style="list-style-type:disc">Integration with JaCoCo library as an alternative for measuring
                    coverage and generating reports.</li>
            </ul>
            <p id="179504e6-f752-8075-b837-d195d3c6dc54" class="">To implement Kover in our project, we only need to add
                its Gradle plugin:</p>
            <p id="179504e6-f752-805f-9fd3-f67e93ff50be" class="">
            </p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-805f-b49e-c9ebabeed46f" class="code"><code class="kotlin">plugins {
         id(&quot;org.jetbrains.kotlinx.kover&quot;) version &quot;0.7.6&quot;
    }</code></pre>
            <p id="179504e6-f752-8058-a86d-ec1a27e94e19" class="">Once the plugin is added, we&#x27;ll be able to run
                the Kover tasks available in Gradle.</p>
            <figure id="179504e6-f752-80ab-955b-f2900343a8b7" class="image"><a
                    href="images/Captura_de_pantalla_2024-05-12_a_la(s)_12.56.49_p._m..png"><img
                        style="width:392.98614501953125px"
                        src="images/Captura_de_pantalla_2024-05-12_a_la(s)_12.56.49_p._m..png" /></a>
            </figure>
            <p id="179504e6-f752-806d-8ec5-e992936dcf44" class="">
            </p>
            <p id="179504e6-f752-8088-b16b-c3dce990e9f0" class="">In this case we will execute </p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-80aa-b049-cbe68be5635a"
                class="code"><code class="language-Bash">./gradlew :shared:koverHtmlReportDebug</code></pre>
            <p id="179504e6-f752-80a2-a1e4-d72dd439ffbc" class="">To generate the HTML report shown below</p>
            <figure id="179504e6-f752-805b-a54c-ffeae441b688" class="image"><a
                    href="images/Captura_de_pantalla_2024-05-11_a_la(s)_9.15.48_p._m..png"><img
                        style="width:720px"
                        src="images/Captura_de_pantalla_2024-05-11_a_la(s)_9.15.48_p._m..png" /></a>
            </figure>
            <p id="179504e6-f752-80d0-a32d-f4d28dd916f1" class="">You can configure coverage limits in your projects
                using Kover by defining custom rules. For example:</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-80fb-ba63-fbd66e0550c5" class="code"><code class="kotlin">koverReport {
        verify {
            rule(&quot;Basic Line Coverage&quot;) {
                isEnabled = true
                bound {
                    minValue = 80 // Minimum coverage percentage
                    maxValue = 100 // Maximum coverage percentage (optional)
                    metric = MetricType.LINE
                    aggregation = AggregationType.COVERED_PERCENTAGE
                }
            }
    
            rule(&quot;Branch Coverage&quot;) {
                isEnabled = true
                bound {
                    minValue = 70 // Minimum coverage percentage for branches
                    metric = MetricType.BRANCH
                }
            }
        }
    }</code></pre>
            <p id="179504e6-f752-80d6-8ea9-d1bf0d54d208" class="">Although Kover is in Alpha version and does not yet
                support Kotlin Native, it is useful for validating our shared code.</p>
            <h2 id="179504e6-f752-80ed-bf7f-e5eed6a56a43" class="">Best Practices for Testing in Kotlin Multiplatform
            </h2>
            <p id="179504e6-f752-80cc-b45b-f9dc9ec300d1" class="">To ensure effective testing in Kotlin Multiplatform,
                we can follow these software development best practices:</p>
            <ol type="1" id="179504e6-f752-8023-a574-e9bc8bf2be5d" class="numbered-list" start="1">
                <li><strong>Write tests from the start</strong>: Beginning with tests early in development helps detect
                    problems early and builds a solid testing foundation.</li>
            </ol>
            <ol type="1" id="179504e6-f752-80cb-be87-e6d8edf57c27" class="numbered-list" start="2">
                <li><strong>Automate testing</strong>: Automation ensures consistent execution and minimizes human
                    error.</li>
            </ol>
            <ol type="1" id="179504e6-f752-8019-a732-d24e5a6b4f9f" class="numbered-list" start="3">
                <li><strong>Use parameterized tests</strong>: These tests allow evaluation of multiple data sets with a
                    single test case, improving maintainability. For this we can use <a
                        href="https://kotest.io/">Kotest</a>.</li>
            </ol>
            <ol type="1" id="179504e6-f752-8093-b4c7-dd7420c3aa7f" class="numbered-list" start="4">
                <li><strong>Separate tests from implementations</strong>: Keeping test code separate from production
                    code improves organization and facilitates future changes.</li>
            </ol>
            <h2 id="179504e6-f752-807f-b432-db8ae9126369" class="">Rules for Using Tests in Multiplatform Projects</h2>
            <p id="179504e6-f752-80bb-96ee-eded0ef0edec" class="">When implementing tests in Kotlin Multiplatform
                applications, consider these important guidelines:</p>
            <ul id="179504e6-f752-805b-9fd5-f24f20af5406" class="bulleted-list">
                <li style="list-style-type:disc">For common code, use only multiplatform libraries like <a
                        href="https://kotlinlang.org/api/latest/kotlin.test/">kotlin.test</a>. Add dependencies to the
                    <code>commonTest</code> set.
                </li>
            </ul>
            <ul id="179504e6-f752-80ae-a94b-e446ead5243f" class="bulleted-list">
                <li style="list-style-type:disc">The <code>Asserter</code> type from <code>kotlin.test</code> should be
                    used indirectly. Although the instance is visible, avoid using it directly in tests.</li>
            </ul>
            <ul id="179504e6-f752-8092-9c88-ca7330e275d0" class="bulleted-list">
                <li style="list-style-type:disc">Stick to the testing library API. The compiler and IDE will help you
                    avoid framework-specific features.</li>
            </ul>
            <ul id="179504e6-f752-8031-a30c-c98ea9ddb944" class="bulleted-list">
                <li style="list-style-type:disc">When using <code>commonTest</code>, run your tests with each planned
                    framework to verify correct environment setup.</li>
            </ul>
            <ul id="179504e6-f752-80db-8466-e3fbccaa63e5" class="bulleted-list">
                <li style="list-style-type:disc">For platform-specific code, take advantage of the framework&#x27;s
                    native features, including annotations and extensions.</li>
            </ul>
            <ul id="179504e6-f752-808b-afe6-fc7ee58eb9cb" class="bulleted-list">
                <li style="list-style-type:disc">Tests can be run from the IDE or through Gradle tasks.</li>
            </ul>
            <ul id="179504e6-f752-8063-adcf-c4d17e52149f" class="bulleted-list">
                <li style="list-style-type:disc">Test execution automatically generates HTML reports.</li>
            </ul>
            <p id="179504e6-f752-80fd-b057-f2296620862f" class="">
            </p>
            <p id="179504e6-f752-8005-ba42-d436d83ef93f" class="">
            </p>
            <figure id="179504e6-f752-80b4-86c9-fc2f8e1f58aa"><a
                    href="https://github.com/santimattius/kmp-for-mobile-native-developers/tree/unit_and_integration_testing"
                    class="bookmark source">
                    <div class="bookmark-info">
                        <div class="bookmark-text">
                            <div class="bookmark-title">GitHub - santimattius/kmp-for-mobile-native-developers at
                                unit_and_integration_testing</div>
                            <div class="bookmark-description">Companing App for Talk: &quot;KMP for Mobile Native
                                Developers&quot; - GitHub - santimattius/kmp-for-mobile-native-developers at
                                unit_and_integration_testing</div>
                        </div>
                        <div class="bookmark-href"><img src="https://github.com/fluidicon.png"
                                class="icon bookmark-icon" />https://github.com/santimattius/kmp-for-mobile-native-developers/tree/unit_and_integration_testing
                        </div>
                    </div><img
                        src="https://opengraph.githubassets.com/0050a8861d1341383b3556e6fcd1c817a58e6e5e0308800d15bf05390dd27695/santimattius/kmp-for-mobile-native-developers"
                        class="bookmark-image" />
                </a></figure>
            <h1 id="183504e6-f752-80c8-b152-e58869ec0b9c" class="">Chapter 6: Using Native Libraries in Kotlin
                Multiplatform</h1>
            <figure id="183504e6-f752-80ac-96ae-d242e2a3fb7f" class="image"><a
                    href="images/wrapper-all-the-thing.png"><img
                        style="width:707.9861450195312px"
                        src="images/wrapper-all-the-thing.png" /></a>
            </figure>
            <p id="183504e6-f752-8075-9f5d-f19829c36f53" class="">The adoption of Kotlin Multiplatform (KMP) represents
                a strategic step towards more coherent cross-platform development. This technology allows sharing code
                and business logic, reducing work duplication and improving consistency between applications. When
                starting projects with KMP for Android and iOS, a practical approach is to adapt and integrate existing
                native solutions into the KMP module, rather than rewriting everything from scratch. This strategy
                allows us to leverage both KMP functionalities and platform-specific code.</p>
            <p id="183504e6-f752-80ae-8621-dca970f51637" class="">In this section, we&#x27;ll explore how to extend the
                Bugsnag SDK for use from KMP modules, both in Android and iOS.</p>
            <p id="183504e6-f752-807b-9194-d8ee14d6c969" class="">We&#x27;ll start with the integration of existing
                native SDKs, focusing on avoiding unnecessary rewrites.</p>
            <p id="183504e6-f752-8054-8e8e-ccc8d43d704c" class="">How do we include Android or iOS specific code in a
                KMP module?</p>
            <h2 id="183504e6-f752-8090-9f22-ea0e05d998c8" class="">Using Android Dependencies in KMP</h2>
            <p id="183504e6-f752-8038-86f2-fa4eb9cdc3c2" class="">To add Android-specific dependencies to a Kotlin
                Multiplatform module, the process is identical to traditional Android projects. We just need to add the
                dependency in the Android source set within the <code>build.gradle(.kts)</code> file in the
                <code>shared</code> directory.
            </p>
            <p id="183504e6-f752-80de-8bc3-f14d48b56b19" class="">In this example, we&#x27;ll implement Bugsnag and
                Android Startup, two platform-exclusive dependencies for Android.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="183504e6-f752-800c-9096-cee08f2ffc76" class="code"><code class="kotlin">kotlin {
            sourcesets{
                  commonMain.dependencies{
                       // common dependencies
                  }
                androidMain.dependencies {
                  api(libs.bugsnag.android)
                  implementation(libs.androidx.startup.runtime)
              }
            }
    }</code></pre>
            <p id="183504e6-f752-803b-ba31-f663340078e3" class="">Once these dependencies are configured, we can use
                them within the Android sourceset.</p>
            <p id="183504e6-f752-8022-a4c4-dd2a0cbdb37a" class="">Next, we&#x27;ll explore the configuration of
                iOS-specific dependencies. Then we&#x27;ll return to the implementation after having the dependencies
                configured on both platforms.</p>
            <h2 id="183504e6-f752-8047-9f50-db19ef98a2c1" class="">How to Use iOS Dependencies in KMP</h2>
            <p id="183504e6-f752-80a1-b435-f403da51aa68" class="">Apple SDK dependencies like Foundation or Core
                Bluetooth are precompiled in Kotlin Multiplatform projects and require no additional configuration.</p>
            <p id="183504e6-f752-8047-80f8-e5e74a834c06" class="">You can reuse libraries and frameworks from the iOS
                ecosystem in your iOS sourcesets. Kotlin is compatible with Objective-C and Swift dependencies, as long
                as they expose their APIs to Objective-C using the <code>@objc</code> attribute. However, Swift-only
                dependencies are not yet supported.</p>
            <p id="183504e6-f752-8009-9f13-d8244cae9be1" class="">CocoaPods integration has the same limitation: it
                doesn&#x27;t support Swift-only pods.</p>
            <p id="183504e6-f752-8012-9765-d0846e423c41" class="">To manage iOS dependencies in Kotlin Multiplatform
                projects, we recommend <a
                    href="https://kotlinlang.org/docs/multiplatform-ios-dependencies.html#with-cocoapods">using
                    CocoaPods</a>. You should only <a
                    href="https://kotlinlang.org/docs/multiplatform-ios-dependencies.html#without-cocoapods">manage
                    dependencies manually</a> if you need to customize the interoperability process or have a specific
                reason to do so.</p>
            <p id="183504e6-f752-80bb-a607-c9639db99920" class="">In our case, we&#x27;ll use CocoaPods. To begin, we
                need to configure the CocoaPods plugin in our KMP project:</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="183504e6-f752-8013-a63e-f3de38bf9c9e"
                class="code"><code class="language-TOML">[versions]
    kotlin = &quot;your-kotlin-version&quot;
    
    [plugins]
    cocoaPods = { id = &quot;org.jetbrains.kotlin.native.cocoapods&quot;, version.ref = &quot;kotlin&quot; }</code></pre>
            <p id="183504e6-f752-80d4-8c85-f7ee943aa8d7" class="">Next, we&#x27;ll apply the CocoaPods plugin in both
                the root project and the shared module.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="183504e6-f752-80f5-8184-c0774d16d9df" class="code"><code class="kotlin">//root build.gradle.kts
    plugins {
        alias(libs.plugins.androidApplication) apply false
        alias(libs.plugins.androidLibrary) apply false
        alias(libs.plugins.kotlinMultiplatform) apply false
        alias(libs.plugins.jetbrainsKotlinAndroid) apply false
        alias(libs.plugins.cocoaPods) apply false
    }
    //shared module build.gradle.kts
    plugins {
        alias(libs.plugins.kotlinMultiplatform)
        alias(libs.plugins.cocoaPods)
        alias(libs.plugins.androidLibrary)
    }</code></pre>
            <p id="183504e6-f752-804a-9c03-c265b4f25bb9" class="">With the CocoaPods plugin installed, we can configure
                our shared module as a pod and define the necessary dependencies. For this example, we&#x27;ll use
                Bugsnag as a native library.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="183504e6-f752-809f-aa96-d57b57a16738" class="code"><code class="kotlin">kotlin{
        cocoapods {
            version = &quot;1.0&quot;
            summary = &quot;Some description for a Kotlin/Native module&quot;
            homepage = &quot;Link to a Kotlin/Native module homepage&quot;
            name = &quot;Shared&quot;
            ios.deploymentTarget = &quot;14.0&quot;
    
            framework {
                baseName = &quot;Shared&quot;
                isStatic = false
            }
    
            pod(&quot;Bugsnag&quot;){
                version = &quot;6.28.0&quot;
            }
        }
    }</code></pre>
            <p id="183504e6-f752-80b8-8d60-ca8362fd2707" class="">Now that we have configured the dependencies for both
                platforms, let&#x27;s see how to reuse these native APIs through Kotlin Multiplatform.</p>
            <h2 id="183504e6-f752-80e1-acd4-d0fb02f1de82" class="">Expect/Actual</h2>
            <p id="183504e6-f752-8062-a86f-c4084ac3751b" class="">Kotlin provides an elegant mechanism to access
                platform-specific APIs while developing common logic: <a
                    href="https://kotlinlang.org/docs/multiplatform-expect-actual.html">expect and actual
                    declarations</a>.</p>
            <p id="183504e6-f752-80a9-9d8f-f38b9faf6503" class="">The mechanism is simple: the common source set of a
                multiplatform module defines an expect declaration, and each platform source set provides its
                corresponding actual declaration. The compiler verifies that each declaration marked with the
                <code>expect</code> keyword in the common sources has its corresponding declaration marked with
                <code>actual</code> in all target platforms.
            </p>
            <p id="183504e6-f752-80ed-9626-ee3f2760603c" class="">This system works with most Kotlin declarations:
                functions, classes, interfaces, enums, properties, and annotations. In this section, we&#x27;ll focus on
                using expect/actual functions and properties.</p>
            <p id="183504e6-f752-8007-bd39-d68bfe174b47" class="">
            </p>
            <figure id="183504e6-f752-809f-bfcb-c0b7b0005f77" class="image"><a
                    href="images/Captura_de_pantalla_2024-06-01_a_la(s)_8.08.04_p._m..png"><img
                        style="width:557.9861450195312px"
                        src="images/Captura_de_pantalla_2024-06-01_a_la(s)_8.08.04_p._m..png" /></a>
            </figure>
            <p id="183504e6-f752-806f-9859-e517d9062296" class="">Now let&#x27;s look at the practical application of
                this concept using the Bugsnag API as an example.</p>
            <figure id="183504e6-f752-80a3-a1ed-c20439be1627" class="image"><a
                    href="images/Playground_-_Page_1(3).png"><img
                        style="width:2888px"
                        src="images/Playground_-_Page_1(3).png" /></a>
            </figure>
            <p id="183504e6-f752-8064-95d6-f84fc684e7d0" class="">The diagram above shows the general concept of our
                implementation. Let&#x27;s now look at the code in detail.</p>
            <p id="183504e6-f752-802e-a7c3-e3d70d40d655" class="">In <code>commonMain</code>, we&#x27;ll define the
                <code>expect</code> declarations for our API functions, ensuring consistency across platforms. Bugsnag
                represents an ideal case, as it maintains consistent nomenclature in its APIs for both Android and iOS,
                from method signatures to entity structures.
            </p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="183504e6-f752-8085-8573-e0a4e561f7bc" class="code"><code class="kotlin">// bugsnag.common.kt
    package com.santimattius.kmp.playground
    
    //SDK configurations
    expect class Configuration
    // Information track
    expect class TrackableException
    
    object Bugsnag {
    
        private val provider: PlatformTracker = PlatformTracker()
    
        fun initialize(config: Configuration) {
            provider.initialize(config)
        }
    
        fun track(exception: TrackableException) {
            provider.track(exception)
        }
    }
    
    internal expect class PlatformTracker(){
        fun initialize(config: Configuration)
        fun track(exception: TrackableException)
    }</code></pre>
            <p id="183504e6-f752-80f6-ac0b-deb31a1c034a" class="">Let&#x27;s look at the Android implementation.</p>
            <p id="183504e6-f752-8074-a19f-e08e2ce6753d" class="">In the androidMain sourceset, we&#x27;ll implement
                concrete versions of the classes defined in the shared code. For the entities <code>Configuration</code>
                and <code>TrackableException</code>, we&#x27;ll use <a
                    href="https://kotlinlang.org/docs/type-aliases.html">typealias</a> as a specific solution.
                Let&#x27;s look at this implementation in detail.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="183504e6-f752-8067-ab27-d788714c08fe" class="code"><code class="kotlin">package com.santimattius.kmp.playground
    
    import com.bugsnag.android.Bugsnag
    import com.bugsnag.android.Configuration as BugsnagConfiguration
    
    actual typealias Configuration = BugsnagConfiguration
    actual typealias TrackableException = Throwable
    
    internal actual class PlatformTracker {
        actual fun initialize(config: Configuration) {
            val context = applicationContext ?: run {
                // TODO: add logging later
                return
            }
            Bugsnag.start(context, config)
        }
    
        actual fun track(exception: TrackableException) {
            Bugsnag.notify(exception)
        }
    }</code></pre>
            <p id="183504e6-f752-80f0-b5f3-f82521c1945a" class="">As we can observe in the imports, the typealias acts
                as direct references to the native API entities.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="183504e6-f752-80af-962e-f9ae054d4f7d" class="code"><code class="kotlin">import com.bugsnag.android.Bugsnag
    import com.bugsnag.android.Configuration as BugsnagConfiguration</code></pre>
            <p id="183504e6-f752-80e4-b440-edc0a48c5e7e" class="">This is where we directly use Android dependencies.
            </p>
            <h3 id="183504e6-f752-8058-9b75-cff5664b1263" class="">How can we get the Android Context in KMP?</h3>
            <p id="183504e6-f752-805c-9ef0-c381e5cf11ad" class="">Among the Android-specific dependencies we defined
                earlier, we find Android Startup. Kotlin Multiplatform&#x27;s flexibility to implement platform-specific
                code allows us to apply an elegant solution:</p>
            <p id="183504e6-f752-8051-aa10-e19aa144e30c" class="">Bugsnag needs Android&#x27;s applicationContext to
                work during application startup. Through <a
                    href="https://developer.android.com/topic/libraries/app-startup">Android Startup</a>, we can obtain
                this context and, if desired, initialize our library.</p>
            <p id="183504e6-f752-8074-b0c0-f15be2e063d1" class="">The solution involves implementing an Android Startup
                Initializer to capture the applicationContext.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="183504e6-f752-80cb-8b40-d7173aec7d12" class="code"><code class="kotlin">internal var applicationContext: Context? = null
        private set
    
    class ContextInitializer: Initializer&lt;Unit&gt; {
        override fun create(context: Context) {
            applicationContext = context.applicationContext
        }
    
        override fun dependencies(): List&lt;Class&lt;out Initializer&lt;*&gt;&gt;&gt; {
            return emptyList()
        }
    }</code></pre>
            <p id="183504e6-f752-800a-8bc4-f6e53d17f8fc" class="">After defining the initializer, we need to register it
                in the AndroidManifest. To do this, we&#x27;ll first create this file in our androidMain directory.</p>
            <figure id="183504e6-f752-80b0-aef6-dd316d9786e6" class="image"><a
                    href="images/Captura_de_pantalla_2024-06-01_a_la(s)_8.49.26_p._m..png"><img
                        style="width:415.97222900390625px"
                        src="images/Captura_de_pantalla_2024-06-01_a_la(s)_8.49.26_p._m..png" /></a>
            </figure>
            <p id="183504e6-f752-806b-9c49-e8ac31769a12" class="">In the AndroidManifest.xml file, we need to add the
                following configuration:</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="183504e6-f752-809b-a24d-ea9f3c7563f7" class="code"><code class="language-XML">&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
        xmlns:tools=&quot;http://schemas.android.com/tools&quot;&gt;
    
        &lt;application&gt;
            &lt;provider
                android:name=&quot;androidx.startup.InitializationProvider&quot;
                android:authorities=&quot;${applicationId}.androidx-startup&quot;
                android:exported=&quot;false&quot;
                tools:node=&quot;merge&quot;&gt;
                &lt;meta-data
                    android:name=&quot;com.santimattius.kmp.playground.ContextInitializer&quot;
                    android:value=&quot;androidx.startup&quot; /&gt;
            &lt;/provider&gt;
        &lt;/application&gt;
    
    &lt;/manifest&gt;</code></pre>
            <p id="183504e6-f752-8081-a3fd-c11be702a91b" class="">To use Bugsnag in Android, we just need to reference
                our Bugsnag object from the application. Let&#x27;s see an example:</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="183504e6-f752-8082-a2db-fbb771dd4c06" class="code"><code class="kotlin">import android.app.Application
    import com.santimattius.kmp.playground.Bugsnag
    import com.santimattius.kmp.playground.Configuration
    
    class MainApplication : Application() {
    
        override fun onCreate() {
            super.onCreate()
            // Initialization
            Bugsnag.initialize(config = Configuration.load(this))
            // Send test exception
            Bugsnag.track(exception = Throwable(message = &quot;This is a test!!&quot;))
        }
    }</code></pre>
            <p id="183504e6-f752-80e4-8710-c50bfda2558d" class="">Thanks to the alias definitions, we can use native
                APIs directly from our Kotlin Multiplatform module, as shown in our import declarations.</p>
            <p id="183504e6-f752-808a-b23f-d296a878428f" class="">Next, we&#x27;ll look at the iOS implementation.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="183504e6-f752-80c0-abf7-d15a2624c752" class="code"><code class="kotlin">package com.santimattius.kmp.playground
    
    import cocoapods.Bugsnag.Bugsnag
    import cocoapods.Bugsnag.BugsnagConfiguration
    import kotlinx.cinterop.ExperimentalForeignApi
    import platform.Foundation.NSException
    
    @OptIn(ExperimentalForeignApi::class)
    actual typealias Configuration = BugsnagConfiguration
    actual typealias TrackableException = NSException
    
    @OptIn(ExperimentalForeignApi::class)
    internal actual class PlatformTracker {
        actual fun initialize(config: Configuration) {
            Bugsnag.startWithConfiguration(config)
        }
    
        actual fun track(exception: TrackableException) {
            Bugsnag.notify(exception)
        }
    }</code></pre>
            <p id="183504e6-f752-80f3-b80a-d8f720c944b1" class="">Looking at the imports, we can see that our
                definitions use native APIs provided by both the iOS platform and Bugsnag.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="183504e6-f752-80af-b170-f1e01cf0a3e7" class="code"><code class="kotlin">import cocoapods.Bugsnag.Bugsnag
    import cocoapods.Bugsnag.BugsnagConfiguration
    import kotlinx.cinterop.ExperimentalForeignApi
    import platform.Foundation.NSException</code></pre>
            <p id="183504e6-f752-8065-bd51-ddfc832f65a2" class="">
            </p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="183504e6-f752-80d0-971d-ca1d239514a3" class="code"><code class="swift">import SwiftUI
    import Shared
    import Bugsnag
    
    @main
    struct iOSApp: App {
        
        init() {
            // Initialization
             let config = BugsnagConfiguration.loadConfig()
             config.appVersion = &quot;1.0.0-alpha&quot;
    
             Bugsnag.shared.initialize(config: config)
             // Send test exception
             let exception = NSException(name:NSExceptionName(rawValue: &quot;NamedException&quot;),
                                  reason:&quot;Something happened&quot;,
                                  userInfo:nil)
             Bugsnag.shared.track(exception: exception)
        }
        
        var body: some Scene {
            WindowGroup {
                ContentView()
            }
        }
    }</code></pre>
            <p id="183504e6-f752-8030-a2ba-e8b1f075c44f" class="">Just like in Android, we&#x27;re using the
                platform&#x27;s native types, but this time accessing them through our Shared module.</p>
            <p id="183504e6-f752-807b-8a95-c6624c646c47" class="">Our Kotlin Multiplatform solution is ready! ðŸŽ‰</p>
            <p id="183504e6-f752-80e6-b511-f69c52e423ac" class="">
            </p>
            <figure id="183504e6-f752-80da-a6e1-f121d3e7cf68" class="image"><a
                    href="images/show-me-the-true.png"><img
                        style="width:480px"
                        src="images/show-me-the-true.png" /></a>
            </figure>
            <h2 id="183504e6-f752-8034-acbc-cb2018f5fb18" class="">Can we use it from a Kotlin Multiplatform module?
            </h2>
            <p id="183504e6-f752-8005-b809-f33a30d2fa43" class="">Can we use our Bugsnag SDK adaptation from a Kotlin
                Multiplatform (KMP) module? The answer is yes. In fact, making existing functionality accessible from
                our KMP modules is one of the main benefits driving the adoption of this technology.</p>
            <p id="183504e6-f752-80cb-b3c3-c6ab11987482" class="">To better understand how it works, let&#x27;s analyze
                a practical example with a repository.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="183504e6-f752-806a-9fb8-d62e2f4f0faa" class="code"><code class="kotlin">class CrashRepository {
    
        private val coroutineScope = CoroutineScope(Dispatchers.Default)
        
        suspend fun crash() {
            val handler = CoroutineExceptionHandler { _, exception -&gt;
                println(&quot;CoroutineExceptionHandler got $exception&quot;)
                // send log to bugsnag
                Bugsnag.track(exception.asTrackableException())
            }
            val job = coroutineScope.launch(handler) { // root coroutine, running in GlobalScope
                throw AssertionError()
            }
            val deferred = coroutineScope.async(handler) { // also root, but async instead of launch
                throw ArithmeticException() // Nothing will be printed, relying on user to call deferred.await()
            }
            joinAll(job, deferred)
        }
    }</code></pre>
            <p id="183504e6-f752-807c-9784-ea9cff64d382" class="">This is a deliberate example of how to generate an
                exception ðŸ˜€. Our goal is to capture this exception using CoroutineExceptionHandler and report it to
                Bugsnag through our SDK adaptation. For this, we need to transform the exception to the
                TrackableException type.</p>
            <figure class="block-color-gray_background callout" style="display:flex"
                id="183504e6-f752-8078-8f31-f6ae68106775">
                <div style="font-size:1.5em"><span class="icon">ðŸ’¡</span></div>
                <div style="width:100%">While we could have directly used the Throwable type in the track function
                    signature since it&#x27;s native to Kotlin, we chose to define the TrackableException type to
                    achieve a clearer and more expressive API.</div>
            </figure>
            <p id="183504e6-f752-8061-8f3d-fe99491e36c1" class="">To implement this conversion, we create a Throwable
                extension function with platform-specific implementations.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="183504e6-f752-80c7-9e78-e35b35024f85" class="code"><code class="kotlin">//bugsnag.common.kt
    expect fun Throwable.asTrackableException(): TrackableException
    
    //bugsnag.android.kt
    actual fun Throwable.asTrackableException() = this
    
    //bugsnag.ios.kt
    actual fun Throwable.asTrackableException() = NSException.exceptionWithName(
        name = this::class.simpleName,
        reason = message ?: toString(),
        userInfo = null
    )</code></pre>
            <p id="183504e6-f752-80ff-a675-d26619344810" class="">In Android, since TrackableException is an alias for
                Throwable, the extension simply returns the original exception. In iOS, we create a new NSException that
                encapsulates the error information.</p>
            <p id="183504e6-f752-8086-a445-e0503cbafaf8" class="">With this complete implementation, let&#x27;s analyze
                its advantages and disadvantages.</p>
            <h2 id="183504e6-f752-80c5-af0f-d699a5187d61" class="">Pros and Cons</h2>
            <p id="183504e6-f752-8004-bc58-fd2380a3412e" class=""><strong>Pros</strong></p>
            <ul id="183504e6-f752-8040-bf5c-cfb43695f414" class="bulleted-list">
                <li style="list-style-type:disc">Allows reusing existing solutions for MVP in KMP</li>
            </ul>
            <ul id="183504e6-f752-8059-a1c2-c795a9457957" class="bulleted-list">
                <li style="list-style-type:disc">Maintains developer experience, especially for those coming from
                    Android, by preserving familiar API definitions</li>
            </ul>
            <ul id="183504e6-f752-8065-becd-f580339b7bd7" class="bulleted-list">
                <li style="list-style-type:disc">Facilitates early adoption of KMP</li>
            </ul>
            <ul id="183504e6-f752-8041-bc8d-d721d3298779" class="bulleted-list">
                <li style="list-style-type:disc">Promotes robust and synchronized design between native solutions</li>
            </ul>
            <p id="183504e6-f752-80dc-ad64-f96f1f0ab47c" class=""><strong>Cons</strong></p>
            <ul id="183504e6-f752-80f1-b4b0-ecb78850b8b8" class="bulleted-list">
                <li style="list-style-type:disc">APIs may have inconsistent designs across platforms</li>
            </ul>
            <ul id="183504e6-f752-8021-8531-f0ac37266d7f" class="bulleted-list">
                <li style="list-style-type:disc">Increases maintenance cost by adding a new technology stack</li>
            </ul>
            <ul id="183504e6-f752-808a-9732-f4dd9451691d" class="bulleted-list">
                <li style="list-style-type:disc">Changes in native APIs require adjustments in KMP adaptation</li>
            </ul>
            <ul id="183504e6-f752-804b-a853-c1a7f34eb989" class="bulleted-list">
                <li style="list-style-type:disc">Cross-platform adaptation presents specific challenges: in Android,
                    Java-Kotlin interoperability, and in iOS, converting Swift code not compatible with Objective-C</li>
            </ul>
            <p id="183504e6-f752-80d0-b009-c109bc38ef46" class="">In my opinion, these solutions should be limited to
                specific cases, such as external integrations without native KMP support. It&#x27;s important to
                evaluate the cost of rewriting these modules. Although interoperability works in both directions (we can
                use native dependencies in KMP and vice versa), it&#x27;s better to avoid duplicate solutions. Software
                development experience has taught us the problems caused by code duplication.</p>
            <figure id="183504e6-f752-8094-91e7-e4675f1ed16b"><a
                    href="https://github.com/santimattius/kmp-native-api-playground" class="bookmark source">
                    <div class="bookmark-info">
                        <div class="bookmark-text">
                            <div class="bookmark-title">GitHub - santimattius/kmp-native-api-playground</div>
                            <div class="bookmark-description">Contribute to santimattius/kmp-native-api-playground
                                development by creating an account on GitHub.</div>
                        </div>
                        <div class="bookmark-href"><img src="https://github.com/fluidicon.png"
                                class="icon bookmark-icon" />https://github.com/santimattius/kmp-native-api-playground
                        </div>
                    </div><img
                        src="https://opengraph.githubassets.com/2e9118d22e3739c872b07bacd690e97d9ceb11552b05629a40d510628a3dd330/santimattius/kmp-native-api-playground"
                        class="bookmark-image" />
                </a></figure>
            <h1 id="183504e6-f752-8058-bb57-eb527b81f0d1" class="">Chapter 7: Libraries</h1>
            <p id="5ec28423-0c95-4149-adbd-4b1abf2f2aa3" class="">In Kotlin Multiplatform (KMP) application development,
                it&#x27;s essential to have a robust set of libraries that facilitate common tasks such as networking,
                data storage, and state management. These libraries are specifically designed to work consistently
                across all platforms supported by KMP, allowing developers to maintain a single codebase while
                leveraging native capabilities of each platform.</p>
            <p id="1430c9bf-3efb-4172-b13f-1a40bb017672" class="">Below, we&#x27;ll explore some of the most popular and
                proven libraries in the KMP community, organized by categories according to their main functionality.
                These tools have been selected based on their maturity, active support, and adoption in real projects.
            </p>
            <h2 id="179504e6-f752-80c0-832e-ea658efe09f1" class="">Networking</h2>
            <p id="e0e8e62a-b1fa-42b8-8963-9e672cf74bb5" class="">Networking libraries are fundamental for creating
                applications that work on both Android and iOS using Kotlin Multiplatform. These libraries allow both
                platforms to communicate with the Internet using the same code.</p>
            <p id="a10f277f-8c77-4bb0-aaba-52c9ae9ee16a" class="">Let&#x27;s look at the best available libraries for
                making network connections in Kotlin Multiplatform:</p>
            <h3 id="179504e6-f752-8093-97e6-e5c2bec42cd4" class="">Ktor</h3>
            <p id="179504e6-f752-8078-9b40-e4140e633304" class="">Ktor is an open-source framework for creating web and
                server applications in Kotlin. Ktor Client is a component of Ktor used to make HTTP requests from a
                Kotlin multiplatform application. With Ktor Client, you can make HTTP requests from your shared code
                across compatible platforms.</p>
            <p id="179504e6-f752-805a-a122-f0c5e880f3a5" class="">Ktor Client provides a declarative and fluid API for
                making HTTP requests simply and efficiently, making it suitable for developing multiplatform
                applications that need to interact with web services. You can use Ktor Client to make GET, POST, PUT,
                DELETE, and other HTTP operations, as well as easily handle headers, parameters, and request and
                response data.</p>
            <p id="179504e6-f752-80db-908e-de6f7fb42e67" class="">
            </p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-80c8-b384-c50933fa6f5c" class="code"><code class="kotlin">internal fun apiClient(baseUrl: String) = HttpClient {
    
        install(ContentNegotiation) {
            json(Json {
                prettyPrint = true
                isLenient = true
                ignoreUnknownKeys = true
            })
        }
        install(Logging) {
            logger = Logger.DEFAULT
            level = LogLevel.ALL
        }
    
        defaultRequest {
            url(baseUrl)
            contentType(ContentType.Application.Json)
        }
    }
    
    //using ktor client
    class KtorRemoteMoviesDataSource(
        private val client: HttpClient,
    ) : RemoteMoviesDataSource {
    
        override suspend fun getMovies(): Result&lt;List&lt;MovieDto&gt;&gt; = runCatching {
            // invoke service
            val response = client.get(&quot;movie/popular&quot;)
            val result = response.body&lt;MovieResponse&gt;()
            result.results
        }
    }</code></pre>
            <p id="87cc4095-c646-46e0-8966-8df06f80dc8d" class="">For more information on how to use Ktor in your Kotlin
                Multiplatform projects, you can check the<a
                    href="https://ktor.io/docs/getting-started-ktor-client-multiplatform-mobile.html">official Ktor
                    documentation</a>.</p>
            <figure id="185504e6-f752-8038-be6a-c16705035cf0"><a
                    href="https://ktor.io/docs/getting-started-ktor-client-multiplatform-mobile.html#code"
                    class="bookmark source">
                    <div class="bookmark-info">
                        <div class="bookmark-text">
                            <div class="bookmark-title">Creating a cross-platform mobile application | Ktor</div>
                            <div class="bookmark-description">The Ktor HTTP client can be used in multiplatform
                                projects. In this tutorial, we&#x27;ll create a simple Kotlin Multiplatform Mobile
                                application, which sends a request and receives a response body as plain HTML text.
                            </div>
                        </div>
                        <div class="bookmark-href"><img
                                src="https://resources.jetbrains.com/storage/products/company/brand/logos/Ktor_icon.png"
                                class="icon bookmark-icon" />https://ktor.io/docs/getting-started-ktor-client-multiplatform-mobile.html#code
                        </div>
                    </div><img src="https://raw.githubusercontent.com/ktorio/ktor-documentation/main/preview.jpg"
                        class="bookmark-image" />
                </a></figure>
            <h3 id="179504e6-f752-80c6-9087-e1b10fb774e7" class="">Ktorfit</h3>
            <p id="179504e6-f752-8052-a6bd-d94aafc1a681" class="">Ktorfit is a HTTP client/Kotlin Symbol Processor for
                Kotlin Multiplatform ( Android, iOS, Js, Jvm, Linux) using <a
                    href="https://github.com/google/ksp">KSP</a> and <a
                    href="https://ktor.io/docs/getting-started-ktor-client.html">Ktor clients</a> inspired by <a
                    href="https://square.github.io/retrofit/">Retrofit</a>.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-8086-b7c4-dfd4c4796d48" class="code"><code class="kotlin">class ServiceCreator(baseUrl: String) {
    
        private val client = HttpClient {
            install(ContentNegotiation) {
                json(Json { isLenient = true; ignoreUnknownKeys = true })
            }
        }
        private val ktorfit = Ktorfit.Builder()
            .baseUrl(baseUrl)
            .httpClient(client)
            .build()
    
        fun createPictureService() = ktorfit.create&lt;PictureService&gt;()
    }
    
    interface PictureService {
    
        @GET(&quot;random&quot;)
        suspend fun random(): Picture
    }</code></pre>
            <p id="50e7ba77-2b24-4b78-9afe-e3fbdd1521b7" class="">For more information about Ktorfit and how to use it
                in your projects, you can check the<a href="https://foso.github.io/Ktorfit/">official Ktorfit
                    documentation</a>.</p>
            <figure id="185504e6-f752-803f-9f7c-d532804536af"><a href="https://foso.github.io/Ktorfit/"
                    class="bookmark source">
                    <div class="bookmark-info">
                        <div class="bookmark-text">
                            <div class="bookmark-title">Ktorfit</div>
                            <div class="bookmark-description">Ktorfit is a HTTP client/Kotlin Symbol Processor for
                                Kotlin Multiplatform (Js, Jvm, Android, iOS, Linux) using KSP and Ktor clients inspired
                                by Retrofit</div>
                        </div>
                        <div class="bookmark-href"><img src="https://foso.github.io/Ktorfit/assets/images/favicon.png"
                                class="icon bookmark-icon" />https://foso.github.io/Ktorfit/</div>
                    </div>
                </a></figure>
            <p id="a08f46d1-f551-466a-881f-91a1f0757223" class="">For a complete example, you can check out this Github
                repository: </p>
            <figure id="179504e6-f752-801d-8294-c7411e06fd37">
                <div class="source">https://github.com/santimattius/kmp-networking</div>
            </figure>
            <h2 id="179504e6-f752-80f3-beb2-d9e92d6f6f0a" class="">Storage</h2>
            <p id="97c508e9-e195-4a0e-bece-47fa175e4ad3" class="">Mobile applications need to store information on the
                device. Kotlin Multiplatform makes this easier by providing tools that work the same way on both Android
                and iOS.</p>
            <p id="8dbe6bea-2114-4d97-b888-ebc67e95126b" class="">Let&#x27;s look at the best available tools for
                storing data in Kotlin Multiplatform, starting with how to handle user preferences.</p>
            <h3 id="179504e6-f752-80ad-a51c-cb3717c4e37b" class="">Datastore</h3>
            <p id="179504e6-f752-805c-9a23-d03f9085385e" class="">Jetpack Datastore is a data storage solution that
                allows you to store key-value pairs or objects written with <a
                    href="https://developers.google.com/protocol-buffers?hl=es-419">protocol buffers</a>. Datastore uses
                Kotlin coroutines and Flow to store data asynchronously, consistently, and transactionally.</p>
            <p id="179504e6-f752-809d-9f51-e873a352124b" class="">If you currently use
                <code><a href="https://developer.android.com/reference/kotlin/android/content/SharedPreferences?hl=es-419">SharedPreferences</a></code>
                to store data, consider migrating to Datastore.
            </p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-801a-81be-f0976679a5d8" class="code"><code class="kotlin">import androidx.datastore.core.DataStore
    import androidx.datastore.preferences.core.PreferenceDataStoreFactory
    import androidx.datastore.preferences.core.Preferences
    import kotlinx.atomicfu.locks.SynchronizedObject
    import kotlinx.atomicfu.locks.synchronized
    import okio.Path.Companion.toPath
    
    private lateinit var dataStore: DataStore&lt;Preferences&gt;
    
    private val lock = SynchronizedObject()
    
    fun getDataStore(producePath: () -&gt; String): DataStore&lt;Preferences&gt; =
        synchronized(lock) {
            if (::dataStore.isInitialized) {
                dataStore
            } else {
                PreferenceDataStoreFactory.createWithPath(produceFile = { producePath().toPath() })
                    .also { dataStore = it }
            }
        }
    
    internal const val dataStoreFileName = &quot;counter.preferences_pb&quot;</code></pre>
            <p id="f756dad1-01f3-4bcf-a742-cb056ef29b35" class="">For a complete example of using DataStore in KMP, you
                can check out the following link:</p>
            <figure id="185504e6-f752-8016-b7a1-f483a28a0758"><a
                    href="https://github.com/santimattius/kmp-shared-preferences/tree/feature/data-store"
                    class="bookmark source">
                    <div class="bookmark-info">
                        <div class="bookmark-text">
                            <div class="bookmark-title">GitHub - santimattius/kmp-shared-preferences at
                                feature/data-store</div>
                            <div class="bookmark-description">Example using Multiplaform Settings. Contribute to
                                santimattius/kmp-shared-preferences development by creating an account on GitHub.</div>
                        </div>
                        <div class="bookmark-href"><img src="https://github.com/fluidicon.png"
                                class="icon bookmark-icon" />https://github.com/santimattius/kmp-shared-preferences/tree/feature/data-store
                        </div>
                    </div><img
                        src="https://opengraph.githubassets.com/606beb483d4be8e477e4cae13599669acd0184e2081ba195ff3e784259cb7b60/santimattius/kmp-shared-preferences"
                        class="bookmark-image" />
                </a></figure>
            <h3 id="179504e6-f752-803e-adcf-ee577f1de5d9" class="">Multiplatform Settings</h3>
            <p id="179504e6-f752-80bd-8811-d1196d95fa45" class="">This is a Kotlin library for Multiplatform apps that
                enables common code to persist key-value data.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-805d-85a5-c2e5c14c834e" class="code"><code class="kotlin">import com.russhwolf.settings.Settings
    import com.santimattius.kmp.skeleton.core.preferences.IntSettingConfig
    import kotlinx.coroutines.flow.Flow
    
    //commonMain
    expect fun provideSettings(): Settings
    
    class SettingsRepository(
        settings: Settings = provideSettings(),
    ) {
    
    
        private val _counter = IntSettingConfig(settings, &quot;counter&quot;, 0)
        val counter: Flow&lt;Int&gt; = _counter.value
    
        fun increment() {
            val value = _counter.get().toInt() + 1
            _counter.set(&quot;$value&quot;)
        }
    
        fun decrease() {
            val value = _counter.get().toInt() - 1
            if (value &lt; 0) {
                _counter.set(&quot;0&quot;)
            } else {
                _counter.set(&quot;$value&quot;)
            }
        }
    }</code></pre>
            <p id="179504e6-f752-80da-9b3e-c8e10bfa3f9d" class="">Initialization in Android/iOS </p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-8008-9810-e46228907987" class="code"><code class="kotlin">//androidMain
    import androidx.preference.PreferenceManager
    import android.content.SharedPreferences
    import com.russhwolf.settings.Settings
    import com.russhwolf.settings.SharedPreferencesSettings
    
    actual fun provideSettings(context:Context): Settings {
        val preferences = PreferenceManager.getDefaultSharedPreferences(context)
        return SharedPreferencesSettings(sharedPref)
    }
    
    //iosMain
    import com.russhwolf.settings.NSUserDefaultsSettings
    import com.russhwolf.settings.Settings
    import platform.Foundation.NSUserDefaults
    
    actual fun provideSettings(): Settings{
        return NSUserDefaultsSettings(NSUserDefaults.standardUserDefaults)
    }
    </code></pre>
            <p id="185504e6-f752-8029-976e-c90d3ef5b623" class="">As we can see, Multiplatform Settings uses the
                preferences implementations of each platform.</p>
            <p id="a8e77aed-66e7-42c4-a4d0-1a895336b503" class="">For more detailed information and documentation about
                Multiplatform Settings, you can check the <a
                    href="https://github.com/russhwolf/multiplatform-settings">official documentation on GitHub</a>.</p>
            <figure id="185504e6-f752-80f1-96d4-cc315314561f"><a
                    href="https://github.com/russhwolf/multiplatform-settings/tree/main" class="bookmark source">
                    <div class="bookmark-info">
                        <div class="bookmark-text">
                            <div class="bookmark-title">GitHub - russhwolf/multiplatform-settings: A Kotlin
                                Multiplatform library for saving simple key-value data</div>
                            <div class="bookmark-description">A Kotlin Multiplatform library for saving simple key-value
                                data - russhwolf/multiplatform-settings</div>
                        </div>
                        <div class="bookmark-href"><img src="https://github.com/fluidicon.png"
                                class="icon bookmark-icon" />https://github.com/russhwolf/multiplatform-settings/tree/main
                        </div>
                    </div><img
                        src="https://repository-images.githubusercontent.com/132682692/6cadbe08-face-4865-838e-3b3979507b07"
                        class="bookmark-image" />
                </a></figure>
            <p id="d168d110-8a65-4e34-a7f5-3653e7ad5149" class="">For a complete example, you can check out the
                following Github repository:</p>
            <figure id="185504e6-f752-805e-b176-e212565d6c73"><a
                    href="https://github.com/santimattius/kmp-shared-preferences/tree/main" class="bookmark source">
                    <div class="bookmark-info">
                        <div class="bookmark-text">
                            <div class="bookmark-title">GitHub - santimattius/kmp-shared-preferences: Example using
                                Multiplaform Settings</div>
                            <div class="bookmark-description">Example using Multiplaform Settings. Contribute to
                                santimattius/kmp-shared-preferences development by creating an account on GitHub.</div>
                        </div>
                        <div class="bookmark-href"><img src="https://github.com/fluidicon.png"
                                class="icon bookmark-icon" />https://github.com/santimattius/kmp-shared-preferences/tree/main
                        </div>
                    </div><img
                        src="https://opengraph.githubassets.com/606beb483d4be8e477e4cae13599669acd0184e2081ba195ff3e784259cb7b60/santimattius/kmp-shared-preferences"
                        class="bookmark-image" />
                </a></figure>
            <h3 id="179504e6-f752-8097-a1d2-c68eee0ae7eb" class="">KStore</h3>
            <p id="179504e6-f752-8011-be49-c828e8c025b1" class="">A tiny Kotlin multiplatform library that assists in
                saving and restoring<br /> objects to and from disk using kotlinx.coroutines, kotlinx.serialisation and
                okio. Inspired by <br /><a href="https://github.com/Gridstone/RxStore">RxStore</a></p>
            <p id="179504e6-f752-8076-84bf-d8c061c7428e" class="">
            </p>
            <p id="179504e6-f752-803d-bb99-e96de67889bc" class=""><strong>Features</strong></p>
            <ul id="179504e6-f752-805d-a234-cdda11f6e444" class="bulleted-list">
                <li style="list-style-type:disc">ðŸ”’ Read-write locks; with a mutex FIFO lock</li>
            </ul>
            <ul id="179504e6-f752-807c-881f-cad3fd7d4f34" class="bulleted-list">
                <li style="list-style-type:disc">ðŸ’¾ In-memory caching; read once from disk and reuse</li>
            </ul>
            <ul id="179504e6-f752-8033-9889-e8eec1423fa3" class="bulleted-list">
                <li style="list-style-type:disc">ðŸ“¬ Default values; no file? no problem!</li>
            </ul>
            <ul id="179504e6-f752-8021-baef-ef1ada48357b" class="bulleted-list">
                <li style="list-style-type:disc">ðŸšš Migration support; moving shop? take your data with you</li>
            </ul>
            <ul id="179504e6-f752-8006-9fa5-d6f7771a7f67" class="bulleted-list">
                <li style="list-style-type:disc">ðŸš‰ Multiplatform!</li>
            </ul>
            <p id="185504e6-f752-803c-8da3-cbe9c3f80d39" class="">
            </p>
            <figure id="185504e6-f752-8089-8731-fc5f24fbd37b"><a href="https://github.com/xxfast/KStore"
                    class="bookmark source">
                    <div class="bookmark-info">
                        <div class="bookmark-text">
                            <div class="bookmark-title">GitHub - xxfast/KStore: A tiny Kotlin multiplatform library that
                                assists in saving and restoring objects to and from disk using kotlinx.coroutines,
                                kotlinx.serialisation and kotlinx.io</div>
                            <div class="bookmark-description">A tiny Kotlin multiplatform library that assists in saving
                                and restoring objects to and from disk using kotlinx.coroutines, kotlinx.serialisation
                                and kotlinx.io - xxfast/KStore</div>
                        </div>
                        <div class="bookmark-href"><img src="https://github.com/fluidicon.png"
                                class="icon bookmark-icon" />https://github.com/xxfast/KStore</div>
                    </div><img
                        src="https://repository-images.githubusercontent.com/533381136/da736262-ab68-48fb-ae2f-a94d536d2472"
                        class="bookmark-image" />
                </a></figure>
            <h2 id="179504e6-f752-80f1-98f8-eac706cde5e0" class="">Database</h2>
            <h3 id="179504e6-f752-80d6-b375-c8781fa42b90" class="">SQLDelight</h3>
            <p id="179504e6-f752-8030-8112-fff9f0400f8f" class="">SQLDelight generates typesafe Kotlin APIs from your
                SQL statements. It verifies your schema, statements, and migrations at compile-time and provides IDE
                features like autocomplete and refactoring which make writing and maintaining SQL simple.</p>
            <p id="179504e6-f752-8075-abab-dab283283d43" class="">
            </p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-8043-96dc-e7478ed699a2" class="code"><code class="sql">CREATE TABLE Favorite (
        resourceId INTEGER PRIMARY KEY NOT NULL,
        title TEXT NOT NULL,
        overview TEXT NOT NULL,
        imageUrl TEXT NOT NULL,
        type TEXT NOT NULL
    );
    
    selectAllFavorite:
    SELECT * FROM Favorite;</code></pre>
            <p id="179504e6-f752-80bb-bd10-f0cbd59d1235" class="">The SQLDelight plugin generates the necessary classes
                to interact with the database. In this example, AppDatabase and databaseQueries are generated by
                SQLDelight.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="179504e6-f752-8049-bd17-d2908409def5" class="code"><code class="kotlin">class SQLDelightFavoriteLocalDataSource(
        db: AppDatabase,
        private val dispatcher: CoroutineDispatcher = Dispatchers.IO,
    ) : FavoriteLocalDataSource {
    
        private val databaseQueries = db.appDatabaseQueries
    
        override val all: Flow&lt;List&lt;Favorite&gt;&gt;
            get() = databaseQueries
                .selectAllFavorite()
                .asFlow()
                .mapToList(dispatcher)
    
    }</code></pre>
            <p id="c0cd029b-a7ba-4f20-981b-b06252b4fb2e" class="">For more information about SQLDelight and how to use
                it in your projects, you can check the <a href="https://cashapp.github.io/sqldelight/2.0.1/">official
                    SQLDelight documentation</a>.</p>
            <figure id="185504e6-f752-8030-bfe3-f33728569fb1"><a href="https://cashapp.github.io/sqldelight/2.0.1/"
                    class="bookmark source">
                    <div class="bookmark-info">
                        <div class="bookmark-text">
                            <div class="bookmark-title"></div>
                        </div>
                        <div class="bookmark-href">https://cashapp.github.io/sqldelight/2.0.1/</div>
                    </div>
                </a></figure>
            <p id="185504e6-f752-80c2-9276-e8eda41a8a7c" class="">You can also find practical examples in the
                accompanying example.</p>
            <h3 id="179504e6-f752-80a8-93ff-d95ee62d2337" class="">Room</h3>
            <p id="179504e6-f752-8092-b3b5-c1a330050d0e" class="">Room is Android&#x27;s official database library, and
                now it can also be used in Kotlin Multiplatform projects.</p>
            <p id="185504e6-f752-8056-b4a4-f82b83dd07d6" class="">From now on, the same database you create for the
                Android target will be available across all targets.</p>

            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
                integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ=="
                crossorigin="anonymous" referrerPolicy="no-referrer" />
            <pre id="185504e6-f752-80ef-95fd-f7ad3e75ec79" class="code"><code class="kotlin">// shared/src/commonMain/kotlin/Database.kt
    
    @Database(entities = [TodoEntity::class], version = 1)
    @ConstructedBy(AppDatabaseConstructor::class)
    abstract class AppDatabase : RoomDatabase() {
      abstract fun getDao(): TodoDao
    }
    
    // The Room compiler generates the `actual` implementations.
    @Suppress(&quot;NO_ACTUAL_FOR_EXPECT&quot;)
    expect object AppDatabaseConstructor : RoomDatabaseConstructor&lt;AppDatabase&gt; {
        override fun initialize(): AppDatabase
    }
    
    @Dao
    interface TodoDao {
      @Insert
      suspend fun insert(item: TodoEntity)
    
      @Query(&quot;SELECT count(*) FROM TodoEntity&quot;)
      suspend fun count(): Int
    
      @Query(&quot;SELECT * FROM TodoEntity&quot;)
      fun getAllAsFlow(): Flow&lt;List&lt;TodoEntity&gt;&gt;
    }
    
    @Entity
    data class TodoEntity(
      @PrimaryKey(autoGenerate = true) val id: Long = 0,
      val title: String,
      val content: String
    )
    </code></pre>
            <p id="185504e6-f752-8064-a762-e460d20bc94c" class="">For more detailed information about Room in Kotlin
                Multiplatform, you can check the official documentation at the following link</p>
            <figure id="185504e6-f752-80b9-a703-c9764bb0ded3"><a
                    href="https://developer.android.com/kotlin/multiplatform/room" class="bookmark source">
                    <div class="bookmark-info">
                        <div class="bookmark-text">
                            <div class="bookmark-title">Room (Kotlin Multiplatform) Â |Â  Android Developers</div>
                            <div class="bookmark-description">The Room persistence library provides an abstraction layer
                                over SQLite to allow
                                for more robust database access while harnessing the full power of SQLite. This
                                page focuses on using Room in Kotlin Multiplatform (KMP) projects. For more
                                information on using Room, see Save data in a local database using Room
                                or our official samples.</div>
                        </div>
                        <div class="bookmark-href"><img
                                src="https://www.gstatic.com/devrel-devsite/prod/vda41147226ae308b24384f785d31d739107d2716272d99cd11c490ff3892954d/android/images/touchicon-180.png"
                                class="icon bookmark-icon" />https://developer.android.com/kotlin/multiplatform/room
                        </div>
                    </div><img src="https://developer.android.com/static/images/social/android-developers.png"
                        class="bookmark-image" />
                </a></figure>
            <h2 id="185504e6-f752-8082-96b8-e1f54770d060" class="">Multiplatform Jetpack Libraries</h2>
            <p id="185504e6-f752-803a-8bd7-ead40a234ef0" class="">Google <a
                    href="https://android-developers.googleblog.com/2024/05/android-support-for-kotlin-multiplatform-to-share-business-logic-across-mobile-web-server-desktop.html">officially
                    supports</a> Kotlin Multiplatform for sharing business logic between iOS and Android. Many Jetpack
                libraries have already been adapted to take advantage of KMP.</p>
            <p id="185504e6-f752-806c-9f51-e568e9237b21" class="">The following Jetpack libraries are compatible with
                KMP:</p>
            <ul id="185504e6-f752-80c6-bf2f-dcc41dfae036" class="bulleted-list">
                <li style="list-style-type:disc"><a
                        href="https://developer.android.com/jetpack/androidx/releases/annotation?hl=es-419">https://developer.android.com/jetpack/androidx/releases/annotation?hl=es-419</a>
                </li>
            </ul>
            <ul id="185504e6-f752-8001-bb28-ef854e938ecc" class="bulleted-list">
                <li style="list-style-type:disc"><a
                        href="https://developer.android.com/jetpack/androidx/releases/collection?hl=es-419">https://developer.android.com/jetpack/androidx/releases/collection?hl=es-419</a>
                </li>
            </ul>
            <ul id="185504e6-f752-80c0-a866-e791c1a7246c" class="bulleted-list">
                <li style="list-style-type:disc"><a
                        href="https://developer.android.com/jetpack/androidx/releases/datastore?hl=es-419">https://developer.android.com/jetpack/androidx/releases/datastore?hl=es-419</a>
                </li>
            </ul>
            <ul id="185504e6-f752-80f9-80d9-e73399146258" class="bulleted-list">
                <li style="list-style-type:disc"><a
                        href="https://developer.android.com/jetpack/androidx/releases/lifecycle?hl=es-419">https://developer.android.com/jetpack/androidx/releases/lifecycle?hl=es-419</a>
                </li>
            </ul>
            <ul id="185504e6-f752-808c-b3cd-c89fae0b7e3f" class="bulleted-list">
                <li style="list-style-type:disc"><a
                        href="https://developer.android.com/jetpack/androidx/releases/paging?hl=es-419">https://developer.android.com/jetpack/androidx/releases/paging?hl=es-419</a>
                </li>
            </ul>
            <ul id="185504e6-f752-805b-b278-e67adfb29bb5" class="bulleted-list">
                <li style="list-style-type:disc"><a
                        href="https://developer.android.com/jetpack/androidx/releases/room?hl=es-419">https://developer.android.com/jetpack/androidx/releases/room?hl=es-419</a>
                </li>
            </ul>
            <ul id="185504e6-f752-802a-b63d-c6b1d2fd5821" class="bulleted-list">
                <li style="list-style-type:disc"><a
                        href="https://developer.android.com/jetpack/androidx/releases/sqlite?hl=es-419">https://developer.android.com/jetpack/androidx/releases/sqlite?hl=es-419</a>
                </li>
            </ul>
            <h2 id="185504e6-f752-801a-9dbd-c48b16781ec4" class="">Chapter Summary</h2>
            <p id="179504e6-f752-80cb-9505-f256c6e74507" class="">These are some of the libraries that help us address
                the challenge of delegating platform-specific implementations. They allow our code to be fully
                multiplatform, giving us the flexibility to choose which business logic to share while keeping critical
                aspects like the user interface separate.</p>
            <p id="179504e6-f752-8075-a4f9-c566e9dd5bae" class="">If you want to discover other libraries with Kotlin
                Multiplatform support, you can visit the following Github repository or the Jetbrains website where you
                can find official and community libraries.</p>
            <ul id="185504e6-f752-808a-bc42-ff214f512964" class="bulleted-list">
                <li style="list-style-type:disc"><a href="https://klibs.io/">https://klibs.io/</a></li>
            </ul>
            <ul id="187504e6-f752-802c-ba4d-dbe486f91e00" class="bulleted-list">
                <li style="list-style-type:disc"><strong>Awesome Kotlin Multiplatform: </strong><a
                        href="https://github.com/terrakok/kmp-awesome">https://github.com/terrakok/kmp-awesome</a></li>
            </ul>
            <h1 id="187504e6-f752-80f8-94c8-db22a1b3af9f" class="">Book Example Repositories</h1>
            <ul id="187504e6-f752-8043-8360-f3f4850088d8" class="bulleted-list">
                <li style="list-style-type:disc"><strong>KMP for Mobile Native Developers: </strong><a
                        href="https://github.com/santimattius/kmp-for-mobile-native-developers">https://github.com/santimattius/kmp-for-mobile-native-developers</a>
                </li>
            </ul>
            <ul id="187504e6-f752-8076-aad7-ff33cdee6875" class="bulleted-list">
                <li style="list-style-type:disc"><strong>KMP Multi Module Example: </strong><a
                        href="https://github.com/santimattius/kmp-multi-module-example">https://github.com/santimattius/kmp-multi-module-example</a>
                </li>
            </ul>
            <ul id="187504e6-f752-802e-9928-e45b9fe8b7df" class="bulleted-list">
                <li style="list-style-type:disc"><strong>KMP Preferences Example: </strong><a
                        href="https://github.com/santimattius/kmp-preferences-example">https://github.com/santimattius/kmp-preferences-example</a>
                </li>
            </ul>
            <ul id="187504e6-f752-809b-a3b8-f874683d46af" class="bulleted-list">
                <li style="list-style-type:disc"><strong>KMP Native API Playground: </strong><a
                        href="https://github.com/santimattius/kmp-native-api-playground">https://github.com/santimattius/kmp-native-api-playground</a>
                </li>
            </ul>
            <h1 id="179504e6-f752-806a-a42b-f4cd68db0d6e" class="">References</h1>
            <p id="179504e6-f752-8063-bcfb-da9ad485cae6" class=""><strong>Chapter 1: Introduction to Kotlin
                    Multiplatform</strong></p>
            <ul id="179504e6-f752-80ed-8391-ecde304588b1" class="bulleted-list">
                <li style="list-style-type:disc"><a
                        href="https://www.jetbrains.com/help/kotlin-multiplatform-dev/multiplatform-project-configuration.html">https://www.jetbrains.com/help/kotlin-multiplatform-dev/multiplatform-project-configuration.html</a>
                </li>
            </ul>
            <ul id="179504e6-f752-8052-bff7-dcfe2072e57d" class="bulleted-list">
                <li style="list-style-type:disc"><a
                        href="https://kotlinlang.org/docs/multiplatform.html">https://kotlinlang.org/docs/multiplatform.html</a>
                </li>
            </ul>
            <ul id="179504e6-f752-80e6-a54c-d2a1effcfc15" class="bulleted-list">
                <li style="list-style-type:disc"><a
                        href="https://www.jetbrains.com/help/kotlin-multiplatform-dev/multiplatform-ktor-sqldelight.html">https://www.jetbrains.com/help/kotlin-multiplatform-dev/multiplatform-ktor-sqldelight.html</a>
                </li>
            </ul>
            <ul id="179504e6-f752-803f-8d35-e29b839a2aab" class="bulleted-list">
                <li style="list-style-type:disc"><a
                        href="https://www.jetbrains.com/kotlin-multiplatform/">https://www.jetbrains.com/kotlin-multiplatform/</a>
                </li>
            </ul>
            <ul id="179504e6-f752-802d-bff1-ee871245b935" class="bulleted-list">
                <li style="list-style-type:disc"><a
                        href="https://www.jetbrains.com/lp/compose-multiplatform/">https://www.jetbrains.com/lp/compose-multiplatform/</a>
                </li>
            </ul>
            <p id="179504e6-f752-80b6-9c4b-d0d73ceca71c" class=""><strong>Chapter 2: Understanding the Basic Project
                    Structure</strong></p>
            <ul id="179504e6-f752-80eb-816e-d3aa3315a29f" class="bulleted-list">
                <li style="list-style-type:disc"><a
                        href="https://kotlinlang.org/docs/multiplatform-get-started.html">Get started with Kotlin
                        Multiplatform.</a></li>
            </ul>
            <ul id="179504e6-f752-8080-b2cf-df77de6ad09d" class="bulleted-list">
                <li style="list-style-type:disc"><a
                        href="https://kotlinlang.org/docs/multiplatform-discover-project.html">The basics of Kotlin
                        Multiplatform project structure.</a></li>
            </ul>
            <ul id="179504e6-f752-80d7-abc2-cb1209cd51d3" class="bulleted-list">
                <li style="list-style-type:disc"><a
                        href="https://kotlinlang.org/docs/multiplatform-advanced-project-structure.html">Advanced
                        concepts of the multiplatform project structure.</a></li>
            </ul>
            <ul id="179504e6-f752-8084-b151-efbeb4992515" class="bulleted-list">
                <li style="list-style-type:disc"><a
                        href="https://kotlinlang.org/docs/multiplatform-share-on-platforms.html">Share code on
                        platforms.</a></li>
            </ul>
            <p id="179504e6-f752-80dc-8f95-ea5226cf6e45" class=""><strong>Chapter 4:Modularization</strong></p>
            <ul id="179504e6-f752-808a-a46c-fdb6302ea6f4" class="bulleted-list">
                <li style="list-style-type:disc"><a
                        href="https://www.jetbrains.com/help/kotlin-multiplatform-dev/multiplatform-project-configuration.html#module-configurations">https://www.jetbrains.com/help/kotlin-multiplatform-dev/multiplatform-project-configuration.html#module-configurations</a>
                </li>
            </ul>
            <ul id="179504e6-f752-80f1-8097-e5ea6a58e9b3" class="bulleted-list">
                <li style="list-style-type:disc"><a
                        href="https://touchlab.co/optimizing-gradle-builds-in-Multi-module-projects">https://touchlab.co/optimizing-gradle-builds-in-Multi-module-projects</a>
                </li>
            </ul>
            <ul id="179504e6-f752-8063-9196-c93ace5ea210" class="bulleted-list">
                <li style="list-style-type:disc"><a
                        href="https://touchlab.co/multiple-kotlin-frameworks-in-application">https://touchlab.co/multiple-kotlin-frameworks-in-application</a>
                </li>
            </ul>
            <ul id="179504e6-f752-8091-b0eb-c4be5506f24f" class="bulleted-list">
                <li style="list-style-type:disc"><a
                        href="https://developer.android.com/topic/modularization/patterns">https://developer.android.com/topic/modularization/patterns</a>
                </li>
            </ul>
            <p id="179504e6-f752-8084-82cd-ec32bed406cf" class=""><strong>Chapter 5:Testing</strong></p>
            <ul id="179504e6-f752-80c3-8246-ebbfbc9d99ab" class="bulleted-list">
                <li style="list-style-type:disc"><a
                        href="https://martinfowler.com/articles/practical-test-pyramid.html">https://martinfowler.com/articles/practical-test-pyramid.html</a>
                </li>
            </ul>
            <ul id="179504e6-f752-80f6-8ecb-d9213215a4a3" class="bulleted-list">
                <li style="list-style-type:disc"><a
                        href="https://martinfowler.com/bliki/IntegrationTest.html">https://martinfowler.com/bliki/IntegrationTest.html</a>
                </li>
            </ul>
            <ul id="179504e6-f752-80d8-b966-ce453f987a5c" class="bulleted-list">
                <li style="list-style-type:disc"><a
                        href="https://martinfowler.com/bliki/ObjectMother.html">https://martinfowler.com/bliki/ObjectMother.html</a>
                </li>
            </ul>
            <ul id="179504e6-f752-80dc-b035-fdaf317713a0" class="bulleted-list">
                <li style="list-style-type:disc"><a
                        href="https://refactoring.guru/design-patterns/builder">https://refactoring.guru/design-patterns/builder</a>
                </li>
            </ul>
            <ul id="179504e6-f752-800c-a6dc-d00c73ae6a81" class="bulleted-list">
                <li style="list-style-type:disc"><a
                        href="https://martinfowler.com/bliki/TestDouble.html">https://martinfowler.com/bliki/TestDouble.html</a>
                </li>
            </ul>
            <ul id="179504e6-f752-808e-9510-ec3edddb507c" class="bulleted-list">
                <li style="list-style-type:disc"><a
                        href="https://developer.android.com/training/testing/fundamentals">https://developer.android.com/training/testing/fundamentals</a>
                </li>
            </ul>
            <ul id="179504e6-f752-806a-a770-e9a2f555a61b" class="bulleted-list">
                <li style="list-style-type:disc"><a
                        href="https://github.com/Kotlin/kotlinx-kover">https://github.com/Kotlin/kotlinx-kover</a></li>
            </ul>
        </div>
    </article><span class="sans" style="font-size:14px;padding-top:2em"></span>
</body>

</html>